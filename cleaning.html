<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Data Cleaning | Personality Predictors of Dementia Diagnosis and Neuropathic Burden: A Mega-Analysis</title>
  <meta name="description" content="Personality, Dementia, and Neuropathology" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Data Cleaning | Personality Predictors of Dementia Diagnosis and Neuropathic Burden: A Mega-Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Personality, Dementia, and Neuropathology" />
  <meta name="github-repo" content="emoriebeck/personality-dementia-neuropath" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Data Cleaning | Personality Predictors of Dementia Diagnosis and Neuropathic Burden: A Mega-Analysis" />
  
  <meta name="twitter:description" content="Personality, Dementia, and Neuropathology" />
  



<meta name="date" content="2022-10-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="runmodels.html"/>
<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Workspace</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#packages"><i class="fa fa-check"></i><b>1.1</b> Packages</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#directory-path"><i class="fa fa-check"></i><b>1.2</b> Directory Path</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#codebook"><i class="fa fa-check"></i><b>1.3</b> Codebook</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#tables"><i class="fa fa-check"></i><b>1.4</b> Tables</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#table-s1"><i class="fa fa-check"></i><b>1.4.1</b> Table S1</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#table-s2"><i class="fa fa-check"></i><b>1.4.2</b> Table S2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cleaning.html"><a href="cleaning.html"><i class="fa fa-check"></i><b>2</b> Data Cleaning</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cleaning.html"><a href="cleaning.html#health-and-retirement-study-hrs"><i class="fa fa-check"></i><b>2.1</b> Health and Retirement Study (HRS)</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="cleaning.html"><a href="cleaning.html#load-data"><i class="fa fa-check"></i><b>2.1.1</b> Load Data</a></li>
<li class="chapter" data-level="2.1.2" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring"><i class="fa fa-check"></i><b>2.1.2</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.1.3" data-path="cleaning.html"><a href="cleaning.html#covariates"><i class="fa fa-check"></i><b>2.1.3</b> Covariates</a></li>
<li class="chapter" data-level="2.1.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables"><i class="fa fa-check"></i><b>2.1.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.1.5" data-path="cleaning.html"><a href="cleaning.html#cognition-variables"><i class="fa fa-check"></i><b>2.1.5</b> Cognition Variables</a></li>
<li class="chapter" data-level="2.1.6" data-path="cleaning.html"><a href="cleaning.html#outcome-variables"><i class="fa fa-check"></i><b>2.1.6</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.1.7" data-path="cleaning.html"><a href="cleaning.html#combine-data"><i class="fa fa-check"></i><b>2.1.7</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="cleaning.html"><a href="cleaning.html#rush-memory-and-and-aging-project-rush-map"><i class="fa fa-check"></i><b>2.2</b> RUSH Memory and and Aging Project (RUSH-MAP)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="cleaning.html"><a href="cleaning.html#load-data-1"><i class="fa fa-check"></i><b>2.2.1</b> Load Data</a></li>
<li class="chapter" data-level="2.2.2" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring-1"><i class="fa fa-check"></i><b>2.2.2</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.2.3" data-path="cleaning.html"><a href="cleaning.html#covariates-1"><i class="fa fa-check"></i><b>2.2.3</b> Covariates</a></li>
<li class="chapter" data-level="2.2.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables-1"><i class="fa fa-check"></i><b>2.2.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.2.5" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-1"><i class="fa fa-check"></i><b>2.2.5</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.2.6" data-path="cleaning.html"><a href="cleaning.html#cognition-variables-1"><i class="fa fa-check"></i><b>2.2.6</b> Cognition Variables</a></li>
<li class="chapter" data-level="2.2.7" data-path="cleaning.html"><a href="cleaning.html#combine-data-1"><i class="fa fa-check"></i><b>2.2.7</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="cleaning.html"><a href="cleaning.html#rush-religious-orders-study-ros"><i class="fa fa-check"></i><b>2.3</b> RUSH Religious Orders Study (ROS)</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring-2"><i class="fa fa-check"></i><b>2.3.1</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.3.2" data-path="cleaning.html"><a href="cleaning.html#covariates-2"><i class="fa fa-check"></i><b>2.3.2</b> Covariates</a></li>
<li class="chapter" data-level="2.3.3" data-path="cleaning.html"><a href="cleaning.html#personality-variables-2"><i class="fa fa-check"></i><b>2.3.3</b> Personality Variables</a></li>
<li class="chapter" data-level="2.3.4" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-2"><i class="fa fa-check"></i><b>2.3.4</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.3.5" data-path="cleaning.html"><a href="cleaning.html#cognition-variables-2"><i class="fa fa-check"></i><b>2.3.5</b> Cognition Variables</a></li>
<li class="chapter" data-level="2.3.6" data-path="cleaning.html"><a href="cleaning.html#combine-data-2"><i class="fa fa-check"></i><b>2.3.6</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="cleaning.html"><a href="cleaning.html#swedish-adoption-twin-study-of-aging-satsa"><i class="fa fa-check"></i><b>2.4</b> Swedish Adoption Twin Study of Aging (SATSA)</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="cleaning.html"><a href="cleaning.html#load-data-2"><i class="fa fa-check"></i><b>2.4.1</b> Load Data</a></li>
<li class="chapter" data-level="2.4.2" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring-3"><i class="fa fa-check"></i><b>2.4.2</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.4.3" data-path="cleaning.html"><a href="cleaning.html#covariates-3"><i class="fa fa-check"></i><b>2.4.3</b> Covariates</a></li>
<li class="chapter" data-level="2.4.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables-3"><i class="fa fa-check"></i><b>2.4.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.4.5" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-3"><i class="fa fa-check"></i><b>2.4.5</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.4.6" data-path="cleaning.html"><a href="cleaning.html#cognition-variables-3"><i class="fa fa-check"></i><b>2.4.6</b> Cognition Variables</a></li>
<li class="chapter" data-level="2.4.7" data-path="cleaning.html"><a href="cleaning.html#combine-data-3"><i class="fa fa-check"></i><b>2.4.7</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="cleaning.html"><a href="cleaning.html#adrc-memory-and-aging-project-adrc-map"><i class="fa fa-check"></i><b>2.5</b> ADRC Memory and Aging Project (ADRC-MAP)</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="cleaning.html"><a href="cleaning.html#load-data-3"><i class="fa fa-check"></i><b>2.5.1</b> Load Data</a></li>
<li class="chapter" data-level="2.5.2" data-path="cleaning.html"><a href="cleaning.html#recode-reverse-scoring"><i class="fa fa-check"></i><b>2.5.2</b> Recode &amp; Reverse-Scoring</a></li>
<li class="chapter" data-level="2.5.3" data-path="cleaning.html"><a href="cleaning.html#covariates-4"><i class="fa fa-check"></i><b>2.5.3</b> Covariates</a></li>
<li class="chapter" data-level="2.5.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables-4"><i class="fa fa-check"></i><b>2.5.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.5.5" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-4"><i class="fa fa-check"></i><b>2.5.5</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.5.6" data-path="cleaning.html"><a href="cleaning.html#cognition-variables-4"><i class="fa fa-check"></i><b>2.5.6</b> Cognition Variables</a></li>
<li class="chapter" data-level="2.5.7" data-path="cleaning.html"><a href="cleaning.html#combine-data-4"><i class="fa fa-check"></i><b>2.5.7</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="cleaning.html"><a href="cleaning.html#einstein-aging-study"><i class="fa fa-check"></i><b>2.6</b> Einstein Aging Study</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="cleaning.html"><a href="cleaning.html#load-data-4"><i class="fa fa-check"></i><b>2.6.1</b> Load Data</a></li>
<li class="chapter" data-level="2.6.2" data-path="cleaning.html"><a href="cleaning.html#recode-reverse-scoring-1"><i class="fa fa-check"></i><b>2.6.2</b> Recode &amp; Reverse-Scoring</a></li>
<li class="chapter" data-level="2.6.3" data-path="cleaning.html"><a href="cleaning.html#covariates-5"><i class="fa fa-check"></i><b>2.6.3</b> Covariates</a></li>
<li class="chapter" data-level="2.6.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables-5"><i class="fa fa-check"></i><b>2.6.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.6.5" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-5"><i class="fa fa-check"></i><b>2.6.5</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.6.6" data-path="cleaning.html"><a href="cleaning.html#cognition-variables-5"><i class="fa fa-check"></i><b>2.6.6</b> Cognition Variables</a></li>
<li class="chapter" data-level="2.6.7" data-path="cleaning.html"><a href="cleaning.html#combine-data-5"><i class="fa fa-check"></i><b>2.6.7</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="cleaning.html"><a href="cleaning.html#german-socioeconomic-panel-study-gsoep"><i class="fa fa-check"></i><b>2.7</b> German Socioeconomic Panel Study (GSOEP)</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="cleaning.html"><a href="cleaning.html#load-data-5"><i class="fa fa-check"></i><b>2.7.1</b> Load Data</a></li>
<li class="chapter" data-level="2.7.2" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring-4"><i class="fa fa-check"></i><b>2.7.2</b> Recoding &amp; Reverse Scoring</a></li>
<li class="chapter" data-level="2.7.3" data-path="cleaning.html"><a href="cleaning.html#covariates-6"><i class="fa fa-check"></i><b>2.7.3</b> Covariates</a></li>
<li class="chapter" data-level="2.7.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables-6"><i class="fa fa-check"></i><b>2.7.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.7.5" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-6"><i class="fa fa-check"></i><b>2.7.5</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.7.6" data-path="cleaning.html"><a href="cleaning.html#cognition-variables-6"><i class="fa fa-check"></i><b>2.7.6</b> Cognition Variables</a></li>
<li class="chapter" data-level="2.7.7" data-path="cleaning.html"><a href="cleaning.html#combine-data-6"><i class="fa fa-check"></i><b>2.7.7</b> Combine Data</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="cleaning.html"><a href="cleaning.html#the-longitudinal-studies-for-the-social-sciences-liss"><i class="fa fa-check"></i><b>2.8</b> The Longitudinal Studies for the Social sciences (LISS)</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="cleaning.html"><a href="cleaning.html#load-data-6"><i class="fa fa-check"></i><b>2.8.1</b> Load Data</a></li>
<li class="chapter" data-level="2.8.2" data-path="cleaning.html"><a href="cleaning.html#recoding-reverse-scoring-5"><i class="fa fa-check"></i><b>2.8.2</b> Recoding &amp; Reverse-Scoring</a></li>
<li class="chapter" data-level="2.8.3" data-path="cleaning.html"><a href="cleaning.html#covariates-7"><i class="fa fa-check"></i><b>2.8.3</b> Covariates</a></li>
<li class="chapter" data-level="2.8.4" data-path="cleaning.html"><a href="cleaning.html#personality-variables-7"><i class="fa fa-check"></i><b>2.8.4</b> Personality Variables</a></li>
<li class="chapter" data-level="2.8.5" data-path="cleaning.html"><a href="cleaning.html#cognition-variables-7"><i class="fa fa-check"></i><b>2.8.5</b> Cognition Variables</a></li>
<li class="chapter" data-level="2.8.6" data-path="cleaning.html"><a href="cleaning.html#outcome-variables-7"><i class="fa fa-check"></i><b>2.8.6</b> Outcome Variables</a></li>
<li class="chapter" data-level="2.8.7" data-path="cleaning.html"><a href="cleaning.html#combine-data-7"><i class="fa fa-check"></i><b>2.8.7</b> Combine Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="runmodels.html"><a href="runmodels.html"><i class="fa fa-check"></i><b>3</b> Models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="runmodels.html"><a href="runmodels.html#part-1-combine-data"><i class="fa fa-check"></i><b>3.1</b> Part 1: Combine Data</a></li>
<li class="chapter" data-level="3.2" data-path="runmodels.html"><a href="runmodels.html#part-2-clean-and-prepare-data-sets"><i class="fa fa-check"></i><b>3.2</b> Part 2: Clean and Prepare Data Sets</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="runmodels.html"><a href="runmodels.html#pomp-and-factor-levels"><i class="fa fa-check"></i><b>3.2.1</b> POMP and Factor Levels</a></li>
<li class="chapter" data-level="3.2.2" data-path="runmodels.html"><a href="runmodels.html#zero-order-correlations"><i class="fa fa-check"></i><b>3.2.2</b> Zero-Order Correlations</a></li>
<li class="chapter" data-level="3.2.3" data-path="runmodels.html"><a href="runmodels.html#rescale-outcomes"><i class="fa fa-check"></i><b>3.2.3</b> Rescale Outcomes</a></li>
<li class="chapter" data-level="3.2.4" data-path="runmodels.html"><a href="runmodels.html#bring-in-moderators-and-covariate-adjustments"><i class="fa fa-check"></i><b>3.2.4</b> Bring in Moderators and Covariate Adjustments</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="runmodels.html"><a href="runmodels.html#part-3-models"><i class="fa fa-check"></i><b>3.3</b> Part 3: Models</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="runmodels.html"><a href="runmodels.html#functions"><i class="fa fa-check"></i><b>3.3.1</b> Functions</a></li>
<li class="chapter" data-level="3.3.2" data-path="runmodels.html"><a href="runmodels.html#run-models-and-summaries"><i class="fa fa-check"></i><b>3.3.2</b> Run Models and Summaries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="compile.html"><a href="compile.html"><i class="fa fa-check"></i><b>4</b> Compile Results</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="compile.html"><a href="compile.html#tables-1"><i class="fa fa-check"></i><b>4.0.1</b> Tables</a></li>
<li class="chapter" data-level="4.0.2" data-path="compile.html"><a href="compile.html#figures"><i class="fa fa-check"></i><b>4.0.2</b> Figures</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Personality Predictors of Dementia Diagnosis and Neuropathic Burden: A Mega-Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cleaning" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Data Cleaning<a href="cleaning.html#cleaning" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this section, we will clean the data for each study. Raw data cannot be shared directly, but for each study, we include instrucitons on how to access the data.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="cleaning.html#cb14-1" aria-hidden="true" tabindex="-1"></a>Mode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb14-2"><a href="cleaning.html#cb14-2" aria-hidden="true" tabindex="-1"></a>  ux <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb14-3"><a href="cleaning.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  ux <span class="ot">&lt;-</span> ux[<span class="sc">!</span><span class="fu">is.na</span>(ux)]</span>
<span id="cb14-4"><a href="cleaning.html#cb14-4" aria-hidden="true" tabindex="-1"></a>  ux[<span class="fu">which.max</span>(<span class="fu">tabulate</span>(<span class="fu">match</span>(x, ux)))]</span>
<span id="cb14-5"><a href="cleaning.html#cb14-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-6"><a href="cleaning.html#cb14-6" aria-hidden="true" tabindex="-1"></a>pomp <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (x <span class="sc">-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> T))<span class="sc">/</span>(<span class="fu">max</span>(x, <span class="at">na.rm =</span> T) <span class="sc">-</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> T))<span class="sc">*</span><span class="dv">10</span></span></code></pre></div>
<div id="health-and-retirement-study-hrs" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Health and Retirement Study (HRS)<a href="cleaning.html#health-and-retirement-study-hrs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Health and Retirement Study [HRS; <span class="citation">(<a href="#ref-juster1995overview" role="doc-biblioref"><strong>juster1995overview?</strong></a>)</span>] is an ongoing longitudinal study of households in the United States. These data are available at <a href="https://hrs.isr.umich.edu" class="uri">https://hrs.isr.umich.edu</a> by creating a free account.</p>
<p>Participants were recruited from more than 35,000 individuals from the financial households of individuals born between 1931 and 1941 in the US. Data have been collected biannually since 1992. The latest data release includes data up to 2016. On average, 10,000 individuals are sampled each wave More information on the HRS can be found at <a href="https://hrs.isr.umich.edu/documentation/survey-design" class="uri">https://hrs.isr.umich.edu/documentation/survey-design</a>, but, in short, the HRS is a nationally representative sample of adults over 50 in the US. It is critical to note that the HRS samples households of the original cohort and follows individuals and their spouses or partners until their death.</p>
<p>Sample size varies by year, ranging from approximately 7,500 (2014) to 15,500 (1992). (<a href="https://hrs.isr.umich.edu/sites/default/files/biblio/ResponseRates_2017.pdf" class="uri">https://hrs.isr.umich.edu/sites/default/files/biblio/ResponseRates_2017.pdf</a>). This provides 99% power to detect a zero-order correlation effect size of ~.04, two-tailed at alpha .05.</p>
<div id="load-data" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Load Data<a href="cleaning.html#load-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="cleaning.html#cb15-1" aria-hidden="true" tabindex="-1"></a>hrs_read_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(year) {</span>
<span id="cb15-2"><a href="cleaning.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  read_da <span class="ot">&lt;-</span> <span class="cf">function</span>(da, dct, Year){</span>
<span id="cb15-3"><a href="cleaning.html#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(da, dct, year, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>))</span>
<span id="cb15-4"><a href="cleaning.html#cb15-4" aria-hidden="true" tabindex="-1"></a>    data.file <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/hrs/%s/%s&quot;</span>, data_path, Year, da)</span>
<span id="cb15-5"><a href="cleaning.html#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set path to the dictionary file &quot;*.DCT&quot;</span></span>
<span id="cb15-6"><a href="cleaning.html#cb15-6" aria-hidden="true" tabindex="-1"></a>    dict.file <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/hrs/%s/%s&quot;</span>, data_path, Year, dct)</span>
<span id="cb15-7"><a href="cleaning.html#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Read the dictionary file</span></span>
<span id="cb15-8"><a href="cleaning.html#cb15-8" aria-hidden="true" tabindex="-1"></a>    df.dict <span class="ot">&lt;-</span> <span class="fu">read.table</span>(dict.file, <span class="at">skip =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-9"><a href="cleaning.html#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set column names for dictionary dataframe</span></span>
<span id="cb15-10"><a href="cleaning.html#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(df.dict) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;col.num&quot;</span>,<span class="st">&quot;col.type&quot;</span>,<span class="st">&quot;col.name&quot;</span>,<span class="st">&quot;col.width&quot;</span>,<span class="st">&quot;col.lbl&quot;</span>)</span>
<span id="cb15-11"><a href="cleaning.html#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove last row which only contains a closing }</span></span>
<span id="cb15-12"><a href="cleaning.html#cb15-12" aria-hidden="true" tabindex="-1"></a>    row <span class="ot">&lt;-</span> <span class="fu">which</span>(df.dict<span class="sc">$</span>col.name <span class="sc">==</span> <span class="st">&quot;HHID&quot;</span>)</span>
<span id="cb15-13"><a href="cleaning.html#cb15-13" aria-hidden="true" tabindex="-1"></a>    df.dict <span class="ot">&lt;-</span> df.dict[<span class="sc">-</span><span class="fu">nrow</span>(df.dict),]</span>
<span id="cb15-14"><a href="cleaning.html#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(row <span class="sc">==</span> <span class="dv">2</span>){df.dict <span class="ot">&lt;-</span> df.dict[<span class="sc">-</span><span class="dv">1</span>,]}</span>
<span id="cb15-15"><a href="cleaning.html#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract numeric value from column width field</span></span>
<span id="cb15-16"><a href="cleaning.html#cb15-16" aria-hidden="true" tabindex="-1"></a>    df.dict<span class="sc">$</span>col.width <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">sapply</span>(df.dict<span class="sc">$</span>col.width, gsub, <span class="at">pattern =</span> <span class="st">&quot;[^0-9</span><span class="sc">\\</span><span class="st">.]&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb15-17"><a href="cleaning.html#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert column types to format to be used with read_fwf function</span></span>
<span id="cb15-18"><a href="cleaning.html#cb15-18" aria-hidden="true" tabindex="-1"></a>    df.dict<span class="sc">$</span>col.type <span class="ot">&lt;-</span> <span class="fu">sapply</span>(df.dict<span class="sc">$</span>col.type, <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;int&quot;</span>,<span class="st">&quot;byte&quot;</span>,<span class="st">&quot;long&quot;</span>), <span class="st">&quot;i&quot;</span>, <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="st">&quot;float&quot;</span>, <span class="st">&quot;n&quot;</span>, <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="st">&quot;double&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;c&quot;</span>))))</span>
<span id="cb15-19"><a href="cleaning.html#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Read the data file into a dataframe</span></span>
<span id="cb15-20"><a href="cleaning.html#cb15-20" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">read_fwf</span>(<span class="at">file =</span> data.file, <span class="fu">fwf_widths</span>(<span class="at">widths =</span> df.dict<span class="sc">$</span>col.width, <span class="at">col_names =</span> df.dict<span class="sc">$</span>col.name), <span class="at">col_types =</span> <span class="fu">paste</span>(df.dict<span class="sc">$</span>col.type, <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb15-21"><a href="cleaning.html#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add column labels to headers</span></span>
<span id="cb15-22"><a href="cleaning.html#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">attributes</span>(df)<span class="sc">$</span>variable.labels <span class="ot">&lt;-</span> df.dict<span class="sc">$</span>col.lbl</span>
<span id="cb15-23"><a href="cleaning.html#cb15-23" aria-hidden="true" tabindex="-1"></a>    old.names <span class="ot">&lt;-</span> (hrs_codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> Year))<span class="sc">$</span>orig_itemname</span>
<span id="cb15-24"><a href="cleaning.html#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">c</span>(<span class="st">&quot;PN&quot;</span>, <span class="st">&quot;HHID&quot;</span>) <span class="sc">%in%</span> <span class="fu">colnames</span>(df)) <span class="sc">&amp;</span> <span class="fu">any</span>(old.names <span class="sc">%in%</span> <span class="fu">colnames</span>(df))){</span>
<span id="cb15-25"><a href="cleaning.html#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if(any(c(&quot;PN&quot;, &quot;HHID&quot;) %in% colnames(df))){</span></span>
<span id="cb15-26"><a href="cleaning.html#cb15-26" aria-hidden="true" tabindex="-1"></a>      df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb15-27"><a href="cleaning.html#cb15-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">hhidpn =</span> <span class="dv">1000</span><span class="sc">*</span><span class="fu">as.numeric</span>(HHID) <span class="sc">+</span> <span class="fu">as.numeric</span>(PN)) <span class="sc">%&gt;%</span></span>
<span id="cb15-28"><a href="cleaning.html#cb15-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="fu">one_of</span>(<span class="fu">c</span>(<span class="st">&quot;PN&quot;</span>, <span class="st">&quot;HHID&quot;</span>)), <span class="fu">one_of</span>(old.names)) <span class="sc">%&gt;%</span></span>
<span id="cb15-29"><a href="cleaning.html#cb15-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">distinct</span>()</span>
<span id="cb15-30"><a href="cleaning.html#cb15-30" aria-hidden="true" tabindex="-1"></a>      <span class="co"># gather(key = item, value = value, -hhidpn)</span></span>
<span id="cb15-31"><a href="cleaning.html#cb15-31" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {df <span class="ot">&lt;-</span> <span class="cn">NA</span>}</span>
<span id="cb15-32"><a href="cleaning.html#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(df)</span>
<span id="cb15-33"><a href="cleaning.html#cb15-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb15-34"><a href="cleaning.html#cb15-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set path to the data file &quot;*.DA&quot;</span></span>
<span id="cb15-35"><a href="cleaning.html#cb15-35" aria-hidden="true" tabindex="-1"></a>  files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/hrs/%s&quot;</span>, data_path, year))</span>
<span id="cb15-36"><a href="cleaning.html#cb15-36" aria-hidden="true" tabindex="-1"></a>  df2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb15-37"><a href="cleaning.html#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">da =</span> files[<span class="fu">grepl</span>(<span class="st">&quot;.da&quot;</span>,  files) <span class="sc">|</span> <span class="fu">grepl</span>(<span class="st">&quot;.DA&quot;</span>, files)],</span>
<span id="cb15-38"><a href="cleaning.html#cb15-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">dct =</span> files[<span class="fu">grepl</span>(<span class="st">&quot;.dct&quot;</span>, files) <span class="sc">|</span> <span class="fu">grepl</span>(<span class="st">&quot;.DCT&quot;</span>, files)]</span>
<span id="cb15-39"><a href="cleaning.html#cb15-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-40"><a href="cleaning.html#cb15-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(da, dct, <span class="fu">possibly</span>(<span class="sc">~</span><span class="fu">read_da</span>(.x, .y, year), <span class="cn">NA_real_</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb15-41"><a href="cleaning.html#cb15-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(data)) <span class="sc">%&gt;%</span></span>
<span id="cb15-42"><a href="cleaning.html#cb15-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>da, <span class="sc">-</span>dct) </span>
<span id="cb15-43"><a href="cleaning.html#cb15-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(df2) <span class="sc">!=</span> <span class="dv">0</span>){df2<span class="sc">$</span>data <span class="sc">%&gt;%</span> <span class="fu">reduce</span>(full_join) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()} <span class="cf">else</span> {<span class="cn">NA</span>}</span>
<span id="cb15-44"><a href="cleaning.html#cb15-44" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="cleaning.html#cb16-1" aria-hidden="true" tabindex="-1"></a>hrs_codebook <span class="ot">&lt;-</span> (codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(study <span class="sc">==</span> <span class="st">&quot;HRS&quot;</span>))<span class="sc">$</span>codebook[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="cleaning.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">orig_itemname =</span> <span class="fu">str_to_upper</span>(orig_itemname)) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="cleaning.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(orig_itemname, name, itemname), <span class="sc">~</span><span class="fu">str_remove_all</span>(., <span class="st">&quot;[[:space:]]&quot;</span>))</span>
<span id="cb16-4"><a href="cleaning.html#cb16-4" aria-hidden="true" tabindex="-1"></a>hrs_codebook</span></code></pre></div>
<pre><code>## # A tibble: 702 × 17
##    study dataset category  name      itemname     wave waveletter  year orig_itemname descrip…¹ scale rever…² recode  mini  maxi comp_…³ long_…⁴
##    &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
##  1 hrs   Rand    cognition cognition digitsBckwd     3 &lt;NA&gt;        1996 R3BWC20       BACKWARD… &quot;0.I… no      ifels…    NA    NA sum     select 
##  2 hrs   Rand    cognition cognition digitsBckwd     4 &lt;NA&gt;        1998 R4BWC20       BACKWARD… &quot;0.I… no      ifels…    NA    NA sum     select 
##  3 hrs   Rand    cognition cognition digitsBckwd     5 &lt;NA&gt;        2000 R5BWC20       BACKWARD… &quot;0.I… no      ifels…    NA    NA sum     select 
##  4 hrs   Rand    cognition cognition digitsBckwd     6 &lt;NA&gt;        2002 R6BWC20       BACKWARD… &quot;0.I… no      ifels…    NA    NA sum     select 
##  5 hrs   Rand    cognition cognition digitsBckwd     7 &lt;NA&gt;        2004 R7BWC20       BACKWARD… &quot;0.I… no      ifels…    NA    NA sum     select 
##  6 hrs   Rand    cognition cognition digitsBckwd     8 &lt;NA&gt;        2006 R8BWC20       BACKWARD… &quot;0.I… no      ifels…    NA    NA sum     select 
##  7 hrs   Rand    cognition cognition digitsBckwd     9 &lt;NA&gt;        2008 R9BWC20       BACKWARD… &quot;0.I… no      ifels…    NA    NA sum     select 
##  8 hrs   Rand    cognition cognition digitsBckwd    10 &lt;NA&gt;        2010 R10BWC20      BACKWARD… &quot;0.I… no      ifels…    NA    NA sum     select 
##  9 hrs   Rand    cognition cognition digitsBckwd    11 &lt;NA&gt;        2012 R11BWC20      BACKWARD… &quot;0.I… no      ifels…    NA    NA sum     select 
## 10 hrs   Rand    cognition cognition digitsBckwd    12 &lt;NA&gt;        2014 R12BWC20      BACKWARD… &quot;0.I… no      ifels…    NA    NA sum     select 
## # … with 692 more rows, and abbreviated variable names ¹​description, ²​reverse_code, ³​comp_rule, ⁴​long_rule</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="cleaning.html#cb18-1" aria-hidden="true" tabindex="-1"></a>old.names <span class="ot">&lt;-</span> <span class="fu">unique</span>(hrs_codebook<span class="sc">$</span>orig_itemname)</span>
<span id="cb18-2"><a href="cleaning.html#cb18-2" aria-hidden="true" tabindex="-1"></a>hrs.paq <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb18-3"><a href="cleaning.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/hrs&quot;</span>, data_path) <span class="sc">%&gt;%</span> <span class="fu">list.files</span>(., <span class="at">pattern =</span> <span class="st">&quot;^[0-9]&quot;</span>)</span>
<span id="cb18-4"><a href="cleaning.html#cb18-4" aria-hidden="true" tabindex="-1"></a>  , <span class="at">data =</span> <span class="fu">map</span>(year, hrs_read_fun)</span>
<span id="cb18-5"><a href="cleaning.html#cb18-5" aria-hidden="true" tabindex="-1"></a>  , <span class="at">names =</span> <span class="fu">map</span>(data, colnames)</span>
<span id="cb18-6"><a href="cleaning.html#cb18-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="cleaning.html#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(data))</span>
<span id="cb18-8"><a href="cleaning.html#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="cleaning.html#cb18-9" aria-hidden="true" tabindex="-1"></a>old.names <span class="ot">&lt;-</span> <span class="fu">unique</span>((hrs_codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dataset <span class="sc">==</span> <span class="st">&quot;Rand&quot;</span>))<span class="sc">$</span>orig_itemname)</span>
<span id="cb18-10"><a href="cleaning.html#cb18-10" aria-hidden="true" tabindex="-1"></a>hrs.rand <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/hrs/randhrs1992_2016v1.sav&quot;</span>, data_path) <span class="sc">%&gt;%</span> </span>
<span id="cb18-11"><a href="cleaning.html#cb18-11" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sav</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="cleaning.html#cb18-12" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">zap_labels</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="cleaning.html#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">SID =</span> HHIDPN, <span class="fu">one_of</span>(old.names)) <span class="sc">%&gt;%</span></span>
<span id="cb18-14"><a href="cleaning.html#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> orig_itemname, <span class="at">value =</span> value, <span class="sc">-</span>SID, <span class="at">na.rm =</span> T)</span>
<span id="cb18-15"><a href="cleaning.html#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="cleaning.html#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="cleaning.html#cb18-17" aria-hidden="true" tabindex="-1"></a>hrs_long <span class="ot">&lt;-</span> hrs.paq <span class="sc">%&gt;%</span></span>
<span id="cb18-18"><a href="cleaning.html#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb18-19"><a href="cleaning.html#cb18-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="sc">-</span>HHID, <span class="sc">-</span>PN)</span>
<span id="cb18-20"><a href="cleaning.html#cb18-20" aria-hidden="true" tabindex="-1"></a>                   , <span class="at">names_to =</span> <span class="st">&quot;orig_itemname&quot;</span></span>
<span id="cb18-21"><a href="cleaning.html#cb18-21" aria-hidden="true" tabindex="-1"></a>                   , <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span></span>
<span id="cb18-22"><a href="cleaning.html#cb18-22" aria-hidden="true" tabindex="-1"></a>                   , <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb18-23"><a href="cleaning.html#cb18-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>names, <span class="sc">-</span>year) <span class="sc">%&gt;%</span></span>
<span id="cb18-24"><a href="cleaning.html#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb18-25"><a href="cleaning.html#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SID =</span> <span class="dv">1000</span><span class="sc">*</span><span class="fu">as.numeric</span>(HHID) <span class="sc">+</span> <span class="fu">as.numeric</span>(PN)) <span class="sc">%&gt;%</span></span>
<span id="cb18-26"><a href="cleaning.html#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>PN, <span class="sc">-</span>HHID) </span>
<span id="cb18-27"><a href="cleaning.html#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="cleaning.html#cb18-28" aria-hidden="true" tabindex="-1"></a>hrs_dem <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/hrs/pdem_withvarnames.sas7bdat&quot;</span>, data_path) <span class="sc">%&gt;%</span></span>
<span id="cb18-29"><a href="cleaning.html#cb18-29" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">read_sas</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb18-30"><a href="cleaning.html#cb18-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">SID =</span> hhidpn, <span class="at">year =</span> prediction_year, <span class="at">value =</span> prob_dementia) <span class="sc">%&gt;%</span></span>
<span id="cb18-31"><a href="cleaning.html#cb18-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">orig_itemname =</span> <span class="st">&quot;PROB_DEMENTIA&quot;</span>)</span>
<span id="cb18-32"><a href="cleaning.html#cb18-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-33"><a href="cleaning.html#cb18-33" aria-hidden="true" tabindex="-1"></a>hrs.subs <span class="ot">&lt;-</span> <span class="fu">unique</span>(hrs_long<span class="sc">$</span>SID)[<span class="fu">unique</span>(hrs_long<span class="sc">$</span>SID) <span class="sc">%in%</span> <span class="fu">unique</span>(hrs.rand<span class="sc">$</span>SID)]</span>
<span id="cb18-34"><a href="cleaning.html#cb18-34" aria-hidden="true" tabindex="-1"></a>hrs_long <span class="ot">&lt;-</span> hrs_long <span class="sc">%&gt;%</span></span>
<span id="cb18-35"><a href="cleaning.html#cb18-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(hrs.rand <span class="sc">%&gt;%</span> <span class="fu">select</span>(orig_itemname, value, SID)) <span class="sc">%&gt;%</span></span>
<span id="cb18-36"><a href="cleaning.html#cb18-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SID <span class="sc">%in%</span> hrs.subs)</span>
<span id="cb18-37"><a href="cleaning.html#cb18-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-38"><a href="cleaning.html#cb18-38" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(hrs.rand, hrs.paq, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/hrs_raw.RData&quot;</span>, load_path))</span>
<span id="cb18-39"><a href="cleaning.html#cb18-39" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">c</span>(<span class="st">&quot;hrs.paq&quot;</span>, <span class="st">&quot;hrs.rand&quot;</span>))</span></code></pre></div>
</div>
<div id="recoding-reverse-scoring" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Recoding &amp; Reverse Scoring<a href="cleaning.html#recoding-reverse-scoring" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="cleaning.html#cb19-1" aria-hidden="true" tabindex="-1"></a>hrs_waves <span class="ot">&lt;-</span> p_waves <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Study <span class="sc">==</span> <span class="st">&quot;HRS&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Used) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb19-2"><a href="cleaning.html#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="cleaning.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># join data with recoding info </span></span>
<span id="cb19-4"><a href="cleaning.html#cb19-4" aria-hidden="true" tabindex="-1"></a>hrs_recode <span class="ot">&lt;-</span> hrs_codebook <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="cleaning.html#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;pers&quot;</span>, <span class="st">&quot;outcome&quot;</span>, <span class="st">&quot;covariates&quot;</span>, <span class="st">&quot;cognition&quot;</span>) <span class="sc">&amp;</span> orig_itemname <span class="sc">!=</span> <span class="st">&quot;prob_dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="cleaning.html#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(category, name, itemname, wave, year, orig_itemname, reverse_code<span class="sc">:</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="cleaning.html#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category, name) <span class="sc">%&gt;%</span> </span>
<span id="cb19-8"><a href="cleaning.html#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-9"><a href="cleaning.html#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-10"><a href="cleaning.html#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(hrs_long))) </span>
<span id="cb19-11"><a href="cleaning.html#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="cleaning.html#cb19-12" aria-hidden="true" tabindex="-1"></a>hrs_recode <span class="ot">&lt;-</span> hrs_dem <span class="sc">%&gt;%</span></span>
<span id="cb19-13"><a href="cleaning.html#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb19-14"><a href="cleaning.html#cb19-14" aria-hidden="true" tabindex="-1"></a>    hrs_codebook <span class="sc">%&gt;%</span> </span>
<span id="cb19-15"><a href="cleaning.html#cb19-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(category, name, itemname, orig_itemname, reverse_code<span class="sc">:</span>long_rule)</span>
<span id="cb19-16"><a href="cleaning.html#cb19-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb19-17"><a href="cleaning.html#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category, name) <span class="sc">%&gt;%</span></span>
<span id="cb19-18"><a href="cleaning.html#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-19"><a href="cleaning.html#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-20"><a href="cleaning.html#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(hrs_recode)</span>
<span id="cb19-21"><a href="cleaning.html#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="cleaning.html#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co"># recode </span></span>
<span id="cb19-23"><a href="cleaning.html#cb19-23" aria-hidden="true" tabindex="-1"></a>recode_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(rule, y, year, p_year){</span>
<span id="cb19-24"><a href="cleaning.html#cb19-24" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y<span class="sc">$</span>value</span>
<span id="cb19-25"><a href="cleaning.html#cb19-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(rule)){y<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> rule))}</span>
<span id="cb19-26"><a href="cleaning.html#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb19-27"><a href="cleaning.html#cb19-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-28"><a href="cleaning.html#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="cleaning.html#cb19-29" aria-hidden="true" tabindex="-1"></a>hrs_recode <span class="ot">&lt;-</span> hrs_recode <span class="sc">%&gt;%</span> </span>
<span id="cb19-30"><a href="cleaning.html#cb19-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb19-31"><a href="cleaning.html#cb19-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">mapvalues</span>(year, <span class="fu">seq</span>(<span class="dv">2006</span>, <span class="dv">2016</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2006</span>, <span class="dv">2010</span>, <span class="dv">2014</span>), <span class="at">each =</span> <span class="dv">2</span>)),</span>
<span id="cb19-32"><a href="cleaning.html#cb19-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">p_year =</span> <span class="dv">2006</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-33"><a href="cleaning.html#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(recode, year, p_year) <span class="sc">%&gt;%</span></span>
<span id="cb19-34"><a href="cleaning.html#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-35"><a href="cleaning.html#cb19-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-36"><a href="cleaning.html#cb19-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(recode, data, year, p_year), recode_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb19-37"><a href="cleaning.html#cb19-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb19-38"><a href="cleaning.html#cb19-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(value <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.nan</span>(value) <span class="sc">|</span> <span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value))))</span>
<span id="cb19-39"><a href="cleaning.html#cb19-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-40"><a href="cleaning.html#cb19-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-41"><a href="cleaning.html#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="co"># reverse code </span></span>
<span id="cb19-42"><a href="cleaning.html#cb19-42" aria-hidden="true" tabindex="-1"></a>hrs_recode <span class="ot">&lt;-</span> hrs_recode <span class="sc">%&gt;%</span></span>
<span id="cb19-43"><a href="cleaning.html#cb19-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb19-44"><a href="cleaning.html#cb19-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(reverse_code <span class="sc">==</span> <span class="st">&quot;no&quot;</span> <span class="sc">|</span> <span class="fu">is.na</span>(reverse_code), value, </span>
<span id="cb19-45"><a href="cleaning.html#cb19-45" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">reverse.code</span>(<span class="sc">-</span><span class="dv">1</span>, value, <span class="at">mini =</span> mini, <span class="at">maxi =</span> maxi)))))</span>
<span id="cb19-46"><a href="cleaning.html#cb19-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-47"><a href="cleaning.html#cb19-47" aria-hidden="true" tabindex="-1"></a>fun_call <span class="ot">&lt;-</span> <span class="cf">function</span>(x, rule){</span>
<span id="cb19-48"><a href="cleaning.html#cb19-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span>(rule,</span>
<span id="cb19-49"><a href="cleaning.html#cb19-49" aria-hidden="true" tabindex="-1"></a>           <span class="at">average =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb19-50"><a href="cleaning.html#cb19-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">mode =</span> <span class="fu">Mode</span>(x)[<span class="dv">1</span>],</span>
<span id="cb19-51"><a href="cleaning.html#cb19-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">sum =</span> <span class="fu">sum</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb19-52"><a href="cleaning.html#cb19-52" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb19-53"><a href="cleaning.html#cb19-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">select =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb19-54"><a href="cleaning.html#cb19-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb19-55"><a href="cleaning.html#cb19-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">min =</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> T))</span>
<span id="cb19-56"><a href="cleaning.html#cb19-56" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div id="covariates" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Covariates<a href="cleaning.html#covariates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="cleaning.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compositing within years</span></span>
<span id="cb20-2"><a href="cleaning.html#cb20-2" aria-hidden="true" tabindex="-1"></a>year_comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, rule){</span>
<span id="cb20-3"><a href="cleaning.html#cb20-3" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="cleaning.html#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># group by person and item (collapse across age)</span></span>
<span id="cb20-5"><a href="cleaning.html#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name, year, p_year, long_rule) <span class="sc">%&gt;%</span> </span>
<span id="cb20-6"><a href="cleaning.html#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="cleaning.html#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb20-8"><a href="cleaning.html#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value))</span>
<span id="cb20-9"><a href="cleaning.html#cb20-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-10"><a href="cleaning.html#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="cleaning.html#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># composite WITHIN years </span></span>
<span id="cb20-12"><a href="cleaning.html#cb20-12" aria-hidden="true" tabindex="-1"></a>hrs_cov <span class="ot">&lt;-</span> hrs_recode <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="cleaning.html#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;covariates&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-14"><a href="cleaning.html#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>category) <span class="sc">%&gt;%</span></span>
<span id="cb20-15"><a href="cleaning.html#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb20-16"><a href="cleaning.html#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comp_rule =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(comp_rule), <span class="st">&quot;skip&quot;</span>, comp_rule)) <span class="sc">%&gt;%</span></span>
<span id="cb20-17"><a href="cleaning.html#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(comp_rule) <span class="sc">%&gt;%</span></span>
<span id="cb20-18"><a href="cleaning.html#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-19"><a href="cleaning.html#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-20"><a href="cleaning.html#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, comp_rule, year_comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb20-21"><a href="cleaning.html#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb20-22"><a href="cleaning.html#cb20-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-23"><a href="cleaning.html#cb20-23" aria-hidden="true" tabindex="-1"></a>comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, rule, p_year){</span>
<span id="cb20-24"><a href="cleaning.html#cb20-24" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb20-25"><a href="cleaning.html#cb20-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">&lt;=</span> p_year) <span class="sc">%&gt;%</span></span>
<span id="cb20-26"><a href="cleaning.html#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb20-27"><a href="cleaning.html#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb20-28"><a href="cleaning.html#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-29"><a href="cleaning.html#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>()</span>
<span id="cb20-30"><a href="cleaning.html#cb20-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-31"><a href="cleaning.html#cb20-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-32"><a href="cleaning.html#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="co"># composite ACROSS years</span></span>
<span id="cb20-33"><a href="cleaning.html#cb20-33" aria-hidden="true" tabindex="-1"></a>hrs_cov <span class="ot">&lt;-</span> hrs_cov <span class="sc">%&gt;%</span></span>
<span id="cb20-34"><a href="cleaning.html#cb20-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">long_rule =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(long_rule), <span class="st">&quot;skip&quot;</span>, long_rule)) <span class="sc">%&gt;%</span></span>
<span id="cb20-35"><a href="cleaning.html#cb20-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(p_year, long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb20-36"><a href="cleaning.html#cb20-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-37"><a href="cleaning.html#cb20-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-38"><a href="cleaning.html#cb20-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(data, long_rule, p_year), comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb20-39"><a href="cleaning.html#cb20-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb20-40"><a href="cleaning.html#cb20-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb20-41"><a href="cleaning.html#cb20-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb20-42"><a href="cleaning.html#cb20-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(name, value) <span class="sc">%&gt;%</span></span>
<span id="cb20-43"><a href="cleaning.html#cb20-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SID))</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="cleaning.html#cb21-1" aria-hidden="true" tabindex="-1"></a>hrs_cov</span></code></pre></div>
<pre><code>## # A tibble: 28,726 × 19
##    p_year      SID alcohol   BMI cancer diabe…¹ educa…² exerc…³ gender heart…⁴ height married  race respDis smokes SRhea…⁵ stroke weight yearB…⁶
##     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1   2006     3010       1  28.8      0       0      12    2.02      0       1   165.       1     0       0      0       2      0   73.4    1936
##  2   2006     3020       1  28.8      1       0      16    1.77      1       0   165.       1     0       0      0       3      0   83.6    1938
##  3   2006 10001010       0  23.5      0       0      12    1.88      0       0   183.       0     0       0      0       5      0   78.6    1939
##  4   2006 10003030       0  28.5      0       0      16    1.25      1       1   157.       1     0       1      0       3      1   76.8    1956
##  5   2006 10004010       1  27.0      1       0      16    1.75      0       0   185.       1     0       0      1       5      0   99.7    1939
##  6   2006 10004040       1  27.0      0       0      12    2         1       0   165.       1     0       0      1       5      0   68.4    1946
##  7   2006 10013010       0  28.2      0       1      12    1.57      0       1   177.       1     0       0      1       5      0   89.0    1938
##  8   2006 10013040       1  24.5      0       0      13    1.5       1       0   160.       1     0       0      1       3      0   62.2    1947
##  9   2006 10038010       1  23.3      0       0      16    1.75      0       1   177.       1     0       0      0       5      0   76.7    1936
## 10   2006 10038040       1  23.3      0       0      16    1.78      1       0   170.       1     0       0      1       5      0   64.1    1943
## # … with 28,716 more rows, and abbreviated variable names ¹​diabetes, ²​education, ³​exercise, ⁴​heartProb, ⁵​SRhealth, ⁶​yearBrth</code></pre>
</div>
<div id="personality-variables" class="section level3 hasAnchor" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> Personality Variables<a href="cleaning.html#personality-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="cleaning.html#cb23-1" aria-hidden="true" tabindex="-1"></a>hrs_pers <span class="ot">&lt;-</span> hrs_recode <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="cleaning.html#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;pers&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="cleaning.html#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>category) <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="cleaning.html#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="cleaning.html#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="st">&quot;2006&quot;</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="cleaning.html#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, p_year, year, name, itemname, comp_rule) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="cleaning.html#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="cleaning.html#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb23-9"><a href="cleaning.html#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="cleaning.html#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha&#39;s</span></span>
<span id="cb23-11"><a href="cleaning.html#cb23-11" aria-hidden="true" tabindex="-1"></a>hrs_alpha <span class="ot">&lt;-</span> hrs_pers <span class="sc">%&gt;%</span></span>
<span id="cb23-12"><a href="cleaning.html#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb23-13"><a href="cleaning.html#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, itemname, year, SID, value) <span class="sc">%&gt;%</span></span>
<span id="cb23-14"><a href="cleaning.html#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, year) <span class="sc">%&gt;%</span></span>
<span id="cb23-15"><a href="cleaning.html#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-16"><a href="cleaning.html#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> itemname, <span class="at">values_from =</span> value, <span class="at">values_fn =</span> <span class="fu">list</span>(mean))),</span>
<span id="cb23-17"><a href="cleaning.html#cb23-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">alpha =</span> <span class="fu">map</span>(data, <span class="fu">possibly</span>(<span class="sc">~</span>psych<span class="sc">::</span><span class="fu">alpha</span>((.) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>SID)), <span class="cn">NA_real_</span>)))</span>
<span id="cb23-18"><a href="cleaning.html#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="cleaning.html#cb23-19" aria-hidden="true" tabindex="-1"></a>comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, rule){</span>
<span id="cb23-20"><a href="cleaning.html#cb23-20" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb23-21"><a href="cleaning.html#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID) <span class="sc">%&gt;%</span></span>
<span id="cb23-22"><a href="cleaning.html#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb23-23"><a href="cleaning.html#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-24"><a href="cleaning.html#cb23-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value))</span>
<span id="cb23-25"><a href="cleaning.html#cb23-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-26"><a href="cleaning.html#cb23-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-27"><a href="cleaning.html#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="co"># create composites</span></span>
<span id="cb23-28"><a href="cleaning.html#cb23-28" aria-hidden="true" tabindex="-1"></a>hrs_pers <span class="ot">&lt;-</span> hrs_pers <span class="sc">%&gt;%</span></span>
<span id="cb23-29"><a href="cleaning.html#cb23-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, comp_rule, year) <span class="sc">%&gt;%</span></span>
<span id="cb23-30"><a href="cleaning.html#cb23-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-31"><a href="cleaning.html#cb23-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-32"><a href="cleaning.html#cb23-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, comp_rule, comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb23-33"><a href="cleaning.html#cb23-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb23-34"><a href="cleaning.html#cb23-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>comp_rule)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="cleaning.html#cb24-1" aria-hidden="true" tabindex="-1"></a>hrs_pers</span></code></pre></div>
<pre><code>## # A tibble: 116,915 × 4
##     year name       SID value
##    &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
##  1  2006 A         3010   3  
##  2  2006 A         3020   3  
##  3  2006 A     10001010   4  
##  4  2006 A     10003030   3.4
##  5  2006 A     10004010   3.4
##  6  2006 A     10004040   3.6
##  7  2006 A     10013010   2  
##  8  2006 A     10013040   2.6
##  9  2006 A     10038010   3.4
## 10  2006 A     10038040   2.6
## # … with 116,905 more rows</code></pre>
</div>
<div id="cognition-variables" class="section level3 hasAnchor" number="2.1.5">
<h3><span class="header-section-number">2.1.5</span> Cognition Variables<a href="cleaning.html#cognition-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="cleaning.html#cb26-1" aria-hidden="true" tabindex="-1"></a>hrs_cog <span class="ot">&lt;-</span> hrs_recode <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="cleaning.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;cognition&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="cleaning.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>category) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="cleaning.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="cleaning.html#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> p_year) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="cleaning.html#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="cleaning.html#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, itemname, year) <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="cleaning.html#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">pomp</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb26-9"><a href="cleaning.html#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb26-10"><a href="cleaning.html#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">mean</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb26-11"><a href="cleaning.html#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-12"><a href="cleaning.html#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="cleaning.html#cb27-1" aria-hidden="true" tabindex="-1"></a>hrs_cog</span></code></pre></div>
<pre><code>## # A tibble: 16,778 × 2
##         SID cognition
##       &lt;dbl&gt;     &lt;dbl&gt;
##  1     3010      7.5 
##  2     3020      8.08
##  3 10001010      8.75
##  4 10003030      6   
##  5 10004010      7.92
##  6 10004040      8.83
##  7 10013010      7.25
##  8 10013040      8.67
##  9 10038010      8.58
## 10 10038040      8.25
## # … with 16,768 more rows</code></pre>
</div>
<div id="outcome-variables" class="section level3 hasAnchor" number="2.1.6">
<h3><span class="header-section-number">2.1.6</span> Outcome Variables<a href="cleaning.html#outcome-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="cleaning.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># composite within years </span></span>
<span id="cb29-2"><a href="cleaning.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># compositing within years</span></span>
<span id="cb29-3"><a href="cleaning.html#cb29-3" aria-hidden="true" tabindex="-1"></a>hrs_out <span class="ot">&lt;-</span> hrs_recode <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="cleaning.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;outcome&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="cleaning.html#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="cleaning.html#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name, year, p_year) <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="cleaning.html#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href="cleaning.html#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-9"><a href="cleaning.html#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(value) <span class="sc">|</span> <span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value),</span>
<span id="cb29-10"><a href="cleaning.html#cb29-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">group =</span> <span class="fu">ifelse</span>(year <span class="sc">&gt;</span> p_year, <span class="st">&quot;future&quot;</span>, <span class="st">&quot;past&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-11"><a href="cleaning.html#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb29-12"><a href="cleaning.html#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, p_year, year, name, group) <span class="sc">%&gt;%</span></span>
<span id="cb29-13"><a href="cleaning.html#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(value <span class="sc">&lt;</span> .<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-14"><a href="cleaning.html#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, p_year, name, group) <span class="sc">%&gt;%</span></span>
<span id="cb29-15"><a href="cleaning.html#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb29-16"><a href="cleaning.html#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-17"><a href="cleaning.html#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb29-18"><a href="cleaning.html#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> group, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb29-19"><a href="cleaning.html#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb29-20"><a href="cleaning.html#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(past) <span class="sc">|</span> (past <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(future)), future,</span>
<span id="cb29-21"><a href="cleaning.html#cb29-21" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(past <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(future), past, </span>
<span id="cb29-22"><a href="cleaning.html#cb29-22" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(past <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb29-23"><a href="cleaning.html#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ungroup</span>()</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="cleaning.html#cb30-1" aria-hidden="true" tabindex="-1"></a>hrs_out</span></code></pre></div>
<pre><code>## # A tibble: 27,187 × 6
##         SID p_year name     future  past value
##       &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     3010   2006 dementia      1    NA     1
##  2     3020   2006 dementia      0    NA     0
##  3 10001010   2006 dementia      0    NA     0
##  4 10003030   2006 dementia      0    NA     0
##  5 10004010   2006 dementia      0    NA     0
##  6 10004040   2006 dementia      0    NA     0
##  7 10013010   2006 dementia      1    NA     1
##  8 10013040   2006 dementia      0    NA     0
##  9 10038010   2006 dementia      0    NA     0
## 10 10038040   2006 dementia      0    NA     0
## # … with 27,177 more rows</code></pre>
</div>
<div id="combine-data" class="section level3 hasAnchor" number="2.1.7">
<h3><span class="header-section-number">2.1.7</span> Combine Data<a href="cleaning.html#combine-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="cleaning.html#cb32-1" aria-hidden="true" tabindex="-1"></a>hrs_combined <span class="ot">&lt;-</span> hrs_pers <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="cleaning.html#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Trait =</span> name, <span class="at">p_value =</span> value, <span class="at">p_year =</span> year) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="cleaning.html#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(hrs_out <span class="sc">%&gt;%</span> <span class="fu">select</span>(SID, <span class="at">Outcome =</span> name, <span class="at">o_value =</span> value)) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="cleaning.html#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(hrs_cov) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="cleaning.html#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb32-6"><a href="cleaning.html#cb32-6" aria-hidden="true" tabindex="-1"></a>    hrs_out <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="cleaning.html#cb32-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="cleaning.html#cb32-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">rowSums</span>(<span class="fu">cbind</span>(future, past), <span class="at">na.rm =</span> T) <span class="sc">&gt;=</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="cleaning.html#cb32-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>future, <span class="sc">-</span>past) <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="cleaning.html#cb32-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb32-11"><a href="cleaning.html#cb32-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb32-12"><a href="cleaning.html#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(hrs_cog) <span class="sc">%&gt;%</span></span>
<span id="cb32-13"><a href="cleaning.html#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_value) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(o_value)) <span class="sc">%&gt;%</span></span>
<span id="cb32-14"><a href="cleaning.html#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> p_year <span class="sc">-</span> yearBrth</span>
<span id="cb32-15"><a href="cleaning.html#cb32-15" aria-hidden="true" tabindex="-1"></a>         , <span class="at">o_year =</span> <span class="dv">2014</span>)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="cleaning.html#cb33-1" aria-hidden="true" tabindex="-1"></a>hrs_combined</span></code></pre></div>
<pre><code>## # A tibble: 110,816 × 27
##    p_year Trait      SID p_value Outcome o_value alcohol   BMI cancer diabe…¹ educa…² exerc…³ gender heart…⁴ height married  race respDis smokes
##     &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
##  1   2006 A         3010     3   dement…       1       1  28.8      0       0      12    2.02      0       1   165.       1     0       0      0
##  2   2006 A         3020     3   dement…       0       1  28.8      1       0      16    1.77      1       0   165.       1     0       0      0
##  3   2006 A     10001010     4   dement…       0       0  23.5      0       0      12    1.88      0       0   183.       0     0       0      0
##  4   2006 A     10003030     3.4 dement…       0       0  28.5      0       0      16    1.25      1       1   157.       1     0       1      0
##  5   2006 A     10004010     3.4 dement…       0       1  27.0      1       0      16    1.75      0       0   185.       1     0       0      1
##  6   2006 A     10004040     3.6 dement…       0       1  27.0      0       0      12    2         1       0   165.       1     0       0      1
##  7   2006 A     10013010     2   dement…       1       0  28.2      0       1      12    1.57      0       1   177.       1     0       0      1
##  8   2006 A     10013040     2.6 dement…       0       1  24.5      0       0      13    1.5       1       0   160.       1     0       0      1
##  9   2006 A     10038010     3.4 dement…       0       1  23.3      0       0      16    1.75      0       1   177.       1     0       0      0
## 10   2006 A     10038040     2.6 dement…       0       1  23.3      0       0      16    1.78      1       0   170.       1     0       0      1
## # … with 110,806 more rows, 8 more variables: SRhealth &lt;dbl&gt;, stroke &lt;dbl&gt;, weight &lt;dbl&gt;, yearBrth &lt;dbl&gt;, dementia &lt;dbl&gt;, cognition &lt;dbl&gt;,
## #   age &lt;dbl&gt;, o_year &lt;dbl&gt;, and abbreviated variable names ¹​diabetes, ²​education, ³​exercise, ⁴​heartProb</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="cleaning.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(hrs_cov, hrs_alpha, hrs_pers, hrs_out, hrs_combined, hrs_cog,</span>
<span id="cb35-2"><a href="cleaning.html#cb35-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/hrs_cleaned.RData&quot;</span>, load_path))</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="cleaning.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span><span class="fu">ls</span>()[<span class="fu">grepl</span>(<span class="st">&quot;hrs&quot;</span>, <span class="fu">ls</span>())])</span></code></pre></div>
</div>
</div>
<div id="rush-memory-and-and-aging-project-rush-map" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> RUSH Memory and and Aging Project (RUSH-MAP)<a href="cleaning.html#rush-memory-and-and-aging-project-rush-map" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The RUSH Memory and Aging Project (RUSH-MAP) is an ongoing longitudinal study that began in 1997 <span class="citation">(<a href="#ref-a2012overview" role="doc-biblioref"><strong>a2012overview?</strong></a>)</span>. These data are available, through application from <a href="https://www.radc.rush.edu/requests.htm" class="uri">https://www.radc.rush.edu/requests.htm</a>.</p>
<p>Participants who were 65 and older were recruited from retirement communities and subsidized senior housing facilities throughout Chicagoland and northeastern Illinois beginning in 1997. Data are collected annually, and all participants are organ donors. Additional participants are recuited each year. Additional information and documentation on the data can be found at <a href="https://www.radc.rush.edu/docs/var/variables.htm" class="uri">https://www.radc.rush.edu/docs/var/variables.htm</a>.</p>
<p>Sample sizes vary by year, ranging from 52 (1997) to 2205 participants including 884 deceased participants with autopsy data (2019, 2020). This provides 99% power to detect a zero-order correlation effect size of ~.10, two-tailed at alpha .05.</p>
<div id="load-data-1" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Load Data<a href="cleaning.html#load-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="cleaning.html#cb37-1" aria-hidden="true" tabindex="-1"></a>(map_codebook <span class="ot">&lt;-</span> (codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(study <span class="sc">==</span> <span class="st">&quot;RADC-MAP&quot;</span>))<span class="sc">$</span>codebook[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="cleaning.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">orig_itemname =</span> <span class="fu">str_to_lower</span>(orig_itemname)))</span></code></pre></div>
<pre><code>## # A tibble: 44 × 15
##    study    dataset category   name      itemname    year         orig_itemname description     scale rever…¹ recode  mini  maxi comp_…² long_…³
##    &lt;chr&gt;    &lt;lgl&gt;   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;           &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
##  1 RADC-MAP NA      cognition  cognition freeRecall  longitudinal cts_wlii      word list reca…  &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  2 RADC-MAP NA      cognition  cognition cuedRecall  longitudinal cts_wliii     word list reco…  &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  3 RADC-MAP NA      cognition  cognition digitsFrwd  longitudinal cts_df        digits backward  &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  4 RADC-MAP NA      cognition  cognition digitsBckwd longitudinal cts_db        digits forward   &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  5 RADC-MAP NA      cognition  cognition catFluency  longitudinal cts_catflu    category fluen…  &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  6 RADC-MAP NA      cognition  cognition bosNaming   longitudinal cts_bname     Boston naming …  &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  7 RADC-MAP NA      cognition  cognition progMat     longitudinal cts_pmat      progressive ma…  &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  8 RADC-MAP NA      cognition  cognition digitSymbol longitudinal cts_sdmt      symbol digits …  &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  9 RADC-MAP NA      covariates age       ageBaseline baseline     age_bl        The age at bas…  &lt;NA&gt; no      ifels…    NA    NA skip    select 
## 10 RADC-MAP NA      covariates alcohol   alcohol     baseline     alcohol_g_bl  Grams of alcoh… &quot;\r\… no      ifels…    NA    NA skip    average
## # … with 34 more rows, and abbreviated variable names ¹​reverse_code, ²​comp_rule, ³​long_rule</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="cleaning.html#cb39-1" aria-hidden="true" tabindex="-1"></a>map <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/rush-radc/dataset_1033_long_03-24-2021.xlsx&quot;</span>, data_path) <span class="sc">%&gt;%</span> <span class="fu">read_excel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="cleaning.html#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/rush-radc/dataset_1033_basic_03-24-2021.xlsx&quot;</span>, data_path) <span class="sc">%&gt;%</span> <span class="fu">read_excel</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="cleaning.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/rush-radc/dataset_1034_long_03-25-2021.xlsx&quot;</span>, data_path) <span class="sc">%&gt;%</span> <span class="fu">read_excel</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="cleaning.html#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/rush-radc/dataset_1034_basic_03-25-2021.xlsx&quot;</span>, data_path) <span class="sc">%&gt;%</span> <span class="fu">read_excel</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="cleaning.html#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(study <span class="sc">==</span> <span class="st">&quot;MAP&quot;</span>)</span></code></pre></div>
</div>
<div id="recoding-reverse-scoring-1" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Recoding &amp; Reverse Scoring<a href="cleaning.html#recoding-reverse-scoring-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="cleaning.html#cb40-1" aria-hidden="true" tabindex="-1"></a>rename_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(cb, var){</span>
<span id="cb40-2"><a href="cleaning.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(var)</span>
<span id="cb40-3"><a href="cleaning.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  old.names <span class="ot">&lt;-</span> <span class="fu">unique</span>((map_codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> var))<span class="sc">$</span>orig_itemname)</span>
<span id="cb40-4"><a href="cleaning.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> map <span class="sc">%&gt;%</span> </span>
<span id="cb40-5"><a href="cleaning.html#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">SID =</span> projid, <span class="at">wave =</span> fu_year, <span class="fu">one_of</span>(old.names)) <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="cleaning.html#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> orig_itemname, <span class="at">value =</span> value, <span class="sc">-</span>SID, <span class="sc">-</span>wave, <span class="at">na.rm =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="cleaning.html#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(cb <span class="sc">%&gt;%</span> <span class="fu">select</span>(itemname, orig_itemname, reverse_code<span class="sc">:</span>long_rule))</span>
<span id="cb40-8"><a href="cleaning.html#cb40-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-9"><a href="cleaning.html#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="cleaning.html#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co"># join data with recoding info </span></span>
<span id="cb40-11"><a href="cleaning.html#cb40-11" aria-hidden="true" tabindex="-1"></a>map_recode <span class="ot">&lt;-</span> map_codebook <span class="sc">%&gt;%</span></span>
<span id="cb40-12"><a href="cleaning.html#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(category, name, itemname, year, orig_itemname, reverse_code<span class="sc">:</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb40-13"><a href="cleaning.html#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;pers&quot;</span>, <span class="st">&quot;outcome&quot;</span>, <span class="st">&quot;covariates&quot;</span>, <span class="st">&quot;cognition&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-14"><a href="cleaning.html#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category, name) <span class="sc">%&gt;%</span></span>
<span id="cb40-15"><a href="cleaning.html#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb40-16"><a href="cleaning.html#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-17"><a href="cleaning.html#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, name, rename_fun))</span>
<span id="cb40-18"><a href="cleaning.html#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="cleaning.html#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co"># recode </span></span>
<span id="cb40-20"><a href="cleaning.html#cb40-20" aria-hidden="true" tabindex="-1"></a>recode_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(rule, y, year){</span>
<span id="cb40-21"><a href="cleaning.html#cb40-21" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y<span class="sc">$</span>value</span>
<span id="cb40-22"><a href="cleaning.html#cb40-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(rule)){y<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> rule))}</span>
<span id="cb40-23"><a href="cleaning.html#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb40-24"><a href="cleaning.html#cb40-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-25"><a href="cleaning.html#cb40-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-26"><a href="cleaning.html#cb40-26" aria-hidden="true" tabindex="-1"></a>map_recode <span class="ot">&lt;-</span> map_recode <span class="sc">%&gt;%</span> </span>
<span id="cb40-27"><a href="cleaning.html#cb40-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb40-28"><a href="cleaning.html#cb40-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">wave =</span> <span class="fu">as.numeric</span>(wave)) <span class="sc">%&gt;%</span></span>
<span id="cb40-29"><a href="cleaning.html#cb40-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(recode, wave) <span class="sc">%&gt;%</span></span>
<span id="cb40-30"><a href="cleaning.html#cb40-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-31"><a href="cleaning.html#cb40-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-32"><a href="cleaning.html#cb40-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(recode, data, wave), recode_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb40-33"><a href="cleaning.html#cb40-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb40-34"><a href="cleaning.html#cb40-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(value <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.nan</span>(value) <span class="sc">|</span> <span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value))))</span>
<span id="cb40-35"><a href="cleaning.html#cb40-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-36"><a href="cleaning.html#cb40-36" aria-hidden="true" tabindex="-1"></a><span class="co"># reverse code </span></span>
<span id="cb40-37"><a href="cleaning.html#cb40-37" aria-hidden="true" tabindex="-1"></a>map_recode <span class="ot">&lt;-</span> map_recode <span class="sc">%&gt;%</span></span>
<span id="cb40-38"><a href="cleaning.html#cb40-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb40-39"><a href="cleaning.html#cb40-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">as.numeric</span>(value), </span>
<span id="cb40-40"><a href="cleaning.html#cb40-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">ifelse</span>(reverse_code <span class="sc">==</span> <span class="st">&quot;no&quot;</span> <span class="sc">|</span> <span class="fu">is.na</span>(reverse_code), value, </span>
<span id="cb40-41"><a href="cleaning.html#cb40-41" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">reverse.code</span>(<span class="sc">-</span><span class="dv">1</span>, value, <span class="at">mini =</span> mini, <span class="at">maxi =</span> maxi)))))</span>
<span id="cb40-42"><a href="cleaning.html#cb40-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-43"><a href="cleaning.html#cb40-43" aria-hidden="true" tabindex="-1"></a>fun_call <span class="ot">&lt;-</span> <span class="cf">function</span>(x, rule){</span>
<span id="cb40-44"><a href="cleaning.html#cb40-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span>(rule,</span>
<span id="cb40-45"><a href="cleaning.html#cb40-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">average =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb40-46"><a href="cleaning.html#cb40-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">mode =</span> <span class="fu">Mode</span>(x)[<span class="dv">1</span>],</span>
<span id="cb40-47"><a href="cleaning.html#cb40-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">sum =</span> <span class="fu">sum</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb40-48"><a href="cleaning.html#cb40-48" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb40-49"><a href="cleaning.html#cb40-49" aria-hidden="true" tabindex="-1"></a>           <span class="at">select =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb40-50"><a href="cleaning.html#cb40-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb40-51"><a href="cleaning.html#cb40-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">min =</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> T))</span>
<span id="cb40-52"><a href="cleaning.html#cb40-52" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="covariates-1" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Covariates<a href="cleaning.html#covariates-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="cleaning.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># composite WITHIN years </span></span>
<span id="cb41-2"><a href="cleaning.html#cb41-2" aria-hidden="true" tabindex="-1"></a>map_cov <span class="ot">&lt;-</span> map_recode <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="cleaning.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;covariates&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="cleaning.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>category) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="cleaning.html#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb41-6"><a href="cleaning.html#cb41-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="cleaning.html#cb41-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">comp_rule =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(comp_rule), <span class="st">&quot;skip&quot;</span>, comp_rule)) <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="cleaning.html#cb41-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(comp_rule, SID, wave, long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="cleaning.html#cb41-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-10"><a href="cleaning.html#cb41-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-11"><a href="cleaning.html#cb41-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, comp_rule, <span class="sc">~</span><span class="fu">fun_call</span>((.x)<span class="sc">$</span>value, .y))) <span class="sc">%&gt;%</span></span>
<span id="cb41-12"><a href="cleaning.html#cb41-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb41-13"><a href="cleaning.html#cb41-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb41-14"><a href="cleaning.html#cb41-14" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb41-15"><a href="cleaning.html#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="cleaning.html#cb41-16" aria-hidden="true" tabindex="-1"></a>comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, rule){</span>
<span id="cb41-17"><a href="cleaning.html#cb41-17" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb41-18"><a href="cleaning.html#cb41-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb41-19"><a href="cleaning.html#cb41-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(data, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb41-20"><a href="cleaning.html#cb41-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-21"><a href="cleaning.html#cb41-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>()</span>
<span id="cb41-22"><a href="cleaning.html#cb41-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-23"><a href="cleaning.html#cb41-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-24"><a href="cleaning.html#cb41-24" aria-hidden="true" tabindex="-1"></a><span class="co"># composite ACROSS years</span></span>
<span id="cb41-25"><a href="cleaning.html#cb41-25" aria-hidden="true" tabindex="-1"></a>map_cov <span class="ot">&lt;-</span> map_cov <span class="sc">%&gt;%</span></span>
<span id="cb41-26"><a href="cleaning.html#cb41-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb41-27"><a href="cleaning.html#cb41-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">long_rule =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(long_rule), <span class="st">&quot;skip&quot;</span>, long_rule)) <span class="sc">%&gt;%</span></span>
<span id="cb41-28"><a href="cleaning.html#cb41-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb41-29"><a href="cleaning.html#cb41-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-30"><a href="cleaning.html#cb41-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-31"><a href="cleaning.html#cb41-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(data, long_rule), comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb41-32"><a href="cleaning.html#cb41-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb41-33"><a href="cleaning.html#cb41-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb41-34"><a href="cleaning.html#cb41-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb41-35"><a href="cleaning.html#cb41-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(name, value) <span class="sc">%&gt;%</span></span>
<span id="cb41-36"><a href="cleaning.html#cb41-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SID))</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="cleaning.html#cb42-1" aria-hidden="true" tabindex="-1"></a>map_cov</span></code></pre></div>
<pre><code>## # A tibble: 2,192 × 16
##    SID        age alcohol   BMI cancer diabetes education exercise gender heartProb married  mmse parkinsons  race smokes stroke
##    &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 00009121  80.0       1  26.8      0        0        12        1      0         0       1    29          0     0      1     NA
##  2 00033027  81.0       0  32.6      0        1        14        0      0         0       1    29          0     0      0      0
##  3 00045071  87.5       1  28.2      0        1        16        1      1         1       1    18          0     0      1      0
##  4 00130005  89.8       0  27.8      0        0        15        1      0         1       1    29          0     2      0      0
##  5 00204228  65.2       0  36.6      0        1         8        1      1         0       1    27          0     2      0      0
##  6 00228190  73.5       1  23.0      1        0        22        1      0         0       1    29          0     0      0      0
##  7 00246264  90.0       0  24.0      0        0        16        1      0         0       1    27          0     0      0      0
##  8 00285563  84.7       0  27.0      0        0        12        1      0         0       1    28          0     0      0      0
##  9 00402800  78.7       0  17.2      0        0        16        1      0         0       1    17          0     0      0      1
## 10 00482428  81.4       1  NA        1        0        12        1      0         0       1    30          0     0      0      1
## # … with 2,182 more rows</code></pre>
</div>
<div id="personality-variables-1" class="section level3 hasAnchor" number="2.2.4">
<h3><span class="header-section-number">2.2.4</span> Personality Variables<a href="cleaning.html#personality-variables-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="cleaning.html#cb44-1" aria-hidden="true" tabindex="-1"></a>map_pers <span class="ot">&lt;-</span> map_recode <span class="sc">%&gt;%</span></span>
<span id="cb44-2"><a href="cleaning.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;pers&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="cleaning.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>category) <span class="sc">%&gt;%</span> </span>
<span id="cb44-4"><a href="cleaning.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="cleaning.html#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="cleaning.html#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="cleaning.html#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="fu">min</span>(wave)) <span class="sc">%&gt;%</span></span>
<span id="cb44-8"><a href="cleaning.html#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-9"><a href="cleaning.html#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SID, name, wave, value)</span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="cleaning.html#cb45-1" aria-hidden="true" tabindex="-1"></a>map_pers</span></code></pre></div>
<pre><code>## # A tibble: 9,115 × 4
##    SID      name   wave value
##    &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 00009121 C         0    35
##  2 00045071 C         0    38
##  3 00130005 C         0    31
##  4 00246264 C         0    33
##  5 00402800 C         0    24
##  6 00582981 C         0    37
##  7 00617643 C         0    34
##  8 00696418 C         0    27
##  9 00701662 C         0    31
## 10 00709354 C         0    40
## # … with 9,105 more rows</code></pre>
</div>
<div id="outcome-variables-1" class="section level3 hasAnchor" number="2.2.5">
<h3><span class="header-section-number">2.2.5</span> Outcome Variables<a href="cleaning.html#outcome-variables-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="cleaning.html#cb47-1" aria-hidden="true" tabindex="-1"></a>map_out_waves <span class="ot">&lt;-</span> map_recode <span class="sc">%&gt;%</span></span>
<span id="cb47-2"><a href="cleaning.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;outcome&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="cleaning.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="cleaning.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="cleaning.html#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">o_year =</span> <span class="fu">max</span>(wave)) <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="cleaning.html#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb47-7"><a href="cleaning.html#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="cleaning.html#cb47-8" aria-hidden="true" tabindex="-1"></a>map_out <span class="ot">&lt;-</span> map_recode <span class="sc">%&gt;%</span></span>
<span id="cb47-9"><a href="cleaning.html#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;outcome&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-10"><a href="cleaning.html#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>category) <span class="sc">%&gt;%</span></span>
<span id="cb47-11"><a href="cleaning.html#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) </span>
<span id="cb47-12"><a href="cleaning.html#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="cleaning.html#cb47-13" aria-hidden="true" tabindex="-1"></a>map_dem <span class="ot">&lt;-</span> map_out <span class="sc">%&gt;%</span> </span>
<span id="cb47-14"><a href="cleaning.html#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-15"><a href="cleaning.html#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name, wave) <span class="sc">%&gt;%</span></span>
<span id="cb47-16"><a href="cleaning.html#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb47-17"><a href="cleaning.html#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-18"><a href="cleaning.html#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(value) <span class="sc">|</span> <span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value),</span>
<span id="cb47-19"><a href="cleaning.html#cb47-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">group =</span> <span class="fu">ifelse</span>(wave <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">&quot;future&quot;</span>, <span class="st">&quot;past&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-20"><a href="cleaning.html#cb47-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name, group) <span class="sc">%&gt;%</span></span>
<span id="cb47-21"><a href="cleaning.html#cb47-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb47-22"><a href="cleaning.html#cb47-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-23"><a href="cleaning.html#cb47-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb47-24"><a href="cleaning.html#cb47-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> group, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb47-25"><a href="cleaning.html#cb47-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb47-26"><a href="cleaning.html#cb47-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(past) <span class="sc">|</span> (past <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(future)), future,</span>
<span id="cb47-27"><a href="cleaning.html#cb47-27" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(past <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(future), past, </span>
<span id="cb47-28"><a href="cleaning.html#cb47-28" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(past <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb47-29"><a href="cleaning.html#cb47-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb47-30"><a href="cleaning.html#cb47-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-31"><a href="cleaning.html#cb47-31" aria-hidden="true" tabindex="-1"></a>comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, rule){</span>
<span id="cb47-32"><a href="cleaning.html#cb47-32" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb47-33"><a href="cleaning.html#cb47-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID) <span class="sc">%&gt;%</span></span>
<span id="cb47-34"><a href="cleaning.html#cb47-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb47-35"><a href="cleaning.html#cb47-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-36"><a href="cleaning.html#cb47-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value))</span>
<span id="cb47-37"><a href="cleaning.html#cb47-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-38"><a href="cleaning.html#cb47-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-39"><a href="cleaning.html#cb47-39" aria-hidden="true" tabindex="-1"></a><span class="co"># create composites</span></span>
<span id="cb47-40"><a href="cleaning.html#cb47-40" aria-hidden="true" tabindex="-1"></a>map_out <span class="ot">&lt;-</span> map_out <span class="sc">%&gt;%</span></span>
<span id="cb47-41"><a href="cleaning.html#cb47-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> name <span class="sc">!=</span> <span class="st">&quot;dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-42"><a href="cleaning.html#cb47-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb47-43"><a href="cleaning.html#cb47-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-44"><a href="cleaning.html#cb47-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-45"><a href="cleaning.html#cb47-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, long_rule, comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb47-46"><a href="cleaning.html#cb47-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb47-47"><a href="cleaning.html#cb47-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb47-48"><a href="cleaning.html#cb47-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(map_dem) <span class="sc">%&gt;%</span></span>
<span id="cb47-49"><a href="cleaning.html#cb47-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(map_out_waves)</span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="cleaning.html#cb48-1" aria-hidden="true" tabindex="-1"></a>map_out</span></code></pre></div>
<pre><code>## # A tibble: 11,128 × 6
##    name        SID      value future  past o_year
##    &lt;chr&gt;       &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1 ageDementia 00045071  88.5     NA    NA      1
##  2 ageDementia 00285563  90.5     NA    NA     13
##  3 ageDementia 00668310  88.6     NA    NA      5
##  4 ageDementia 01243685  89.7     NA    NA      3
##  5 ageDementia 01797756  86.4     NA    NA     11
##  6 ageDementia 02108769  90.9     NA    NA      8
##  7 ageDementia 03227207  97.8     NA    NA     17
##  8 ageDementia 03380931  85.7     NA    NA      7
##  9 ageDementia 03806878  92.4     NA    NA      5
## 10 ageDementia 04330337 101.      NA    NA     15
## # … with 11,118 more rows</code></pre>
</div>
<div id="cognition-variables-1" class="section level3 hasAnchor" number="2.2.6">
<h3><span class="header-section-number">2.2.6</span> Cognition Variables<a href="cleaning.html#cognition-variables-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="cleaning.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># composite within years</span></span>
<span id="cb50-2"><a href="cleaning.html#cb50-2" aria-hidden="true" tabindex="-1"></a>map_cog <span class="ot">&lt;-</span> map_recode <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="cleaning.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;cognition&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="cleaning.html#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>category) <span class="sc">%&gt;%</span></span>
<span id="cb50-5"><a href="cleaning.html#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb50-6"><a href="cleaning.html#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="cleaning.html#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb50-8"><a href="cleaning.html#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, itemname, wave) <span class="sc">%&gt;%</span></span>
<span id="cb50-9"><a href="cleaning.html#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">pomp</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb50-10"><a href="cleaning.html#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, SID) <span class="sc">%&gt;%</span></span>
<span id="cb50-11"><a href="cleaning.html#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb50-12"><a href="cleaning.html#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb50-13"><a href="cleaning.html#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span></span>
<span id="cb50-14"><a href="cleaning.html#cb50-14" aria-hidden="true" tabindex="-1"></a>              , <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="cleaning.html#cb51-1" aria-hidden="true" tabindex="-1"></a>map_cog</span></code></pre></div>
<pre><code>## # A tibble: 2,189 × 2
##    SID      cognition
##    &lt;chr&gt;        &lt;dbl&gt;
##  1 00009121      7.55
##  2 00033027      6.17
##  3 00045071      4.84
##  4 00130005      6.59
##  5 00204228      5.81
##  6 00228190      7.38
##  7 00246264      6.16
##  8 00285563      5.79
##  9 00402800      4.14
## 10 00482428      6.58
## # … with 2,179 more rows</code></pre>
</div>
<div id="combine-data-1" class="section level3 hasAnchor" number="2.2.7">
<h3><span class="header-section-number">2.2.7</span> Combine Data<a href="cleaning.html#combine-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="cleaning.html#cb53-1" aria-hidden="true" tabindex="-1"></a>map_combined <span class="ot">&lt;-</span> map_pers <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="cleaning.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Trait =</span> name, <span class="at">p_value =</span> value, <span class="at">p_year =</span> wave) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="cleaning.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(</span>
<span id="cb53-4"><a href="cleaning.html#cb53-4" aria-hidden="true" tabindex="-1"></a>    map_out <span class="sc">%&gt;%</span> </span>
<span id="cb53-5"><a href="cleaning.html#cb53-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="at">Outcome =</span> name, SID, <span class="at">o_value =</span> value, o_year)</span>
<span id="cb53-6"><a href="cleaning.html#cb53-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb53-7"><a href="cleaning.html#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(map_cov) <span class="sc">%&gt;%</span></span>
<span id="cb53-8"><a href="cleaning.html#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb53-9"><a href="cleaning.html#cb53-9" aria-hidden="true" tabindex="-1"></a>    map_out <span class="sc">%&gt;%</span></span>
<span id="cb53-10"><a href="cleaning.html#cb53-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-11"><a href="cleaning.html#cb53-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">rowSums</span>(<span class="fu">cbind</span>(future, past), <span class="at">na.rm =</span> T) <span class="sc">&gt;=</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-12"><a href="cleaning.html#cb53-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>future, <span class="sc">-</span>past) <span class="sc">%&gt;%</span></span>
<span id="cb53-13"><a href="cleaning.html#cb53-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb53-14"><a href="cleaning.html#cb53-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb53-15"><a href="cleaning.html#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(map_cog) <span class="sc">%&gt;%</span></span>
<span id="cb53-16"><a href="cleaning.html#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_value) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(o_value))</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="cleaning.html#cb54-1" aria-hidden="true" tabindex="-1"></a>map_combined</span></code></pre></div>
<pre><code>## # A tibble: 42,999 × 24
##    SID      Trait p_year p_value Outcome  o_value o_year   age alcohol   BMI cancer diabe…¹ educa…² exerc…³ gender heart…⁴ married  mmse parki…⁵
##    &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 00009121 C          0      35 dementia     0       10  80.0       1  26.8      0       0      12       1      0       0       1    29       0
##  2 00045071 C          0      38 ageDeme…    88.5      1  87.5       1  28.2      0       1      16       1      1       1       1    18       0
##  3 00045071 C          0      38 dementia     1        1  87.5       1  28.2      0       1      16       1      1       1       1    18       0
##  4 00130005 C          0      31 dementia     0        4  89.8       0  27.8      0       0      15       1      0       1       1    29       0
##  5 00246264 C          0      33 angiopa…     2        8  90.0       0  24.0      0       0      16       1      0       0       1    27       0
##  6 00246264 C          0      33 arterio…     2        8  90.0       0  24.0      0       0      16       1      0       0       1    27       0
##  7 00246264 C          0      33 atheros…     1        8  90.0       0  24.0      0       0      16       1      0       0       1    27       0
##  8 00246264 C          0      33 braak        3        8  90.0       0  24.0      0       0      16       1      0       0       1    27       0
##  9 00246264 C          0      33 cerad        2        8  90.0       0  24.0      0       0      16       1      0       0       1    27       0
## 10 00246264 C          0      33 hipScle…     0        8  90.0       0  24.0      0       0      16       1      0       0       1    27       0
## # … with 42,989 more rows, 5 more variables: race &lt;dbl&gt;, smokes &lt;dbl&gt;, stroke &lt;dbl&gt;, dementia &lt;dbl&gt;, cognition &lt;dbl&gt;, and abbreviated variable
## #   names ¹​diabetes, ²​education, ³​exercise, ⁴​heartProb, ⁵​parkinsons</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="cleaning.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(map_cov, map_pers, map_out, map_combined, map_cog,</span>
<span id="cb56-2"><a href="cleaning.html#cb56-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/radc-map_cleaned.RData&quot;</span>, load_path))</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="cleaning.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span><span class="fu">ls</span>()[<span class="fu">grepl</span>(<span class="st">&quot;map&quot;</span>, <span class="fu">ls</span>())])</span></code></pre></div>
</div>
</div>
<div id="rush-religious-orders-study-ros" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> RUSH Religious Orders Study (ROS)<a href="cleaning.html#rush-religious-orders-study-ros" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The RUSH Religious Orders Study (ROS) is an ongoing longitudinal study that began in 1994 <span class="citation">(<a href="#ref-a2012overview" role="doc-biblioref"><strong>a2012overview?</strong></a>)</span>. These data are available, through application from <a href="https://www.radc.rush.edu/requests.htm" class="uri">https://www.radc.rush.edu/requests.htm</a>.</p>
<p>Older (65 and above) Catholic nuns, priests, and brothers with no prior dementia diagnosis and who agreed to annual evaluations and eventual organ donation were recruited from more than 40 groups across the United States. Additional participants are recuited each year. Additional information and documentation on the data can be found at <a href="https://www.radc.rush.edu/docs/var/variables.htm" class="uri">https://www.radc.rush.edu/docs/var/variables.htm</a>.</p>
<p>Sample sizes vary bt year from 353 participants (1994) to 1487 participants, including 797 deceased participants with autopsy data (2019, 2020). This provides 99% power to detect a zero-order correlation effect size of ~.11, two-tailed at alpha .05.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="cleaning.html#cb58-1" aria-hidden="true" tabindex="-1"></a>(ros_codebook <span class="ot">&lt;-</span> (codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(study <span class="sc">==</span> <span class="st">&quot;ROS&quot;</span>))<span class="sc">$</span>codebook[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="cleaning.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">orig_itemname =</span> <span class="fu">str_to_lower</span>(orig_itemname)))</span></code></pre></div>
<pre><code>## # A tibble: 42 × 15
##    study dataset category   name      itemname    year         orig_itemname description        scale rever…¹ recode  mini  maxi comp_…² long_…³
##    &lt;chr&gt; &lt;lgl&gt;   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;              &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
##  1 ROS   NA      cognition  cognition freeRecall  longitudinal cts_wlii      word list recall    &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  2 ROS   NA      cognition  cognition cuedRecall  longitudinal cts_wliii     word list recogni…  &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  3 ROS   NA      cognition  cognition digitsFrwd  longitudinal cts_df        digits backward     &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  4 ROS   NA      cognition  cognition digitsBckwd longitudinal cts_db        digits forward      &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  5 ROS   NA      cognition  cognition catFluency  longitudinal cts_catflu    category fluency …  &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  6 ROS   NA      cognition  cognition bosNaming   longitudinal cts_bname     Boston naming (15…  &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  7 ROS   NA      cognition  cognition progMat     longitudinal cts_pmat      progressive matri…  &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  8 ROS   NA      cognition  cognition digitSymbol longitudinal cts_sdmt      symbol digits mod…  &lt;NA&gt; no      ifels…    NA    NA sum     select 
##  9 ROS   NA      covariates age       ageBaseline baseline     age_bl        The age at baseli…  &lt;NA&gt; no      ifels…    NA    NA skip    select 
## 10 ROS   NA      covariates alcohol   alcohol     baseline     alcohol_g_bl  Grams of alcohol … &quot;\r\… no      ifels…    NA    NA skip    average
## # … with 32 more rows, and abbreviated variable names ¹​reverse_code, ²​comp_rule, ³​long_rule</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="cleaning.html#cb60-1" aria-hidden="true" tabindex="-1"></a>ros <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/rush-radc/dataset_1033_long_03-24-2021.xlsx&quot;</span>, data_path) <span class="sc">%&gt;%</span> <span class="fu">read_excel</span>() <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="cleaning.html#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/rush-radc/dataset_1033_basic_03-24-2021.xlsx&quot;</span>, data_path) <span class="sc">%&gt;%</span> <span class="fu">read_excel</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="cleaning.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/rush-radc/dataset_1034_long_03-25-2021.xlsx&quot;</span>, data_path) <span class="sc">%&gt;%</span> <span class="fu">read_excel</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="cleaning.html#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/rush-radc/dataset_1034_basic_03-25-2021.xlsx&quot;</span>, data_path) <span class="sc">%&gt;%</span> <span class="fu">read_excel</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb60-5"><a href="cleaning.html#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(study <span class="sc">==</span> <span class="st">&quot;ROS&quot;</span>)</span></code></pre></div>
<div id="recoding-reverse-scoring-2" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Recoding &amp; Reverse Scoring<a href="cleaning.html#recoding-reverse-scoring-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="cleaning.html#cb61-1" aria-hidden="true" tabindex="-1"></a>rename_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(cb, var){</span>
<span id="cb61-2"><a href="cleaning.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(var)</span>
<span id="cb61-3"><a href="cleaning.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  old.names <span class="ot">&lt;-</span> <span class="fu">unique</span>((ros_codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> var))<span class="sc">$</span>orig_itemname)</span>
<span id="cb61-4"><a href="cleaning.html#cb61-4" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> ros <span class="sc">%&gt;%</span> </span>
<span id="cb61-5"><a href="cleaning.html#cb61-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">SID =</span> projid, <span class="at">wave =</span> fu_year, <span class="fu">one_of</span>(old.names)) <span class="sc">%&gt;%</span></span>
<span id="cb61-6"><a href="cleaning.html#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> orig_itemname, <span class="at">value =</span> value, <span class="sc">-</span>SID, <span class="sc">-</span>wave, <span class="at">na.rm =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb61-7"><a href="cleaning.html#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(cb <span class="sc">%&gt;%</span> <span class="fu">select</span>(itemname, orig_itemname, reverse_code<span class="sc">:</span>long_rule))</span>
<span id="cb61-8"><a href="cleaning.html#cb61-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-9"><a href="cleaning.html#cb61-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-10"><a href="cleaning.html#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co"># join data with recoding info </span></span>
<span id="cb61-11"><a href="cleaning.html#cb61-11" aria-hidden="true" tabindex="-1"></a>ros_recode <span class="ot">&lt;-</span> ros_codebook <span class="sc">%&gt;%</span></span>
<span id="cb61-12"><a href="cleaning.html#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(category, name, itemname, year, orig_itemname, reverse_code<span class="sc">:</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb61-13"><a href="cleaning.html#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;pers&quot;</span>, <span class="st">&quot;outcome&quot;</span>, <span class="st">&quot;covariates&quot;</span>, <span class="st">&quot;cognition&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb61-14"><a href="cleaning.html#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category, name) <span class="sc">%&gt;%</span></span>
<span id="cb61-15"><a href="cleaning.html#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb61-16"><a href="cleaning.html#cb61-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-17"><a href="cleaning.html#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, name, rename_fun))</span>
<span id="cb61-18"><a href="cleaning.html#cb61-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-19"><a href="cleaning.html#cb61-19" aria-hidden="true" tabindex="-1"></a><span class="co"># recode </span></span>
<span id="cb61-20"><a href="cleaning.html#cb61-20" aria-hidden="true" tabindex="-1"></a>recode_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(rule, y, year){</span>
<span id="cb61-21"><a href="cleaning.html#cb61-21" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y<span class="sc">$</span>value</span>
<span id="cb61-22"><a href="cleaning.html#cb61-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(rule)){y<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> rule))}</span>
<span id="cb61-23"><a href="cleaning.html#cb61-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb61-24"><a href="cleaning.html#cb61-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-25"><a href="cleaning.html#cb61-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-26"><a href="cleaning.html#cb61-26" aria-hidden="true" tabindex="-1"></a>ros_recode <span class="ot">&lt;-</span> ros_recode <span class="sc">%&gt;%</span> </span>
<span id="cb61-27"><a href="cleaning.html#cb61-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb61-28"><a href="cleaning.html#cb61-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">wave =</span> <span class="fu">as.numeric</span>(wave)) <span class="sc">%&gt;%</span></span>
<span id="cb61-29"><a href="cleaning.html#cb61-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(recode, wave) <span class="sc">%&gt;%</span></span>
<span id="cb61-30"><a href="cleaning.html#cb61-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-31"><a href="cleaning.html#cb61-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-32"><a href="cleaning.html#cb61-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(recode, data, wave), recode_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb61-33"><a href="cleaning.html#cb61-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb61-34"><a href="cleaning.html#cb61-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(value <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.nan</span>(value) <span class="sc">|</span> <span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value))))</span>
<span id="cb61-35"><a href="cleaning.html#cb61-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-36"><a href="cleaning.html#cb61-36" aria-hidden="true" tabindex="-1"></a><span class="co"># reverse code </span></span>
<span id="cb61-37"><a href="cleaning.html#cb61-37" aria-hidden="true" tabindex="-1"></a>ros_recode <span class="ot">&lt;-</span> ros_recode <span class="sc">%&gt;%</span></span>
<span id="cb61-38"><a href="cleaning.html#cb61-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb61-39"><a href="cleaning.html#cb61-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">as.numeric</span>(value), </span>
<span id="cb61-40"><a href="cleaning.html#cb61-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">ifelse</span>(reverse_code <span class="sc">==</span> <span class="st">&quot;no&quot;</span> <span class="sc">|</span> <span class="fu">is.na</span>(reverse_code), value, </span>
<span id="cb61-41"><a href="cleaning.html#cb61-41" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">reverse.code</span>(<span class="sc">-</span><span class="dv">1</span>, value, <span class="at">mini =</span> mini, <span class="at">maxi =</span> maxi)))))</span>
<span id="cb61-42"><a href="cleaning.html#cb61-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-43"><a href="cleaning.html#cb61-43" aria-hidden="true" tabindex="-1"></a>fun_call <span class="ot">&lt;-</span> <span class="cf">function</span>(x, rule){</span>
<span id="cb61-44"><a href="cleaning.html#cb61-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span>(rule,</span>
<span id="cb61-45"><a href="cleaning.html#cb61-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">average =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb61-46"><a href="cleaning.html#cb61-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">mode =</span> <span class="fu">Mode</span>(x)[<span class="dv">1</span>],</span>
<span id="cb61-47"><a href="cleaning.html#cb61-47" aria-hidden="true" tabindex="-1"></a>           <span class="at">sum =</span> <span class="fu">sum</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb61-48"><a href="cleaning.html#cb61-48" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb61-49"><a href="cleaning.html#cb61-49" aria-hidden="true" tabindex="-1"></a>           <span class="at">select =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb61-50"><a href="cleaning.html#cb61-50" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb61-51"><a href="cleaning.html#cb61-51" aria-hidden="true" tabindex="-1"></a>           <span class="at">min =</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> T))</span>
<span id="cb61-52"><a href="cleaning.html#cb61-52" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="covariates-2" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Covariates<a href="cleaning.html#covariates-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="cleaning.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># composite WITHIN years </span></span>
<span id="cb62-2"><a href="cleaning.html#cb62-2" aria-hidden="true" tabindex="-1"></a>ros_cov <span class="ot">&lt;-</span> ros_recode <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="cleaning.html#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;covariates&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="cleaning.html#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>category) <span class="sc">%&gt;%</span></span>
<span id="cb62-5"><a href="cleaning.html#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb62-6"><a href="cleaning.html#cb62-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb62-7"><a href="cleaning.html#cb62-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">comp_rule =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(comp_rule), <span class="st">&quot;skip&quot;</span>, comp_rule)) <span class="sc">%&gt;%</span></span>
<span id="cb62-8"><a href="cleaning.html#cb62-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(comp_rule, SID, wave, long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb62-9"><a href="cleaning.html#cb62-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-10"><a href="cleaning.html#cb62-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-11"><a href="cleaning.html#cb62-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, comp_rule, <span class="sc">~</span><span class="fu">fun_call</span>((.x)<span class="sc">$</span>value, .y))) <span class="sc">%&gt;%</span></span>
<span id="cb62-12"><a href="cleaning.html#cb62-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb62-13"><a href="cleaning.html#cb62-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb62-14"><a href="cleaning.html#cb62-14" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb62-15"><a href="cleaning.html#cb62-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-16"><a href="cleaning.html#cb62-16" aria-hidden="true" tabindex="-1"></a>comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, rule){</span>
<span id="cb62-17"><a href="cleaning.html#cb62-17" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb62-18"><a href="cleaning.html#cb62-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb62-19"><a href="cleaning.html#cb62-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(data, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb62-20"><a href="cleaning.html#cb62-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-21"><a href="cleaning.html#cb62-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>()</span>
<span id="cb62-22"><a href="cleaning.html#cb62-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-23"><a href="cleaning.html#cb62-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-24"><a href="cleaning.html#cb62-24" aria-hidden="true" tabindex="-1"></a><span class="co"># composite ACROSS years</span></span>
<span id="cb62-25"><a href="cleaning.html#cb62-25" aria-hidden="true" tabindex="-1"></a>ros_cov <span class="ot">&lt;-</span> ros_cov <span class="sc">%&gt;%</span></span>
<span id="cb62-26"><a href="cleaning.html#cb62-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb62-27"><a href="cleaning.html#cb62-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">long_rule =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(long_rule), <span class="st">&quot;skip&quot;</span>, long_rule)) <span class="sc">%&gt;%</span></span>
<span id="cb62-28"><a href="cleaning.html#cb62-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb62-29"><a href="cleaning.html#cb62-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-30"><a href="cleaning.html#cb62-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-31"><a href="cleaning.html#cb62-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(data, long_rule), comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb62-32"><a href="cleaning.html#cb62-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb62-33"><a href="cleaning.html#cb62-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb62-34"><a href="cleaning.html#cb62-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb62-35"><a href="cleaning.html#cb62-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(name, value) <span class="sc">%&gt;%</span></span>
<span id="cb62-36"><a href="cleaning.html#cb62-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SID))</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="cleaning.html#cb63-1" aria-hidden="true" tabindex="-1"></a>ros_cov</span></code></pre></div>
<pre><code>## # A tibble: 1,485 × 14
##    SID        age alcohol   BMI cancer diabetes education exercise gender heartProb  mmse  race smokes stroke
##    &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 00021073  80.0       0  19.9      0        0        22        1      0         1    18     0      0      0
##  2 00337708  82.2       0  42.8      0        0        22        1      1         0    27     0      0      0
##  3 00381112  70.3       0  29.7      0        0        20        0      0         0    30     0      0     NA
##  4 00470212  72.6       1  20.0      1        0        18        1      0         0    30     0      0      0
##  5 00756793  87.3       0  33.2      0        1        20        0      1         0    23     1      1      0
##  6 00985084  78.6       0  23.7      1        0        21        1      0         0    28     0      0      0
##  7 01211411  85.2       0  25.1      0        0        12        0      1         0    24     0      1      0
##  8 01237015  72.0       0  18.8      0        0        16        1      0         0    29     0      0      0
##  9 01679543  65.2       1  36.4      0        0        22        1      0         0    30     0      0      0
## 10 02105734  85.2       1  21.5      0        0        18        1      0         0    29     0      0      0
## # … with 1,475 more rows</code></pre>
</div>
<div id="personality-variables-2" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Personality Variables<a href="cleaning.html#personality-variables-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="cleaning.html#cb65-1" aria-hidden="true" tabindex="-1"></a>ros_pers <span class="ot">&lt;-</span> ros_recode <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="cleaning.html#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;pers&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="cleaning.html#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>category) <span class="sc">%&gt;%</span> </span>
<span id="cb65-4"><a href="cleaning.html#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span> </span>
<span id="cb65-5"><a href="cleaning.html#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-6"><a href="cleaning.html#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb65-7"><a href="cleaning.html#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="fu">min</span>(wave)) <span class="sc">%&gt;%</span></span>
<span id="cb65-8"><a href="cleaning.html#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-9"><a href="cleaning.html#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SID, name, wave, value)</span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="cleaning.html#cb66-1" aria-hidden="true" tabindex="-1"></a>ros_pers</span></code></pre></div>
<pre><code>## # A tibble: 7,569 × 4
##    SID      name   wave value
##    &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 00021073 A         0    32
##  2 00337708 A         0    30
##  3 00381112 A         0    36
##  4 00470212 A         0    41
##  5 00756793 A         0    27
##  6 00985084 A         0    33
##  7 01211411 A         0    27
##  8 01237015 A         0    34
##  9 01679543 A         0    43
## 10 02105734 A         0    36
## # … with 7,559 more rows</code></pre>
</div>
<div id="outcome-variables-2" class="section level3 hasAnchor" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> Outcome Variables<a href="cleaning.html#outcome-variables-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="cleaning.html#cb68-1" aria-hidden="true" tabindex="-1"></a>ros_out_waves <span class="ot">&lt;-</span> ros_recode <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="cleaning.html#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;outcome&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="cleaning.html#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb68-4"><a href="cleaning.html#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb68-5"><a href="cleaning.html#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">o_year =</span> <span class="fu">max</span>(wave)) <span class="sc">%&gt;%</span></span>
<span id="cb68-6"><a href="cleaning.html#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb68-7"><a href="cleaning.html#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="cleaning.html#cb68-8" aria-hidden="true" tabindex="-1"></a>ros_out <span class="ot">&lt;-</span> ros_recode <span class="sc">%&gt;%</span></span>
<span id="cb68-9"><a href="cleaning.html#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;outcome&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-10"><a href="cleaning.html#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>category) <span class="sc">%&gt;%</span></span>
<span id="cb68-11"><a href="cleaning.html#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) </span>
<span id="cb68-12"><a href="cleaning.html#cb68-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-13"><a href="cleaning.html#cb68-13" aria-hidden="true" tabindex="-1"></a>ros_dem <span class="ot">&lt;-</span> ros_out <span class="sc">%&gt;%</span> </span>
<span id="cb68-14"><a href="cleaning.html#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-15"><a href="cleaning.html#cb68-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name, wave) <span class="sc">%&gt;%</span></span>
<span id="cb68-16"><a href="cleaning.html#cb68-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb68-17"><a href="cleaning.html#cb68-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-18"><a href="cleaning.html#cb68-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(value) <span class="sc">|</span> <span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value),</span>
<span id="cb68-19"><a href="cleaning.html#cb68-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">group =</span> <span class="fu">ifelse</span>(wave <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">&quot;future&quot;</span>, <span class="st">&quot;past&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-20"><a href="cleaning.html#cb68-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name, group) <span class="sc">%&gt;%</span></span>
<span id="cb68-21"><a href="cleaning.html#cb68-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb68-22"><a href="cleaning.html#cb68-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-23"><a href="cleaning.html#cb68-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb68-24"><a href="cleaning.html#cb68-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> group, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb68-25"><a href="cleaning.html#cb68-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb68-26"><a href="cleaning.html#cb68-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(past) <span class="sc">|</span> (past <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(future)), future,</span>
<span id="cb68-27"><a href="cleaning.html#cb68-27" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(past <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(future), past, </span>
<span id="cb68-28"><a href="cleaning.html#cb68-28" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(past <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb68-29"><a href="cleaning.html#cb68-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb68-30"><a href="cleaning.html#cb68-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-31"><a href="cleaning.html#cb68-31" aria-hidden="true" tabindex="-1"></a>comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, rule){</span>
<span id="cb68-32"><a href="cleaning.html#cb68-32" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb68-33"><a href="cleaning.html#cb68-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID) <span class="sc">%&gt;%</span></span>
<span id="cb68-34"><a href="cleaning.html#cb68-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb68-35"><a href="cleaning.html#cb68-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-36"><a href="cleaning.html#cb68-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value))</span>
<span id="cb68-37"><a href="cleaning.html#cb68-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-38"><a href="cleaning.html#cb68-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-39"><a href="cleaning.html#cb68-39" aria-hidden="true" tabindex="-1"></a><span class="co"># create composites</span></span>
<span id="cb68-40"><a href="cleaning.html#cb68-40" aria-hidden="true" tabindex="-1"></a>ros_out <span class="ot">&lt;-</span> ros_out <span class="sc">%&gt;%</span></span>
<span id="cb68-41"><a href="cleaning.html#cb68-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> name <span class="sc">!=</span> <span class="st">&quot;dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-42"><a href="cleaning.html#cb68-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb68-43"><a href="cleaning.html#cb68-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-44"><a href="cleaning.html#cb68-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-45"><a href="cleaning.html#cb68-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, long_rule, comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb68-46"><a href="cleaning.html#cb68-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb68-47"><a href="cleaning.html#cb68-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb68-48"><a href="cleaning.html#cb68-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(ros_dem) <span class="sc">%&gt;%</span></span>
<span id="cb68-49"><a href="cleaning.html#cb68-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ros_out_waves)</span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="cleaning.html#cb69-1" aria-hidden="true" tabindex="-1"></a>ros_out</span></code></pre></div>
<pre><code>## # A tibble: 9,581 × 6
##    name        SID      value future  past o_year
##    &lt;chr&gt;       &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1 ageDementia 02495739  92.5     NA    NA     13
##  2 ageDementia 07299965  80.0     NA    NA     13
##  3 ageDementia 07660182  83.7     NA    NA      4
##  4 ageDementia 10100150  84.5     NA    NA     12
##  5 ageDementia 10100286  80.7     NA    NA     18
##  6 ageDementia 10101039  90.4     NA    NA      8
##  7 ageDementia 10101589 107.      NA    NA      6
##  8 ageDementia 10101741  92.4     NA    NA     12
##  9 ageDementia 10116694  82.2     NA    NA      5
## 10 ageDementia 10200901  96.2     NA    NA     23
## # … with 9,571 more rows</code></pre>
</div>
<div id="cognition-variables-2" class="section level3 hasAnchor" number="2.3.5">
<h3><span class="header-section-number">2.3.5</span> Cognition Variables<a href="cleaning.html#cognition-variables-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="cleaning.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># composite within years</span></span>
<span id="cb71-2"><a href="cleaning.html#cb71-2" aria-hidden="true" tabindex="-1"></a>ros_cog <span class="ot">&lt;-</span> ros_recode <span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="cleaning.html#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;cognition&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-4"><a href="cleaning.html#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>category) <span class="sc">%&gt;%</span></span>
<span id="cb71-5"><a href="cleaning.html#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb71-6"><a href="cleaning.html#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-7"><a href="cleaning.html#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb71-8"><a href="cleaning.html#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, itemname, wave) <span class="sc">%&gt;%</span></span>
<span id="cb71-9"><a href="cleaning.html#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">pomp</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb71-10"><a href="cleaning.html#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, SID) <span class="sc">%&gt;%</span></span>
<span id="cb71-11"><a href="cleaning.html#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb71-12"><a href="cleaning.html#cb71-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb71-13"><a href="cleaning.html#cb71-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span></span>
<span id="cb71-14"><a href="cleaning.html#cb71-14" aria-hidden="true" tabindex="-1"></a>              , <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="cleaning.html#cb72-1" aria-hidden="true" tabindex="-1"></a>ros_cog</span></code></pre></div>
<pre><code>## # A tibble: 1,485 × 2
##    SID      cognition
##    &lt;chr&gt;        &lt;dbl&gt;
##  1 00021073      4.19
##  2 00337708      5.89
##  3 00381112      7.02
##  4 00470212      6.68
##  5 00756793      4.35
##  6 00985084      6.83
##  7 01211411      3.83
##  8 01237015      5.64
##  9 01679543      7.23
## 10 02105734      6.64
## # … with 1,475 more rows</code></pre>
</div>
<div id="combine-data-2" class="section level3 hasAnchor" number="2.3.6">
<h3><span class="header-section-number">2.3.6</span> Combine Data<a href="cleaning.html#combine-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="cleaning.html#cb74-1" aria-hidden="true" tabindex="-1"></a>ros_combined <span class="ot">&lt;-</span> ros_pers <span class="sc">%&gt;%</span> </span>
<span id="cb74-2"><a href="cleaning.html#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Trait =</span> name, <span class="at">p_value =</span> value, <span class="at">p_year =</span> wave) <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="cleaning.html#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(</span>
<span id="cb74-4"><a href="cleaning.html#cb74-4" aria-hidden="true" tabindex="-1"></a>    ros_out <span class="sc">%&gt;%</span> </span>
<span id="cb74-5"><a href="cleaning.html#cb74-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="at">Outcome =</span> name, SID, <span class="at">o_value =</span> value, o_year)</span>
<span id="cb74-6"><a href="cleaning.html#cb74-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb74-7"><a href="cleaning.html#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(ros_cov) <span class="sc">%&gt;%</span></span>
<span id="cb74-8"><a href="cleaning.html#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb74-9"><a href="cleaning.html#cb74-9" aria-hidden="true" tabindex="-1"></a>    ros_out <span class="sc">%&gt;%</span></span>
<span id="cb74-10"><a href="cleaning.html#cb74-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-11"><a href="cleaning.html#cb74-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">rowSums</span>(<span class="fu">cbind</span>(future, past), <span class="at">na.rm =</span> T) <span class="sc">&gt;=</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb74-12"><a href="cleaning.html#cb74-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>future, <span class="sc">-</span>past) <span class="sc">%&gt;%</span></span>
<span id="cb74-13"><a href="cleaning.html#cb74-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb74-14"><a href="cleaning.html#cb74-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb74-15"><a href="cleaning.html#cb74-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(ros_cog) <span class="sc">%&gt;%</span></span>
<span id="cb74-16"><a href="cleaning.html#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_value) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(o_value))</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="cleaning.html#cb75-1" aria-hidden="true" tabindex="-1"></a>ros_combined</span></code></pre></div>
<pre><code>## # A tibble: 48,074 × 22
##    SID   Trait p_year p_value Outcome o_value o_year   age alcohol   BMI cancer diabe…¹ educa…² exerc…³ gender heart…⁴  mmse  race smokes stroke
##    &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 0002… A          0      32 angiop…       3      2  80.0       0  19.9      0       0      22       1      0       1    18     0      0      0
##  2 0002… A          0      32 arteri…       0      2  80.0       0  19.9      0       0      22       1      0       1    18     0      0      0
##  3 0002… A          0      32 athero…       2      2  80.0       0  19.9      0       0      22       1      0       1    18     0      0      0
##  4 0002… A          0      32 braak         6      2  80.0       0  19.9      0       0      22       1      0       1    18     0      0      0
##  5 0002… A          0      32 cerad         1      2  80.0       0  19.9      0       0      22       1      0       1    18     0      0      0
##  6 0002… A          0      32 hipScl…       0      2  80.0       0  19.9      0       0      22       1      0       1    18     0      0      0
##  7 0002… A          0      32 lewyBo…       0      2  80.0       0  19.9      0       0      22       1      0       1    18     0      0      0
##  8 0002… A          0      32 vsclrI…       0      2  80.0       0  19.9      0       0      22       1      0       1    18     0      0      0
##  9 0002… A          0      32 vsclrM…       1      2  80.0       0  19.9      0       0      22       1      0       1    18     0      0      0
## 10 0002… A          0      32 tdp43         1      2  80.0       0  19.9      0       0      22       1      0       1    18     0      0      0
## # … with 48,064 more rows, 2 more variables: dementia &lt;dbl&gt;, cognition &lt;dbl&gt;, and abbreviated variable names ¹​diabetes, ²​education, ³​exercise,
## #   ⁴​heartProb</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="cleaning.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(ros_cov, ros_pers, ros_out, ros_combined, ros_cog,</span>
<span id="cb77-2"><a href="cleaning.html#cb77-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/ros_cleaned.RData&quot;</span>, load_path))</span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="cleaning.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span><span class="fu">ls</span>()[<span class="fu">grepl</span>(<span class="st">&quot;ros&quot;</span>, <span class="fu">ls</span>())])</span></code></pre></div>
</div>
</div>
<div id="swedish-adoption-twin-study-of-aging-satsa" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Swedish Adoption Twin Study of Aging (SATSA)<a href="cleaning.html#swedish-adoption-twin-study-of-aging-satsa" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Swedish Adoption Twin Study of Aging (SATSA) is a longitudinal study of twin pairs from the Swedish Twin Registry that began in 1984. Data are available through the ICPSR database at <a href="https://www.icpsr.umich.edu/web/ICPSR/studies/3843" class="uri">https://www.icpsr.umich.edu/web/ICPSR/studies/3843</a>.</p>
<p>All twin-pairs on the Swedish Twin Registry who were separated at an early age were invited to be a part of the study in 1984. A control sample of twins reared together were also included. Additional waves of all participants were collected in 1987, 1990, 1993, 2004, 2007, 2010, 2012, and 2014. More information, including codebooks, scales, and variable search functions can be found at <a href="https://www.maelstrom-research.org/mica/individual-study/satsa/#" class="uri">https://www.maelstrom-research.org/mica/individual-study/satsa/#</a>.</p>
<p>Sample sizes vary by wave, ranging from 2018 participants at baseline (1984) to 379 participants (IPT7). Given that the target measures were collected at baseline, this provides 99% power to detect a zero-order correlation effect size of ~.10, two-tailed at alpha .05.</p>
<div id="load-data-2" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Load Data<a href="cleaning.html#load-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="cleaning.html#cb79-1" aria-hidden="true" tabindex="-1"></a>satsa_read_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb79-2"><a href="cleaning.html#cb79-2" aria-hidden="true" tabindex="-1"></a>  prob_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FHEART&quot;</span>, <span class="st">&quot;FPARKIN&quot;</span>, <span class="st">&quot;FSTROKE&quot;</span>)</span>
<span id="cb79-3"><a href="cleaning.html#cb79-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/satsa/%s&quot;</span>, data_path, x) <span class="sc">%&gt;%</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb79-4"><a href="cleaning.html#cb79-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">SID =</span> TWINNR, <span class="fu">one_of</span>(old.names)) <span class="sc">%&gt;%</span></span>
<span id="cb79-5"><a href="cleaning.html#cb79-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb79-6"><a href="cleaning.html#cb79-6" aria-hidden="true" tabindex="-1"></a>    haven<span class="sc">::</span><span class="fu">zap_labels</span>(.)</span>
<span id="cb79-7"><a href="cleaning.html#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">any</span>(prob_vars <span class="sc">%in%</span> <span class="fu">colnames</span>(y))){</span>
<span id="cb79-8"><a href="cleaning.html#cb79-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> y <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="fu">one_of</span>(prob_vars)), <span class="sc">~</span><span class="fu">as.numeric</span>(<span class="fu">as.character</span>(.)))</span>
<span id="cb79-9"><a href="cleaning.html#cb79-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb79-10"><a href="cleaning.html#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb79-11"><a href="cleaning.html#cb79-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="cleaning.html#cb80-1" aria-hidden="true" tabindex="-1"></a>satsa_codebook <span class="ot">&lt;-</span> (codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(study <span class="sc">==</span> <span class="st">&quot;SATSA&quot;</span>))<span class="sc">$</span>codebook[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="cleaning.html#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(orig_itemname), str_to_upper)</span>
<span id="cb80-3"><a href="cleaning.html#cb80-3" aria-hidden="true" tabindex="-1"></a>satsa_codebook</span></code></pre></div>
<pre><code>## # A tibble: 840 × 17
##    study dataset    category  name      itemname    wave_letter  year item_stem orig_…¹ descr…² scale rever…³ recode  mini  maxi comp_…⁴ long_…⁵
##    &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
##  1 satsa SATSA_IPT1 cognition cognition blockDesign &lt;NA&gt;         1985 &lt;NA&gt;      IBLOC_… Block … inte… no      ifels…    NA    NA sum     select 
##  2 satsa SATSA_IPT2 cognition cognition blockDesign &lt;NA&gt;         1989 &lt;NA&gt;      IBLOC_… Block … inte… no      ifels…    NA    NA sum     select 
##  3 satsa SATSA_IPT3 cognition cognition blockDesign &lt;NA&gt;         1992 &lt;NA&gt;      IBLOC_… Block … inte… no      ifels…    NA    NA sum     select 
##  4 satsa SATSA_IPT4 cognition cognition blockDesign &lt;NA&gt;         1995 &lt;NA&gt;      IBLOC_… Block … inte… no      ifels…    NA    NA sum     select 
##  5 satsa SATSA_IPT5 cognition cognition blockDesign &lt;NA&gt;         1999 &lt;NA&gt;      IBLOC_… Block … inte… no      ifels…    NA    NA sum     select 
##  6 satsa SATSA_IPT6 cognition cognition blockDesign &lt;NA&gt;         2002 &lt;NA&gt;      IBLOC_… Block … inte… no      ifels…    NA    NA sum     select 
##  7 satsa SATSA_IPT7 cognition cognition blockDesign &lt;NA&gt;         2005 &lt;NA&gt;      IBLOC_… Block … inte… no      ifels…    NA    NA sum     select 
##  8 satsa SATSA_IPT1 cognition cognition digitSpan   &lt;NA&gt;         1985 &lt;NA&gt;      IDGSP_… Digit … inte… no      ifels…    NA    NA sum     select 
##  9 satsa SATSA_IPT2 cognition cognition digitSpan   &lt;NA&gt;         1989 &lt;NA&gt;      IDGSP_… Digit … inte… no      ifels…    NA    NA sum     select 
## 10 satsa SATSA_IPT3 cognition cognition digitSpan   &lt;NA&gt;         1992 &lt;NA&gt;      IDGSP_… Digit … inte… no      ifels…    NA    NA sum     select 
## # … with 830 more rows, and abbreviated variable names ¹​orig_itemname, ²​description, ³​reverse_code, ⁴​comp_rule, ⁵​long_rule</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="cleaning.html#cb82-1" aria-hidden="true" tabindex="-1"></a>old.names <span class="ot">&lt;-</span> <span class="fu">unique</span>(satsa_codebook<span class="sc">$</span>orig_itemname) <span class="sc">%&gt;%</span> str_to_upper</span>
<span id="cb82-2"><a href="cleaning.html#cb82-2" aria-hidden="true" tabindex="-1"></a>datasets <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/satsa&quot;</span>, data_path) <span class="sc">%&gt;%</span> <span class="fu">list.files</span>(., <span class="at">pattern =</span> <span class="st">&quot;.sav&quot;</span>)</span>
<span id="cb82-3"><a href="cleaning.html#cb82-3" aria-hidden="true" tabindex="-1"></a>satsa <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">datasets =</span> datasets) <span class="sc">%&gt;%</span></span>
<span id="cb82-4"><a href="cleaning.html#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(datasets, satsa_read_fun),</span>
<span id="cb82-5"><a href="cleaning.html#cb82-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">ncol =</span> <span class="fu">map_dbl</span>(data, ncol)) <span class="sc">%&gt;%</span></span>
<span id="cb82-6"><a href="cleaning.html#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ncol <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb82-7"><a href="cleaning.html#cb82-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-8"><a href="cleaning.html#cb82-8" aria-hidden="true" tabindex="-1"></a>satsa <span class="ot">&lt;-</span> <span class="fu">reduce</span>(satsa<span class="sc">$</span>data, full_join)</span>
<span id="cb82-9"><a href="cleaning.html#cb82-9" aria-hidden="true" tabindex="-1"></a>satsa <span class="ot">&lt;-</span> satsa <span class="sc">%&gt;%</span></span>
<span id="cb82-10"><a href="cleaning.html#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.factor, <span class="sc">~</span><span class="fu">as.numeric</span>(<span class="fu">sub</span>(<span class="st">&quot;^</span><span class="sc">\\</span><span class="st">(0*([0-9]+)</span><span class="sc">\\</span><span class="st">).+$&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">1&quot;</span>, .))) </span>
<span id="cb82-11"><a href="cleaning.html#cb82-11" aria-hidden="true" tabindex="-1"></a>satsa_long <span class="ot">&lt;-</span> satsa <span class="sc">%&gt;%</span> </span>
<span id="cb82-12"><a href="cleaning.html#cb82-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb82-13"><a href="cleaning.html#cb82-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;orig_itemname&quot;</span></span>
<span id="cb82-14"><a href="cleaning.html#cb82-14" aria-hidden="true" tabindex="-1"></a>    , <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span></span>
<span id="cb82-15"><a href="cleaning.html#cb82-15" aria-hidden="true" tabindex="-1"></a>    , <span class="at">cols =</span> <span class="sc">-</span>SID</span>
<span id="cb82-16"><a href="cleaning.html#cb82-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># , values_drop_na = T</span></span>
<span id="cb82-17"><a href="cleaning.html#cb82-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb82-18"><a href="cleaning.html#cb82-18" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(satsa, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/satsa_raw.RData&quot;</span>, load_path))</span>
<span id="cb82-19"><a href="cleaning.html#cb82-19" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(satsa)</span></code></pre></div>
</div>
<div id="recoding-reverse-scoring-3" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Recoding &amp; Reverse Scoring<a href="cleaning.html#recoding-reverse-scoring-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="cleaning.html#cb83-1" aria-hidden="true" tabindex="-1"></a>satsa_waves <span class="ot">&lt;-</span> p_waves <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Study <span class="sc">==</span> <span class="st">&quot;SATSA&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Used) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb83-2"><a href="cleaning.html#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="cleaning.html#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># join data with recoding info </span></span>
<span id="cb83-4"><a href="cleaning.html#cb83-4" aria-hidden="true" tabindex="-1"></a>satsa_recode <span class="ot">&lt;-</span> satsa_codebook <span class="sc">%&gt;%</span></span>
<span id="cb83-5"><a href="cleaning.html#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(category, name, itemname, year, orig_itemname, reverse_code<span class="sc">:</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb83-6"><a href="cleaning.html#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;pers&quot;</span>, <span class="st">&quot;outcome&quot;</span>, <span class="st">&quot;covariates&quot;</span>, <span class="st">&quot;cognition&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb83-7"><a href="cleaning.html#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category, name) <span class="sc">%&gt;%</span></span>
<span id="cb83-8"><a href="cleaning.html#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb83-9"><a href="cleaning.html#cb83-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-10"><a href="cleaning.html#cb83-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(satsa_long)))</span>
<span id="cb83-11"><a href="cleaning.html#cb83-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-12"><a href="cleaning.html#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="co"># recode </span></span>
<span id="cb83-13"><a href="cleaning.html#cb83-13" aria-hidden="true" tabindex="-1"></a>recode_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(rule, y, year){</span>
<span id="cb83-14"><a href="cleaning.html#cb83-14" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y<span class="sc">$</span>value</span>
<span id="cb83-15"><a href="cleaning.html#cb83-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(rule)){y<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> rule))}</span>
<span id="cb83-16"><a href="cleaning.html#cb83-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb83-17"><a href="cleaning.html#cb83-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb83-18"><a href="cleaning.html#cb83-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-19"><a href="cleaning.html#cb83-19" aria-hidden="true" tabindex="-1"></a>satsa_recode <span class="ot">&lt;-</span> satsa_recode <span class="sc">%&gt;%</span> </span>
<span id="cb83-20"><a href="cleaning.html#cb83-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb83-21"><a href="cleaning.html#cb83-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(recode, year) <span class="sc">%&gt;%</span></span>
<span id="cb83-22"><a href="cleaning.html#cb83-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-23"><a href="cleaning.html#cb83-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb83-24"><a href="cleaning.html#cb83-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(recode, data, year), recode_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb83-25"><a href="cleaning.html#cb83-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb83-26"><a href="cleaning.html#cb83-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(value <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.nan</span>(value) <span class="sc">|</span> <span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb83-27"><a href="cleaning.html#cb83-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value))))</span>
<span id="cb83-28"><a href="cleaning.html#cb83-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-29"><a href="cleaning.html#cb83-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-30"><a href="cleaning.html#cb83-30" aria-hidden="true" tabindex="-1"></a><span class="co"># reverse code </span></span>
<span id="cb83-31"><a href="cleaning.html#cb83-31" aria-hidden="true" tabindex="-1"></a>satsa_recode <span class="ot">&lt;-</span> satsa_recode <span class="sc">%&gt;%</span></span>
<span id="cb83-32"><a href="cleaning.html#cb83-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb83-33"><a href="cleaning.html#cb83-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(reverse_code <span class="sc">==</span> <span class="st">&quot;no&quot;</span> <span class="sc">|</span> <span class="fu">is.na</span>(reverse_code), value, </span>
<span id="cb83-34"><a href="cleaning.html#cb83-34" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">reverse.code</span>(<span class="sc">-</span><span class="dv">1</span>, value, <span class="at">mini =</span> mini, <span class="at">maxi =</span> maxi)))))</span>
<span id="cb83-35"><a href="cleaning.html#cb83-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-36"><a href="cleaning.html#cb83-36" aria-hidden="true" tabindex="-1"></a>fun_call <span class="ot">&lt;-</span> <span class="cf">function</span>(x, rule){</span>
<span id="cb83-37"><a href="cleaning.html#cb83-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span>(rule,</span>
<span id="cb83-38"><a href="cleaning.html#cb83-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">average =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb83-39"><a href="cleaning.html#cb83-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">mode =</span> <span class="fu">Mode</span>(x)[<span class="dv">1</span>],</span>
<span id="cb83-40"><a href="cleaning.html#cb83-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">sum =</span> <span class="fu">sum</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb83-41"><a href="cleaning.html#cb83-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb83-42"><a href="cleaning.html#cb83-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">select =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb83-43"><a href="cleaning.html#cb83-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb83-44"><a href="cleaning.html#cb83-44" aria-hidden="true" tabindex="-1"></a>           <span class="at">min =</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> T))</span>
<span id="cb83-45"><a href="cleaning.html#cb83-45" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div id="covariates-3" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Covariates<a href="cleaning.html#covariates-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="cleaning.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/satsa_cleaned.RData&quot;</span>, local_path))</span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="cleaning.html#cb85-1" aria-hidden="true" tabindex="-1"></a>satsa_cov <span class="ot">&lt;-</span> satsa_recode <span class="sc">%&gt;%</span> <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;covariates&quot;</span>)</span>
<span id="cb85-2"><a href="cleaning.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="co"># bring in year or birth for cleaning</span></span>
<span id="cb85-3"><a href="cleaning.html#cb85-3" aria-hidden="true" tabindex="-1"></a>yrBrth <span class="ot">&lt;-</span> satsa_cov <span class="sc">%&gt;%</span> </span>
<span id="cb85-4"><a href="cleaning.html#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;yearBrth&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb85-5"><a href="cleaning.html#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb85-6"><a href="cleaning.html#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID) <span class="sc">%&gt;%</span></span>
<span id="cb85-7"><a href="cleaning.html#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">yearBrth =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb85-8"><a href="cleaning.html#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-9"><a href="cleaning.html#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yearBrth =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(yearBrth), <span class="cn">NA</span>, yearBrth))</span>
<span id="cb85-10"><a href="cleaning.html#cb85-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-11"><a href="cleaning.html#cb85-11" aria-hidden="true" tabindex="-1"></a><span class="co"># compositing within years</span></span>
<span id="cb85-12"><a href="cleaning.html#cb85-12" aria-hidden="true" tabindex="-1"></a>year_comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, rule){</span>
<span id="cb85-13"><a href="cleaning.html#cb85-13" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb85-14"><a href="cleaning.html#cb85-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># group by person and item (collapse across age)</span></span>
<span id="cb85-15"><a href="cleaning.html#cb85-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name, year, long_rule) <span class="sc">%&gt;%</span> </span>
<span id="cb85-16"><a href="cleaning.html#cb85-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb85-17"><a href="cleaning.html#cb85-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb85-18"><a href="cleaning.html#cb85-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value))</span>
<span id="cb85-19"><a href="cleaning.html#cb85-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-20"><a href="cleaning.html#cb85-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-21"><a href="cleaning.html#cb85-21" aria-hidden="true" tabindex="-1"></a>satsa_waves <span class="ot">&lt;-</span> p_waves <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Study <span class="sc">==</span> <span class="st">&quot;SATSA&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Used) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb85-22"><a href="cleaning.html#cb85-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-23"><a href="cleaning.html#cb85-23" aria-hidden="true" tabindex="-1"></a>satsa_cov <span class="ot">&lt;-</span> satsa_cov <span class="sc">%&gt;%</span></span>
<span id="cb85-24"><a href="cleaning.html#cb85-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb85-25"><a href="cleaning.html#cb85-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;=</span> <span class="fu">max</span>(satsa_waves<span class="sc">$</span>Used) <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-26"><a href="cleaning.html#cb85-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comp_rule =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(comp_rule) <span class="sc">|</span> comp_rule <span class="sc">==</span> <span class="st">&quot;none&quot;</span>, <span class="st">&quot;skip&quot;</span>, comp_rule)) <span class="sc">%&gt;%</span></span>
<span id="cb85-27"><a href="cleaning.html#cb85-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(comp_rule) <span class="sc">%&gt;%</span></span>
<span id="cb85-28"><a href="cleaning.html#cb85-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-29"><a href="cleaning.html#cb85-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-30"><a href="cleaning.html#cb85-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, comp_rule, year_comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb85-31"><a href="cleaning.html#cb85-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb85-32"><a href="cleaning.html#cb85-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-33"><a href="cleaning.html#cb85-33" aria-hidden="true" tabindex="-1"></a>comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, rule){</span>
<span id="cb85-34"><a href="cleaning.html#cb85-34" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb85-35"><a href="cleaning.html#cb85-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID) <span class="sc">%&gt;%</span></span>
<span id="cb85-36"><a href="cleaning.html#cb85-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb85-37"><a href="cleaning.html#cb85-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb85-38"><a href="cleaning.html#cb85-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-39"><a href="cleaning.html#cb85-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-40"><a href="cleaning.html#cb85-40" aria-hidden="true" tabindex="-1"></a>satsa_cov <span class="ot">&lt;-</span> satsa_cov <span class="sc">%&gt;%</span></span>
<span id="cb85-41"><a href="cleaning.html#cb85-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb85-42"><a href="cleaning.html#cb85-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-43"><a href="cleaning.html#cb85-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-44"><a href="cleaning.html#cb85-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, long_rule, comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb85-45"><a href="cleaning.html#cb85-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb85-46"><a href="cleaning.html#cb85-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb85-47"><a href="cleaning.html#cb85-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb85-48"><a href="cleaning.html#cb85-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> name, <span class="at">values_from =</span> value, <span class="at">values_fn =</span> <span class="fu">list</span>(<span class="at">value =</span> max))  <span class="sc">%&gt;%</span></span>
<span id="cb85-49"><a href="cleaning.html#cb85-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BMI =</span> weight<span class="sc">/</span>((height<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="cleaning.html#cb86-1" aria-hidden="true" tabindex="-1"></a>satsa_cov</span></code></pre></div>
<pre><code>## # A tibble: 3,840 × 18
##      SID smokes alcohol cancer diabetes heartProb married parkinsons respProb stroke gender education  mmse yearBrth SRhea…¹ height weight   BMI
##    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1   181      0      NA     NA       NA        NA      NA         NA       NA     NA      0        NA    NA     1900      NA     NA     NA    NA
##  2   182      0      NA     NA       NA        NA      NA         NA       NA     NA      0        NA    NA     1900      NA     NA     NA    NA
##  3  1101      0      NA     NA       NA        NA      NA         NA       NA     NA      0        NA    NA     1900      NA     NA     NA    NA
##  4  1102      0      NA     NA       NA        NA      NA         NA       NA     NA      0        NA    NA     1900      NA     NA     NA    NA
##  5  1121      0      NA     NA       NA        NA      NA         NA       NA     NA      1        NA    NA     1900      NA     NA     NA    NA
##  6  1122      0      NA     NA       NA        NA      NA         NA       NA     NA      1        NA    NA     1900      NA     NA     NA    NA
##  7  1151      0      NA     NA       NA        NA      NA         NA       NA     NA      1        NA    NA     1900      NA     NA     NA    NA
##  8  1152      0      NA     NA       NA        NA      NA         NA       NA     NA      1        NA    NA     1900      NA     NA     NA    NA
##  9  1211      0      NA     NA       NA        NA      NA         NA       NA     NA      1        NA    NA     1900      NA     NA     NA    NA
## 10  1212      0      NA     NA       NA        NA      NA         NA       NA     NA      1        NA    NA     1900      NA     NA     NA    NA
## # … with 3,830 more rows, and abbreviated variable name ¹​SRhealth</code></pre>
</div>
<div id="personality-variables-3" class="section level3 hasAnchor" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Personality Variables<a href="cleaning.html#personality-variables-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="cleaning.html#cb88-1" aria-hidden="true" tabindex="-1"></a>satsa_pers <span class="ot">&lt;-</span> satsa_recode <span class="sc">%&gt;%</span></span>
<span id="cb88-2"><a href="cleaning.html#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;pers&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-3"><a href="cleaning.html#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb88-4"><a href="cleaning.html#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(p_waves <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Study <span class="sc">==</span> <span class="st">&quot;SATSA&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">name =</span> p_item, Used)) <span class="sc">%&gt;%</span></span>
<span id="cb88-5"><a href="cleaning.html#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> Used <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb88-6"><a href="cleaning.html#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() </span>
<span id="cb88-7"><a href="cleaning.html#cb88-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-8"><a href="cleaning.html#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha&#39;s</span></span>
<span id="cb88-9"><a href="cleaning.html#cb88-9" aria-hidden="true" tabindex="-1"></a>satsa_alpha <span class="ot">&lt;-</span> satsa_pers <span class="sc">%&gt;%</span></span>
<span id="cb88-10"><a href="cleaning.html#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, itemname, year, SID, value) <span class="sc">%&gt;%</span></span>
<span id="cb88-11"><a href="cleaning.html#cb88-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, year) <span class="sc">%&gt;%</span></span>
<span id="cb88-12"><a href="cleaning.html#cb88-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb88-13"><a href="cleaning.html#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb88-14"><a href="cleaning.html#cb88-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> <span class="fu">spread</span>(itemname, value)),</span>
<span id="cb88-15"><a href="cleaning.html#cb88-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">alpha =</span> <span class="fu">map</span>(data, <span class="fu">possibly</span>(<span class="sc">~</span>psych<span class="sc">::</span><span class="fu">alpha</span>((.) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>SID)), <span class="cn">NA_real_</span>)))</span>
<span id="cb88-16"><a href="cleaning.html#cb88-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-17"><a href="cleaning.html#cb88-17" aria-hidden="true" tabindex="-1"></a><span class="co"># create composites</span></span>
<span id="cb88-18"><a href="cleaning.html#cb88-18" aria-hidden="true" tabindex="-1"></a>satsa_pers <span class="ot">&lt;-</span> satsa_pers <span class="sc">%&gt;%</span></span>
<span id="cb88-19"><a href="cleaning.html#cb88-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name, year) <span class="sc">%&gt;%</span></span>
<span id="cb88-20"><a href="cleaning.html#cb88-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb88-21"><a href="cleaning.html#cb88-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="cleaning.html#cb89-1" aria-hidden="true" tabindex="-1"></a>satsa_pers</span></code></pre></div>
<pre><code>## # A tibble: 14,109 × 4
##      SID name   year value
##    &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  1292 A      1984  4   
##  2  1292 C      1984  4   
##  3  1292 E      1984  3.67
##  4  1292 N      1984  4.33
##  5  1292 O      1984  3.5 
##  6  1292 SWL    1984  2.54
##  7  1701 C      1984  5   
##  8  1701 E      1984  3.89
##  9  1701 N      1984  4   
## 10  1701 O      1984  1   
## # … with 14,099 more rows</code></pre>
</div>
<div id="outcome-variables-3" class="section level3 hasAnchor" number="2.4.5">
<h3><span class="header-section-number">2.4.5</span> Outcome Variables<a href="cleaning.html#outcome-variables-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="cleaning.html#cb91-1" aria-hidden="true" tabindex="-1"></a>satsa_out <span class="ot">&lt;-</span> satsa_recode <span class="sc">%&gt;%</span> </span>
<span id="cb91-2"><a href="cleaning.html#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;outcome&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="cleaning.html#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb91-4"><a href="cleaning.html#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb91-5"><a href="cleaning.html#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(<span class="fu">crossing</span>(<span class="at">p_year =</span> satsa_waves<span class="sc">$</span>Used, <span class="at">name =</span> <span class="fu">unique</span>((.)<span class="sc">$</span>name)))</span>
<span id="cb91-6"><a href="cleaning.html#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="cleaning.html#cb91-7" aria-hidden="true" tabindex="-1"></a>satsa_out_waves <span class="ot">&lt;-</span> satsa_out <span class="sc">%&gt;%</span></span>
<span id="cb91-8"><a href="cleaning.html#cb91-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb91-9"><a href="cleaning.html#cb91-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">o_year =</span> <span class="fu">max</span>(year)) <span class="sc">%&gt;%</span></span>
<span id="cb91-10"><a href="cleaning.html#cb91-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb91-11"><a href="cleaning.html#cb91-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-12"><a href="cleaning.html#cb91-12" aria-hidden="true" tabindex="-1"></a>satsa_waves <span class="ot">&lt;-</span> p_waves <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Study <span class="sc">==</span> <span class="st">&quot;SATSA&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Used) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb91-13"><a href="cleaning.html#cb91-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-14"><a href="cleaning.html#cb91-14" aria-hidden="true" tabindex="-1"></a>satsa_out <span class="ot">&lt;-</span> satsa_out <span class="sc">%&gt;%</span></span>
<span id="cb91-15"><a href="cleaning.html#cb91-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;</span> p_year) <span class="sc">%&gt;%</span></span>
<span id="cb91-16"><a href="cleaning.html#cb91-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name, year, p_year) <span class="sc">%&gt;%</span></span>
<span id="cb91-17"><a href="cleaning.html#cb91-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-18"><a href="cleaning.html#cb91-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb91-19"><a href="cleaning.html#cb91-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.nan</span>(value)<span class="sc">|</span><span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb91-20"><a href="cleaning.html#cb91-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, p_year, name) <span class="sc">%&gt;%</span></span>
<span id="cb91-21"><a href="cleaning.html#cb91-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb91-22"><a href="cleaning.html#cb91-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb91-23"><a href="cleaning.html#cb91-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value),</span>
<span id="cb91-24"><a href="cleaning.html#cb91-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">o_year =</span> <span class="dv">2005</span>) </span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="cleaning.html#cb92-1" aria-hidden="true" tabindex="-1"></a>satsa_out</span></code></pre></div>
<pre><code>## # A tibble: 3,840 × 5
##      SID p_year name     value o_year
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;
##  1   181   1984 dementia     0   2005
##  2   182   1984 dementia     0   2005
##  3  1101   1984 dementia     0   2005
##  4  1102   1984 dementia     0   2005
##  5  1121   1984 dementia     0   2005
##  6  1122   1984 dementia     0   2005
##  7  1151   1984 dementia     0   2005
##  8  1152   1984 dementia     0   2005
##  9  1211   1984 dementia     0   2005
## 10  1212   1984 dementia     0   2005
## # … with 3,830 more rows</code></pre>
</div>
<div id="cognition-variables-3" class="section level3 hasAnchor" number="2.4.6">
<h3><span class="header-section-number">2.4.6</span> Cognition Variables<a href="cleaning.html#cognition-variables-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="cleaning.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># composite within years</span></span>
<span id="cb94-2"><a href="cleaning.html#cb94-2" aria-hidden="true" tabindex="-1"></a>satsa_cog <span class="ot">&lt;-</span> satsa_recode <span class="sc">%&gt;%</span></span>
<span id="cb94-3"><a href="cleaning.html#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;cognition&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-4"><a href="cleaning.html#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>category) <span class="sc">%&gt;%</span></span>
<span id="cb94-5"><a href="cleaning.html#cb94-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb94-6"><a href="cleaning.html#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">1985</span>) <span class="sc">%&gt;%</span></span>
<span id="cb94-7"><a href="cleaning.html#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb94-8"><a href="cleaning.html#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, itemname, year) <span class="sc">%&gt;%</span></span>
<span id="cb94-9"><a href="cleaning.html#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">pomp</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb94-10"><a href="cleaning.html#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, SID) <span class="sc">%&gt;%</span></span>
<span id="cb94-11"><a href="cleaning.html#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb94-12"><a href="cleaning.html#cb94-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb94-13"><a href="cleaning.html#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span></span>
<span id="cb94-14"><a href="cleaning.html#cb94-14" aria-hidden="true" tabindex="-1"></a>              , <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span></code></pre></div>
</div>
<div id="combine-data-3" class="section level3 hasAnchor" number="2.4.7">
<h3><span class="header-section-number">2.4.7</span> Combine Data<a href="cleaning.html#combine-data-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="cleaning.html#cb95-1" aria-hidden="true" tabindex="-1"></a>satsa_combined <span class="ot">&lt;-</span> satsa_pers <span class="sc">%&gt;%</span> </span>
<span id="cb95-2"><a href="cleaning.html#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Trait =</span> name, <span class="at">p_value =</span> value, <span class="at">p_year =</span> year) <span class="sc">%&gt;%</span></span>
<span id="cb95-3"><a href="cleaning.html#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(satsa_out <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Outcome =</span> name, <span class="at">o_value =</span> value)) <span class="sc">%&gt;%</span></span>
<span id="cb95-4"><a href="cleaning.html#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(satsa_cov) <span class="sc">%&gt;%</span></span>
<span id="cb95-5"><a href="cleaning.html#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb95-6"><a href="cleaning.html#cb95-6" aria-hidden="true" tabindex="-1"></a>    satsa_out <span class="sc">%&gt;%</span></span>
<span id="cb95-7"><a href="cleaning.html#cb95-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-8"><a href="cleaning.html#cb95-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb95-9"><a href="cleaning.html#cb95-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb95-10"><a href="cleaning.html#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(satsa_cog) <span class="sc">%&gt;%</span></span>
<span id="cb95-11"><a href="cleaning.html#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_value) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(o_value)) <span class="sc">%&gt;%</span></span>
<span id="cb95-12"><a href="cleaning.html#cb95-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> p_year <span class="sc">-</span> yearBrth</span>
<span id="cb95-13"><a href="cleaning.html#cb95-13" aria-hidden="true" tabindex="-1"></a>         , <span class="at">o_year =</span> <span class="dv">2005</span>)</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="cleaning.html#cb96-1" aria-hidden="true" tabindex="-1"></a>satsa_combined</span></code></pre></div>
<pre><code>## # A tibble: 14,109 × 27
##      SID Trait p_year p_value Outcome  o_value o_year smokes alcohol cancer diabetes heart…¹ married parki…² respP…³ stroke gender educa…⁴  mmse
##    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
##  1  1292 A       1984    4    dementia       0   2005      0       0      1        0       1       1       0       0      0      1       9    NA
##  2  1292 C       1984    4    dementia       0   2005      0       0      1        0       1       1       0       0      0      1       9    NA
##  3  1292 E       1984    3.67 dementia       0   2005      0       0      1        0       1       1       0       0      0      1       9    NA
##  4  1292 N       1984    4.33 dementia       0   2005      0       0      1        0       1       1       0       0      0      1       9    NA
##  5  1292 O       1984    3.5  dementia       0   2005      0       0      1        0       1       1       0       0      0      1       9    NA
##  6  1292 SWL     1984    2.54 dementia       0   2005      0       0      1        0       1       1       0       0      0      1       9    NA
##  7  1701 C       1984    5    dementia       0   2005      0       0      0        0       1      NA       0       0      0      1      12    NA
##  8  1701 E       1984    3.89 dementia       0   2005      0       0      0        0       1      NA       0       0      0      1      12    NA
##  9  1701 N       1984    4    dementia       0   2005      0       0      0        0       1      NA       0       0      0      1      12    NA
## 10  1701 O       1984    1    dementia       0   2005      0       0      0        0       1      NA       0       0      0      1      12    NA
## # … with 14,099 more rows, 8 more variables: yearBrth &lt;dbl&gt;, SRhealth &lt;dbl&gt;, height &lt;dbl&gt;, weight &lt;dbl&gt;, BMI &lt;dbl&gt;, dementia &lt;dbl&gt;,
## #   cognition &lt;dbl&gt;, age &lt;dbl&gt;, and abbreviated variable names ¹​heartProb, ²​parkinsons, ³​respProb, ⁴​education</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="cleaning.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(satsa_cov, satsa_alpha, satsa_pers, satsa_out, satsa_combined, satsa_cog,</span>
<span id="cb98-2"><a href="cleaning.html#cb98-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/satsa_cleaned.RData&quot;</span>, load_path))</span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="cleaning.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span><span class="fu">ls</span>()[<span class="fu">grepl</span>(<span class="st">&quot;satsa&quot;</span>, <span class="fu">ls</span>())])</span></code></pre></div>
</div>
</div>
<div id="adrc-memory-and-aging-project-adrc-map" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> ADRC Memory and Aging Project (ADRC-MAP)<a href="cleaning.html#adrc-memory-and-aging-project-adrc-map" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Alzheimer Disease Research Center Memory and Aging Project (ADRC-MAP) is an ongoing longitudinal study of memory and Alzheimer’s Disease that began in 1979. Data are available on a study-by-study basis through application from <a href="https://knightadrc.wustl.edu/Research/ResourceRequest.htm" class="uri">https://knightadrc.wustl.edu/Research/ResourceRequest.htm</a>.</p>
<p>Participants were recruited from the Charles and Joanne F. Knight Alzheimer’s Disease Research Center at Washington University in St. Louis as part of an ongoing study of disease progression. The current study uses a subset of approximately 1200 of these participants who completed personality surveys as part of a substudy (see Duchek et al., 2019). More information on the study can be found at <a href="https://knightadrc.wustl.edu/Research/PDFs/Clinical%20Core%20list%20of%20measures.pdf" class="uri">https://knightadrc.wustl.edu/Research/PDFs/Clinical%20Core%20list%20of%20measures.pdf</a>.</p>
<p>Sample sizes vary over time, from approximately 400 to 1200. This provides 99% power to detect a zero-order correlation effect size of ~.15, two-tailed at alpha .05.</p>
<div id="load-data-3" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Load Data<a href="cleaning.html#load-data-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="cleaning.html#cb100-1" aria-hidden="true" tabindex="-1"></a>(adrc_codebook <span class="ot">&lt;-</span> (codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(study <span class="sc">==</span> <span class="st">&quot;ADRC&quot;</span>))<span class="sc">$</span>codebook[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>## # A tibble: 106 × 15
##    study dataset category  name      itemname     year         orig_itemname description        scale rever…¹ recode  mini  maxi comp_…² long_…³
##    &lt;chr&gt; &lt;lgl&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;              &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
##  1 ADRC  NA      cognition cognition waisBlckDes  longitudinal PSY021        &quot;WAIS BLOCK DESIG… Rang… no      ifels…    NA    NA sum     select 
##  2 ADRC  NA      cognition cognition waisInfo     longitudinal PSY019        &quot;WAIS INFORMATION… Rang… no      ifels…    NA    NA sum     select 
##  3 ADRC  NA      cognition cognition waisRDigSym  longitudinal DIGSYM        &quot;WAIS-R DIGIT SYM… Rang… no      ifels…    NA    NA sum     select 
##  4 ADRC  NA      cognition cognition digFrwdCor   longitudinal DIGFORCT      &quot;NUMBER SPAN TEST… Rang… no      ifels…    NA    NA sum     select 
##  5 ADRC  NA      cognition cognition digBckwdCor  longitudinal DIGBACCT      &quot;NUMBER SPAN TEST… Rang… no      ifels…    NA    NA sum     select 
##  6 ADRC  NA      cognition cognition trailMakingA longitudinal TRAILA        &quot;The score is the… Rang… no      ifels…    NA    NA sum     select 
##  7 ADRC  NA      cognition cognition trailMakingB longitudinal TRAILB        &quot;The score is the… Rang… no      ifels…    NA    NA sum     select 
##  8 ADRC  NA      cognition cognition cuedRecallT1 longitudinal SRT1C         &quot;Free &amp; Cued SRT:… Rang… no      ifels…    NA    NA sum     select 
##  9 ADRC  NA      cognition cognition cuedRecallT2 longitudinal SRT2C         &quot;Free &amp; Cued SRT:… Rang… no      ifels…    NA    NA sum     select 
## 10 ADRC  NA      cognition cognition cuedRecallT3 longitudinal SRT3C         &quot;Free &amp; Cued SRT:… Rang… no      ifels…    NA    NA sum     select 
## # … with 96 more rows, and abbreviated variable names ¹​reverse_code, ²​comp_rule, ³​long_rule</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="cleaning.html#cb102-1" aria-hidden="true" tabindex="-1"></a>adrc_read_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(file){</span>
<span id="cb102-2"><a href="cleaning.html#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(file)</span>
<span id="cb102-3"><a href="cleaning.html#cb102-3" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/adrc-map/%s&quot;</span>, data_path, file) <span class="sc">%&gt;%</span> <span class="fu">read_excel</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb102-4"><a href="cleaning.html#cb102-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">SID =</span> id, <span class="fu">one_of</span>(<span class="fu">c</span>(<span class="st">&quot;TESTDATE&quot;</span>, old.names)), <span class="fu">contains</span>(<span class="st">&quot;NEO Date&quot;</span>))</span>
<span id="cb102-5"><a href="cleaning.html#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="st">&quot;TESTDATE&quot;</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(d)){ <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">class</span>(d<span class="sc">$</span>TESTDATE) <span class="sc">!=</span> <span class="st">&quot;numeric&quot;</span>)){d<span class="sc">$</span>TESTDATE <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">year</span>(d<span class="sc">$</span>TESTDATE)}}</span>
<span id="cb102-6"><a href="cleaning.html#cb102-6" aria-hidden="true" tabindex="-1"></a>  d</span>
<span id="cb102-7"><a href="cleaning.html#cb102-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb102-8"><a href="cleaning.html#cb102-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-9"><a href="cleaning.html#cb102-9" aria-hidden="true" tabindex="-1"></a>old.names <span class="ot">&lt;-</span> <span class="fu">unique</span>(adrc_codebook<span class="sc">$</span>orig_itemname)</span>
<span id="cb102-10"><a href="cleaning.html#cb102-10" aria-hidden="true" tabindex="-1"></a>adrc <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">file =</span> <span class="fu">list.files</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/adrc-map&quot;</span>, data_path), <span class="at">pattern =</span> <span class="st">&quot;.xlsx&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb102-11"><a href="cleaning.html#cb102-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;NEO&quot;</span>, file)) <span class="sc">%&gt;%</span></span>
<span id="cb102-12"><a href="cleaning.html#cb102-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(file, adrc_read_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb102-13"><a href="cleaning.html#cb102-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">map_dbl</span>(data, ncol) <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb102-14"><a href="cleaning.html#cb102-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-15"><a href="cleaning.html#cb102-15" aria-hidden="true" tabindex="-1"></a>waves <span class="ot">&lt;-</span> adrc <span class="sc">%&gt;%</span></span>
<span id="cb102-16"><a href="cleaning.html#cb102-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> <span class="fu">select</span>(SID, <span class="fu">one_of</span>(<span class="st">&quot;TESTDATE&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb102-17"><a href="cleaning.html#cb102-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>file) <span class="sc">%&gt;%</span></span>
<span id="cb102-18"><a href="cleaning.html#cb102-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb102-19"><a href="cleaning.html#cb102-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb102-20"><a href="cleaning.html#cb102-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(year = lubridate::year(TESTDATE)) %&gt;%</span></span>
<span id="cb102-21"><a href="cleaning.html#cb102-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb102-22"><a href="cleaning.html#cb102-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(SID, TESTDATE) <span class="sc">%&gt;%</span></span>
<span id="cb102-23"><a href="cleaning.html#cb102-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID) <span class="sc">%&gt;%</span></span>
<span id="cb102-24"><a href="cleaning.html#cb102-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">frstyear =</span> <span class="fu">min</span>(TESTDATE)) <span class="sc">%&gt;%</span></span>
<span id="cb102-25"><a href="cleaning.html#cb102-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb102-26"><a href="cleaning.html#cb102-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> TESTDATE, </span>
<span id="cb102-27"><a href="cleaning.html#cb102-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">wave =</span> year <span class="sc">-</span> frstyear <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb102-28"><a href="cleaning.html#cb102-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-29"><a href="cleaning.html#cb102-29" aria-hidden="true" tabindex="-1"></a>adrc_long <span class="ot">&lt;-</span> <span class="fu">reduce</span>(adrc<span class="sc">$</span>data, full_join) <span class="sc">%&gt;%</span></span>
<span id="cb102-30"><a href="cleaning.html#cb102-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb102-31"><a href="cleaning.html#cb102-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SID, <span class="at">year =</span> TESTDATE, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb102-32"><a href="cleaning.html#cb102-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BIRTH =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(BIRTH)) <span class="sc">%&gt;%</span></span>
<span id="cb102-33"><a href="cleaning.html#cb102-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="sc">-</span>SID, <span class="sc">-</span>year)</span>
<span id="cb102-34"><a href="cleaning.html#cb102-34" aria-hidden="true" tabindex="-1"></a>               , <span class="at">names_to =</span> <span class="st">&quot;orig_itemname&quot;</span></span>
<span id="cb102-35"><a href="cleaning.html#cb102-35" aria-hidden="true" tabindex="-1"></a>               , <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb102-36"><a href="cleaning.html#cb102-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-37"><a href="cleaning.html#cb102-37" aria-hidden="true" tabindex="-1"></a><span class="co"># load personality data separately</span></span>
<span id="cb102-38"><a href="cleaning.html#cb102-38" aria-hidden="true" tabindex="-1"></a>old.names <span class="ot">&lt;-</span> (adrc_codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;pers&quot;</span>))<span class="sc">$</span>orig_itemname</span>
<span id="cb102-39"><a href="cleaning.html#cb102-39" aria-hidden="true" tabindex="-1"></a>adrc_pers <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/adrc-map/NEO - Raw Scores_FINAL.xlsx&quot;</span>, data_path) <span class="sc">%&gt;%</span> </span>
<span id="cb102-40"><a href="cleaning.html#cb102-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_xlsx</span>() <span class="sc">%&gt;%</span></span>
<span id="cb102-41"><a href="cleaning.html#cb102-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">SID =</span> id, <span class="at">date =</span> <span class="st">`</span><span class="at">NEO Date 1</span><span class="st">`</span>, <span class="fu">one_of</span>(old.names)) <span class="sc">%&gt;%</span></span>
<span id="cb102-42"><a href="cleaning.html#cb102-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;[//]&quot;</span>, date), <span class="fu">as.numeric</span>(<span class="fu">as.Date</span>(date, <span class="at">format =</span> <span class="st">&quot;%m/%d/%Y&quot;</span>)), date),</span>
<span id="cb102-43"><a href="cleaning.html#cb102-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">date =</span> <span class="fu">as.Date</span>(<span class="fu">as.numeric</span>(date), <span class="at">origin=</span><span class="st">&quot;1899-12-30&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb102-44"><a href="cleaning.html#cb102-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(date))</span>
<span id="cb102-45"><a href="cleaning.html#cb102-45" aria-hidden="true" tabindex="-1"></a><span class="co"># get waves for participants</span></span>
<span id="cb102-46"><a href="cleaning.html#cb102-46" aria-hidden="true" tabindex="-1"></a>adrc_pers_waves <span class="ot">&lt;-</span> adrc_pers <span class="sc">%&gt;%</span></span>
<span id="cb102-47"><a href="cleaning.html#cb102-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SID, <span class="at">p_year =</span> date) <span class="sc">%&gt;%</span></span>
<span id="cb102-48"><a href="cleaning.html#cb102-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb102-49"><a href="cleaning.html#cb102-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(p_year))</span></code></pre></div>
</div>
<div id="recode-reverse-scoring" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Recode &amp; Reverse-Scoring<a href="cleaning.html#recode-reverse-scoring" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="cleaning.html#cb103-1" aria-hidden="true" tabindex="-1"></a>adrc_recode <span class="ot">&lt;-</span> adrc_codebook <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="cleaning.html#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span>  <span class="fu">c</span>(<span class="st">&quot;covariates&quot;</span>, <span class="st">&quot;outcome&quot;</span>, <span class="st">&quot;cognition&quot;</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(orig_itemname)) <span class="sc">%&gt;%</span></span>
<span id="cb103-3"><a href="cleaning.html#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(category, name, itemname, orig_itemname, reverse_code<span class="sc">:</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb103-4"><a href="cleaning.html#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(adrc_long) <span class="sc">%&gt;%</span></span>
<span id="cb103-5"><a href="cleaning.html#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(adrc_pers_waves)</span>
<span id="cb103-6"><a href="cleaning.html#cb103-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-7"><a href="cleaning.html#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="co"># recode </span></span>
<span id="cb103-8"><a href="cleaning.html#cb103-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-9"><a href="cleaning.html#cb103-9" aria-hidden="true" tabindex="-1"></a>recode_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(rule, y, year){</span>
<span id="cb103-10"><a href="cleaning.html#cb103-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print(rule)</span></span>
<span id="cb103-11"><a href="cleaning.html#cb103-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y<span class="sc">$</span>value</span>
<span id="cb103-12"><a href="cleaning.html#cb103-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(rule)){y<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> rule))}</span>
<span id="cb103-13"><a href="cleaning.html#cb103-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb103-14"><a href="cleaning.html#cb103-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-15"><a href="cleaning.html#cb103-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-16"><a href="cleaning.html#cb103-16" aria-hidden="true" tabindex="-1"></a>adrc_recode <span class="ot">&lt;-</span> adrc_recode <span class="sc">%&gt;%</span></span>
<span id="cb103-17"><a href="cleaning.html#cb103-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(recode, year) <span class="sc">%&gt;%</span></span>
<span id="cb103-18"><a href="cleaning.html#cb103-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb103-19"><a href="cleaning.html#cb103-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb103-20"><a href="cleaning.html#cb103-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(recode, data, year), recode_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb103-21"><a href="cleaning.html#cb103-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb103-22"><a href="cleaning.html#cb103-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-23"><a href="cleaning.html#cb103-23" aria-hidden="true" tabindex="-1"></a><span class="co"># reverse code </span></span>
<span id="cb103-24"><a href="cleaning.html#cb103-24" aria-hidden="true" tabindex="-1"></a>adrc_recode <span class="ot">&lt;-</span> adrc_recode <span class="sc">%&gt;%</span></span>
<span id="cb103-25"><a href="cleaning.html#cb103-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(reverse_code <span class="sc">==</span> <span class="st">&quot;no&quot;</span> <span class="sc">|</span> <span class="fu">is.na</span>(reverse_code), value, </span>
<span id="cb103-26"><a href="cleaning.html#cb103-26" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">reverse.code</span>(<span class="sc">-</span><span class="dv">1</span>, value, <span class="at">mini =</span> mini, <span class="at">maxi =</span> maxi))) <span class="sc">%&gt;%</span></span>
<span id="cb103-27"><a href="cleaning.html#cb103-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category, name) <span class="sc">%&gt;%</span></span>
<span id="cb103-28"><a href="cleaning.html#cb103-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb103-29"><a href="cleaning.html#cb103-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb103-30"><a href="cleaning.html#cb103-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-31"><a href="cleaning.html#cb103-31" aria-hidden="true" tabindex="-1"></a>fun_call <span class="ot">&lt;-</span> <span class="cf">function</span>(x, rule){</span>
<span id="cb103-32"><a href="cleaning.html#cb103-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span>(rule,</span>
<span id="cb103-33"><a href="cleaning.html#cb103-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">average =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb103-34"><a href="cleaning.html#cb103-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">mode =</span> <span class="fu">Mode</span>(x)[<span class="dv">1</span>],</span>
<span id="cb103-35"><a href="cleaning.html#cb103-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">sum =</span> <span class="fu">sum</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb103-36"><a href="cleaning.html#cb103-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb103-37"><a href="cleaning.html#cb103-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">select =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb103-38"><a href="cleaning.html#cb103-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb103-39"><a href="cleaning.html#cb103-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">min =</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> T))</span>
<span id="cb103-40"><a href="cleaning.html#cb103-40" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div id="covariates-4" class="section level3 hasAnchor" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> Covariates<a href="cleaning.html#covariates-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="cleaning.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/adrc_cleaned.RData&quot;</span>, local_path))</span></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="cleaning.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compositing within years</span></span>
<span id="cb105-2"><a href="cleaning.html#cb105-2" aria-hidden="true" tabindex="-1"></a>year_comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, rule){</span>
<span id="cb105-3"><a href="cleaning.html#cb105-3" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb105-4"><a href="cleaning.html#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># group by person and item (collapse across age)</span></span>
<span id="cb105-5"><a href="cleaning.html#cb105-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name, year, p_year, long_rule) <span class="sc">%&gt;%</span> </span>
<span id="cb105-6"><a href="cleaning.html#cb105-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb105-7"><a href="cleaning.html#cb105-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb105-8"><a href="cleaning.html#cb105-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value))</span>
<span id="cb105-9"><a href="cleaning.html#cb105-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-10"><a href="cleaning.html#cb105-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-11"><a href="cleaning.html#cb105-11" aria-hidden="true" tabindex="-1"></a>adrc_cov <span class="ot">&lt;-</span> adrc_recode <span class="sc">%&gt;%</span></span>
<span id="cb105-12"><a href="cleaning.html#cb105-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;covariates&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb105-13"><a href="cleaning.html#cb105-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb105-14"><a href="cleaning.html#cb105-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;=</span> p_year) <span class="sc">%&gt;%</span></span>
<span id="cb105-15"><a href="cleaning.html#cb105-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comp_rule =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(comp_rule) <span class="sc">|</span> comp_rule <span class="sc">==</span> <span class="st">&quot;none&quot;</span>, <span class="st">&quot;skip&quot;</span>, comp_rule)) <span class="sc">%&gt;%</span></span>
<span id="cb105-16"><a href="cleaning.html#cb105-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(comp_rule) <span class="sc">%&gt;%</span></span>
<span id="cb105-17"><a href="cleaning.html#cb105-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb105-18"><a href="cleaning.html#cb105-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb105-19"><a href="cleaning.html#cb105-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, comp_rule, year_comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb105-20"><a href="cleaning.html#cb105-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb105-21"><a href="cleaning.html#cb105-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>comp_rule)</span>
<span id="cb105-22"><a href="cleaning.html#cb105-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-23"><a href="cleaning.html#cb105-23" aria-hidden="true" tabindex="-1"></a>comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, rule){</span>
<span id="cb105-24"><a href="cleaning.html#cb105-24" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb105-25"><a href="cleaning.html#cb105-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb105-26"><a href="cleaning.html#cb105-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb105-27"><a href="cleaning.html#cb105-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb105-28"><a href="cleaning.html#cb105-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-29"><a href="cleaning.html#cb105-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-30"><a href="cleaning.html#cb105-30" aria-hidden="true" tabindex="-1"></a>adrc_cov <span class="ot">&lt;-</span> adrc_cov <span class="sc">%&gt;%</span></span>
<span id="cb105-31"><a href="cleaning.html#cb105-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(name)) <span class="sc">%&gt;%</span></span>
<span id="cb105-32"><a href="cleaning.html#cb105-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb105-33"><a href="cleaning.html#cb105-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb105-34"><a href="cleaning.html#cb105-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb105-35"><a href="cleaning.html#cb105-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, long_rule, comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb105-36"><a href="cleaning.html#cb105-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span> </span>
<span id="cb105-37"><a href="cleaning.html#cb105-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb105-38"><a href="cleaning.html#cb105-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb105-39"><a href="cleaning.html#cb105-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> name, <span class="at">values_from =</span> value, <span class="at">values_fn =</span> <span class="fu">list</span>(<span class="at">value =</span> max)) <span class="sc">%&gt;%</span></span>
<span id="cb105-40"><a href="cleaning.html#cb105-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(adrc_pers_waves) <span class="sc">%&gt;%</span></span>
<span id="cb105-41"><a href="cleaning.html#cb105-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> p_year <span class="sc">-</span> yearBrth)</span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="cleaning.html#cb106-1" aria-hidden="true" tabindex="-1"></a>adrc_cov</span></code></pre></div>
<pre><code>## # A tibble: 1,162 × 15
##      SID gender yearBrth alcohol cancer diabetes education heartProb married  race smokes stroke weight p_year   age
##    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1  1070      0     1918       1      1        0        17         1       1     0      0      0    187   2003    85
##  2  1088      0     1916       1      1        0        16         1       1     0      0      0    217   2005    89
##  3  1380      1     1913       1      1        0        16         1       0     0      0      0    129   2003    90
##  4 10018      0     1929       0      0        0        14         1       1     0      1      0    156   2005    76
##  5 10034      0     1930       0      1        0        16         0       1     0      0      0    193   2004    74
##  6 10037      1     1923       1      1        0        13         1       1     0      1      0    179   2006    83
##  7 10038      0     1927       1      0        0        18         0       1     0      0      0    205   2003    76
##  8 10045      1     1931       1      1        0        16         0       1     0      1      0    160   2003    72
##  9 10054      1     1930       0      1        0        13         1       1     0      1      0    173   2008    78
## 10 10064      0     1928       1      1        0        20         1       1     0      1      0    199   2003    75
## # … with 1,152 more rows</code></pre>
</div>
<div id="personality-variables-4" class="section level3 hasAnchor" number="2.5.4">
<h3><span class="header-section-number">2.5.4</span> Personality Variables<a href="cleaning.html#personality-variables-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="cleaning.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bring in codebook info</span></span>
<span id="cb108-2"><a href="cleaning.html#cb108-2" aria-hidden="true" tabindex="-1"></a>adrc_pers <span class="ot">&lt;-</span> adrc_pers <span class="sc">%&gt;%</span></span>
<span id="cb108-3"><a href="cleaning.html#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="st">`</span><span class="at">1S1</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">1S60</span><span class="st">`</span></span>
<span id="cb108-4"><a href="cleaning.html#cb108-4" aria-hidden="true" tabindex="-1"></a>               , <span class="at">names_to =</span> <span class="st">&quot;orig_itemname&quot;</span></span>
<span id="cb108-5"><a href="cleaning.html#cb108-5" aria-hidden="true" tabindex="-1"></a>               , <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span></span>
<span id="cb108-6"><a href="cleaning.html#cb108-6" aria-hidden="true" tabindex="-1"></a>               , <span class="at">values_drop_na =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb108-7"><a href="cleaning.html#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(adrc_codebook <span class="sc">%&gt;%</span> <span class="fu">select</span>(name<span class="sc">:</span>orig_itemname, reverse_code<span class="sc">:</span>maxi))</span>
<span id="cb108-8"><a href="cleaning.html#cb108-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-9"><a href="cleaning.html#cb108-9" aria-hidden="true" tabindex="-1"></a>recode_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(rule, y){</span>
<span id="cb108-10"><a href="cleaning.html#cb108-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y<span class="sc">$</span>value</span>
<span id="cb108-11"><a href="cleaning.html#cb108-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(rule)){y<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> rule))}</span>
<span id="cb108-12"><a href="cleaning.html#cb108-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb108-13"><a href="cleaning.html#cb108-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb108-14"><a href="cleaning.html#cb108-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-15"><a href="cleaning.html#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="co"># recode </span></span>
<span id="cb108-16"><a href="cleaning.html#cb108-16" aria-hidden="true" tabindex="-1"></a>adrc_pers <span class="ot">&lt;-</span> adrc_pers <span class="sc">%&gt;%</span></span>
<span id="cb108-17"><a href="cleaning.html#cb108-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(recode) <span class="sc">%&gt;%</span></span>
<span id="cb108-18"><a href="cleaning.html#cb108-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb108-19"><a href="cleaning.html#cb108-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb108-20"><a href="cleaning.html#cb108-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(recode, data, recode_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb108-21"><a href="cleaning.html#cb108-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) </span>
<span id="cb108-22"><a href="cleaning.html#cb108-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-23"><a href="cleaning.html#cb108-23" aria-hidden="true" tabindex="-1"></a><span class="co"># reverse code </span></span>
<span id="cb108-24"><a href="cleaning.html#cb108-24" aria-hidden="true" tabindex="-1"></a>adrc_pers <span class="ot">&lt;-</span> adrc_pers <span class="sc">%&gt;%</span></span>
<span id="cb108-25"><a href="cleaning.html#cb108-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">tolower</span>(reverse_code) <span class="sc">==</span> <span class="st">&quot;no&quot;</span> <span class="sc">|</span> <span class="fu">is.na</span>(reverse_code), value, </span>
<span id="cb108-26"><a href="cleaning.html#cb108-26" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">reverse.code</span>(<span class="sc">-</span><span class="dv">1</span>, value, <span class="at">mini =</span> mini, <span class="at">maxi =</span> maxi)))</span>
<span id="cb108-27"><a href="cleaning.html#cb108-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-28"><a href="cleaning.html#cb108-28" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha&#39;s</span></span>
<span id="cb108-29"><a href="cleaning.html#cb108-29" aria-hidden="true" tabindex="-1"></a>adrc_alpha <span class="ot">&lt;-</span> adrc_pers <span class="sc">%&gt;%</span></span>
<span id="cb108-30"><a href="cleaning.html#cb108-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, itemname, date, SID, value) <span class="sc">%&gt;%</span></span>
<span id="cb108-31"><a href="cleaning.html#cb108-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb108-32"><a href="cleaning.html#cb108-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb108-33"><a href="cleaning.html#cb108-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> itemname, <span class="at">values_from =</span> value)),</span>
<span id="cb108-34"><a href="cleaning.html#cb108-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">alpha =</span> <span class="fu">map</span>(data, <span class="fu">possibly</span>(<span class="sc">~</span>psych<span class="sc">::</span><span class="fu">alpha</span>((.) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>SID, <span class="sc">-</span>date)), <span class="cn">NA_real_</span>)))</span>
<span id="cb108-35"><a href="cleaning.html#cb108-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-36"><a href="cleaning.html#cb108-36" aria-hidden="true" tabindex="-1"></a><span class="co"># create composites</span></span>
<span id="cb108-37"><a href="cleaning.html#cb108-37" aria-hidden="true" tabindex="-1"></a>adrc_pers <span class="ot">&lt;-</span> adrc_pers <span class="sc">%&gt;%</span></span>
<span id="cb108-38"><a href="cleaning.html#cb108-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name, date) <span class="sc">%&gt;%</span></span>
<span id="cb108-39"><a href="cleaning.html#cb108-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T))  <span class="sc">%&gt;%</span></span>
<span id="cb108-40"><a href="cleaning.html#cb108-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb108-41"><a href="cleaning.html#cb108-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(adrc_pers_waves)</span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="cleaning.html#cb109-1" aria-hidden="true" tabindex="-1"></a>adrc_pers</span></code></pre></div>
<pre><code>## # A tibble: 5,730 × 5
##      SID name  date       value p_year
##    &lt;dbl&gt; &lt;chr&gt; &lt;date&gt;     &lt;dbl&gt;  &lt;dbl&gt;
##  1  1070 A     2003-10-28  4.08   2003
##  2  1070 C     2003-10-28  4.83   2003
##  3  1070 E     2003-10-28  4.08   2003
##  4  1070 N     2003-10-28  1.08   2003
##  5  1070 O     2003-10-28  3.17   2003
##  6  1088 A     2005-04-18  4.5    2005
##  7  1088 C     2005-04-18  3.42   2005
##  8  1088 E     2005-04-18  3.08   2005
##  9  1088 N     2005-04-18  1.25   2005
## 10  1088 O     2005-04-18  3.08   2005
## # … with 5,720 more rows</code></pre>
</div>
<div id="outcome-variables-4" class="section level3 hasAnchor" number="2.5.5">
<h3><span class="header-section-number">2.5.5</span> Outcome Variables<a href="cleaning.html#outcome-variables-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="cleaning.html#cb111-1" aria-hidden="true" tabindex="-1"></a>adrc_out <span class="ot">&lt;-</span> adrc_recode <span class="sc">%&gt;%</span></span>
<span id="cb111-2"><a href="cleaning.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;outcome&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-3"><a href="cleaning.html#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb111-4"><a href="cleaning.html#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="cleaning.html#cb111-5" aria-hidden="true" tabindex="-1"></a>adrc_out_waves <span class="ot">&lt;-</span> adrc_out <span class="sc">%&gt;%</span></span>
<span id="cb111-6"><a href="cleaning.html#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb111-7"><a href="cleaning.html#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb111-8"><a href="cleaning.html#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">o_year =</span> <span class="fu">max</span>(year)) <span class="sc">%&gt;%</span> </span>
<span id="cb111-9"><a href="cleaning.html#cb111-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb111-10"><a href="cleaning.html#cb111-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-11"><a href="cleaning.html#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="co"># compositing within years</span></span>
<span id="cb111-12"><a href="cleaning.html#cb111-12" aria-hidden="true" tabindex="-1"></a>year_comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, rule){</span>
<span id="cb111-13"><a href="cleaning.html#cb111-13" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb111-14"><a href="cleaning.html#cb111-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># group by person and item (collapse across age)</span></span>
<span id="cb111-15"><a href="cleaning.html#cb111-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name, year, long_rule, p_year) <span class="sc">%&gt;%</span> </span>
<span id="cb111-16"><a href="cleaning.html#cb111-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb111-17"><a href="cleaning.html#cb111-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb111-18"><a href="cleaning.html#cb111-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value))</span>
<span id="cb111-19"><a href="cleaning.html#cb111-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-20"><a href="cleaning.html#cb111-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-21"><a href="cleaning.html#cb111-21" aria-hidden="true" tabindex="-1"></a>adrc_out <span class="ot">&lt;-</span> adrc_out <span class="sc">%&gt;%</span></span>
<span id="cb111-22"><a href="cleaning.html#cb111-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb111-23"><a href="cleaning.html#cb111-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comp_rule =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(comp_rule) <span class="sc">|</span> comp_rule <span class="sc">==</span> <span class="st">&quot;none&quot;</span>, <span class="st">&quot;skip&quot;</span>, comp_rule)) <span class="sc">%&gt;%</span></span>
<span id="cb111-24"><a href="cleaning.html#cb111-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(comp_rule) <span class="sc">%&gt;%</span></span>
<span id="cb111-25"><a href="cleaning.html#cb111-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb111-26"><a href="cleaning.html#cb111-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb111-27"><a href="cleaning.html#cb111-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, comp_rule, year_comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb111-28"><a href="cleaning.html#cb111-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb111-29"><a href="cleaning.html#cb111-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-30"><a href="cleaning.html#cb111-30" aria-hidden="true" tabindex="-1"></a>comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, rule){</span>
<span id="cb111-31"><a href="cleaning.html#cb111-31" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb111-32"><a href="cleaning.html#cb111-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb111-33"><a href="cleaning.html#cb111-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb111-34"><a href="cleaning.html#cb111-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb111-35"><a href="cleaning.html#cb111-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-36"><a href="cleaning.html#cb111-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-37"><a href="cleaning.html#cb111-37" aria-hidden="true" tabindex="-1"></a>adrc_out <span class="ot">&lt;-</span> adrc_out <span class="sc">%&gt;%</span></span>
<span id="cb111-38"><a href="cleaning.html#cb111-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb111-39"><a href="cleaning.html#cb111-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">ifelse</span>(year <span class="sc">&lt;=</span> p_year, <span class="st">&quot;past&quot;</span>, <span class="st">&quot;future&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb111-40"><a href="cleaning.html#cb111-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name, group, p_year) <span class="sc">%&gt;%</span></span>
<span id="cb111-41"><a href="cleaning.html#cb111-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb111-42"><a href="cleaning.html#cb111-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb111-43"><a href="cleaning.html#cb111-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb111-44"><a href="cleaning.html#cb111-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> group, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb111-45"><a href="cleaning.html#cb111-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb111-46"><a href="cleaning.html#cb111-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(past) <span class="sc">|</span> (past <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(future)), future,</span>
<span id="cb111-47"><a href="cleaning.html#cb111-47" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(past <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(future), past, </span>
<span id="cb111-48"><a href="cleaning.html#cb111-48" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(past <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb111-49"><a href="cleaning.html#cb111-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb111-50"><a href="cleaning.html#cb111-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(</span>
<span id="cb111-51"><a href="cleaning.html#cb111-51" aria-hidden="true" tabindex="-1"></a>    adrc_out <span class="sc">%&gt;%</span></span>
<span id="cb111-52"><a href="cleaning.html#cb111-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(name <span class="sc">!=</span> <span class="st">&quot;dementia&quot;</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(value) <span class="sc">&amp;</span> year <span class="sc">&gt;=</span> p_year) <span class="sc">%&gt;%</span> </span>
<span id="cb111-53"><a href="cleaning.html#cb111-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(long_rule, p_year) <span class="sc">%&gt;%</span></span>
<span id="cb111-54"><a href="cleaning.html#cb111-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb111-55"><a href="cleaning.html#cb111-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb111-56"><a href="cleaning.html#cb111-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, long_rule, comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb111-57"><a href="cleaning.html#cb111-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb111-58"><a href="cleaning.html#cb111-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb111-59"><a href="cleaning.html#cb111-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value))</span>
<span id="cb111-60"><a href="cleaning.html#cb111-60" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb111-61"><a href="cleaning.html#cb111-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(adrc_out_waves)</span></code></pre></div>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="cleaning.html#cb112-1" aria-hidden="true" tabindex="-1"></a>adrc_out</span></code></pre></div>
<pre><code>## # A tibble: 2,575 × 8
##      SID name     p_year future  past  `NA` value o_year
##    &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1  1070 dementia   2003      1     0    NA     1   2019
##  2  1088 dementia   2005      1     1    NA    NA   2015
##  3  1380 dementia   2003      1     0    NA     1   2013
##  4 10018 dementia   2005      0     0    NA     0   2018
##  5 10034 dementia   2004      0     0    NA     0   2020
##  6 10037 dementia   2006      1     0    NA     1   2019
##  7 10038 dementia   2003      1     0    NA     1   2016
##  8 10045 dementia   2003      1     1    NA    NA   2018
##  9 10054 dementia   2008      0     0    NA     0   2012
## 10 10064 dementia   2003      1     0    NA     1   2018
## # … with 2,565 more rows</code></pre>
</div>
<div id="cognition-variables-4" class="section level3 hasAnchor" number="2.5.6">
<h3><span class="header-section-number">2.5.6</span> Cognition Variables<a href="cleaning.html#cognition-variables-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="cleaning.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># composite within years</span></span>
<span id="cb114-2"><a href="cleaning.html#cb114-2" aria-hidden="true" tabindex="-1"></a>adrc_cog <span class="ot">&lt;-</span> adrc_recode <span class="sc">%&gt;%</span></span>
<span id="cb114-3"><a href="cleaning.html#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;cognition&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb114-4"><a href="cleaning.html#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>category) <span class="sc">%&gt;%</span></span>
<span id="cb114-5"><a href="cleaning.html#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb114-6"><a href="cleaning.html#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_year)) <span class="sc">%&gt;%</span></span>
<span id="cb114-7"><a href="cleaning.html#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb114-8"><a href="cleaning.html#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, itemname, year) <span class="sc">%&gt;%</span></span>
<span id="cb114-9"><a href="cleaning.html#cb114-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">pomp</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb114-10"><a href="cleaning.html#cb114-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name, itemname) <span class="sc">%&gt;%</span></span>
<span id="cb114-11"><a href="cleaning.html#cb114-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> (p_year <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">:</span>(p_year <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb114-12"><a href="cleaning.html#cb114-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, SID) <span class="sc">%&gt;%</span></span>
<span id="cb114-13"><a href="cleaning.html#cb114-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb114-14"><a href="cleaning.html#cb114-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb114-15"><a href="cleaning.html#cb114-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span></span>
<span id="cb114-16"><a href="cleaning.html#cb114-16" aria-hidden="true" tabindex="-1"></a>              , <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="cleaning.html#cb115-1" aria-hidden="true" tabindex="-1"></a>adrc_cog</span></code></pre></div>
<pre><code>## # A tibble: 1,023 × 2
##      SID cognition
##    &lt;dbl&gt;     &lt;dbl&gt;
##  1  1070      4.62
##  2  1088      3.40
##  3  1380      2.36
##  4 10018      5.59
##  5 10034      5.30
##  6 10037      4.64
##  7 10038      6.60
##  8 10045      8.52
##  9 10054      2.41
## 10 10064      7.36
## # … with 1,013 more rows</code></pre>
</div>
<div id="combine-data-4" class="section level3 hasAnchor" number="2.5.7">
<h3><span class="header-section-number">2.5.7</span> Combine Data<a href="cleaning.html#combine-data-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="cleaning.html#cb117-1" aria-hidden="true" tabindex="-1"></a>adrc_combined <span class="ot">&lt;-</span> adrc_pers <span class="sc">%&gt;%</span> </span>
<span id="cb117-2"><a href="cleaning.html#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SID, <span class="at">Trait =</span> name, <span class="at">p_value =</span> value, p_year) <span class="sc">%&gt;%</span></span>
<span id="cb117-3"><a href="cleaning.html#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(</span>
<span id="cb117-4"><a href="cleaning.html#cb117-4" aria-hidden="true" tabindex="-1"></a>    adrc_out <span class="sc">%&gt;%</span> </span>
<span id="cb117-5"><a href="cleaning.html#cb117-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(SID, o_year, <span class="at">Outcome =</span> name, <span class="at">o_value =</span> value)</span>
<span id="cb117-6"><a href="cleaning.html#cb117-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb117-7"><a href="cleaning.html#cb117-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(o_value) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(p_value)) <span class="sc">%&gt;%</span></span>
<span id="cb117-8"><a href="cleaning.html#cb117-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb117-9"><a href="cleaning.html#cb117-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(adrc_cov) <span class="sc">%&gt;%</span></span>
<span id="cb117-10"><a href="cleaning.html#cb117-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb117-11"><a href="cleaning.html#cb117-11" aria-hidden="true" tabindex="-1"></a>    adrc_out <span class="sc">%&gt;%</span></span>
<span id="cb117-12"><a href="cleaning.html#cb117-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb117-13"><a href="cleaning.html#cb117-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">rowSums</span>(<span class="fu">cbind</span>(future, past), <span class="at">na.rm =</span> T) <span class="sc">&gt;=</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb117-14"><a href="cleaning.html#cb117-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>future, <span class="sc">-</span>past) <span class="sc">%&gt;%</span></span>
<span id="cb117-15"><a href="cleaning.html#cb117-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb117-16"><a href="cleaning.html#cb117-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb117-17"><a href="cleaning.html#cb117-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(adrc_cog) <span class="sc">%&gt;%</span></span>
<span id="cb117-18"><a href="cleaning.html#cb117-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(adrc_out_waves <span class="sc">%&gt;%</span> <span class="fu">select</span>(SID, <span class="at">Outcome =</span> name, o_year))</span></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="cleaning.html#cb118-1" aria-hidden="true" tabindex="-1"></a>adrc_combined</span></code></pre></div>
<pre><code>## # A tibble: 11,145 × 23
##      SID Trait p_value p_year o_year Outcome    o_value gender yearB…¹ alcohol cancer diabe…² educa…³ heart…⁴ married  race smokes stroke weight
##    &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1  1070 A        4.08   2003   2019 dementia         1      0    1918       1      1       0      17       1       1     0      0      0    187
##  2  1070 C        4.83   2003   2019 dementia         1      0    1918       1      1       0      17       1       1     0      0      0    187
##  3  1070 E        4.08   2003   2019 dementia         1      0    1918       1      1       0      17       1       1     0      0      0    187
##  4  1070 N        1.08   2003   2019 dementia         1      0    1918       1      1       0      17       1       1     0      0      0    187
##  5  1070 O        3.17   2003   2019 dementia         1      0    1918       1      1       0      17       1       1     0      0      0    187
##  6  1088 A        4.5    2005   2015 angiopathy       0      0    1916       1      1       0      16       1       1     0      0      0    217
##  7  1088 A        4.5    2005   2015 arteriolo…       1      0    1916       1      1       0      16       1       1     0      0      0    217
##  8  1088 A        4.5    2005   2015 atheroscl…       2      0    1916       1      1       0      16       1       1     0      0      0    217
##  9  1088 A        4.5    2005   2015 braak            3      0    1916       1      1       0      16       1       1     0      0      0    217
## 10  1088 A        4.5    2005   2015 hipSclero…       0      0    1916       1      1       0      16       1       1     0      0      0    217
## # … with 11,135 more rows, 4 more variables: age &lt;dbl&gt;, `NA` &lt;dbl&gt;, dementia &lt;dbl&gt;, cognition &lt;dbl&gt;, and abbreviated variable names ¹​yearBrth,
## #   ²​diabetes, ³​education, ⁴​heartProb</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="cleaning.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(adrc_cov, adrc_alpha, adrc_pers, adrc_out, adrc_combined, adrc_cog,</span>
<span id="cb120-2"><a href="cleaning.html#cb120-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/adrc_cleaned.RData&quot;</span>, load_path))</span></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="cleaning.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span><span class="fu">ls</span>()[<span class="fu">grepl</span>(<span class="st">&quot;adrc&quot;</span>, <span class="fu">ls</span>())])</span></code></pre></div>
</div>
</div>
<div id="einstein-aging-study" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Einstein Aging Study<a href="cleaning.html#einstein-aging-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Einstein Aging Study (EAS) is an ongoing longitudinal study of the aging brain. The EAS began in 1980 and has enrolled more than 2,600 participants since then. Data are available through application at <a href="http://www.einstein.yu.edu/departments/neurology/clinical-research-program/eas/data-sharing.aspx" class="uri">http://www.einstein.yu.edu/departments/neurology/clinical-research-program/eas/data-sharing.aspx</a>.</p>
<p>Since 1993, the EAS has systematically recruited a representative aging sample in the Bronx, New York, As of 2017, 2,600 participants were enrolled in the study. As of 2010, approximately 200 of the enrolled participants had autopsy data. More information on the study can be found at <a href="http://www.einstein.yu.edu/departments/neurology/clinical-research-program/EAS/" class="uri">http://www.einstein.yu.edu/departments/neurology/clinical-research-program/EAS/</a>.</p>
<p>Sample sizes vary over time, with ranges across waves not publically available. However, we suspect approximately 2,000 participants to have basic personality and dementia diagnoses, with between 150 and 300 participants having full autopsy data collected after personality was introduced into the study. This yields 99% power to detect a zero-order correlation effect size of .10 and .24, respectively, two-tailed at alpha .05.</p>
<div id="load-data-4" class="section level3 hasAnchor" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> Load Data<a href="cleaning.html#load-data-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="cleaning.html#cb122-1" aria-hidden="true" tabindex="-1"></a>(eas_codebook <span class="ot">&lt;-</span> (codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(study <span class="sc">==</span> <span class="st">&quot;EAS&quot;</span>))<span class="sc">$</span>codebook[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>## # A tibble: 78 × 15
##    study dataset  category   name      itemname       year         orig_itemname description    scale rever…¹ recode  mini  maxi comp_…² long_…³
##    &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;        &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
##  1 EAS   behavior cognition  cognition waisBlkDsgn    longitudinal Blockraw      &quot;WAIS III: Bl… &quot;int… &lt;NA&gt;    ifels…    NA    NA sum     select 
##  2 EAS   behavior cognition  cognition trailmakingA   longitudinal Tr-A1         &quot;Other Workin… &quot;int… &lt;NA&gt;    ifels…    NA    NA sum     select 
##  3 EAS   behavior cognition  cognition trailmakingB   longitudinal Tr-B1         &quot;Other Workin… &quot;int… &lt;NA&gt;    ifels…    NA    NA sum     select 
##  4 EAS   behavior cognition  cognition digitSym       longitudinal Symraw        &quot;Digit Symbol&quot; &quot;int… &lt;NA&gt;    ifels…    NA    NA sum     select 
##  5 EAS   behavior cognition  cognition recall         longitudinal TotRecall     &quot;total Recall&quot; &quot;int… &lt;NA&gt;    ifels…    NA    NA sum     select 
##  6 EAS   behavior cognition  cognition SPN            longitudinal Spnraw        &quot;Digit Span?&quot;  &quot;int… &lt;NA&gt;    ifels…    NA    NA sum     select 
##  7 EAS   behavior cognition  cognition CAT            longitudinal CAT            &lt;NA&gt;          &quot;int… &lt;NA&gt;    ifels…    NA    NA sum     select 
##  8 EAS   behavior cognition  cognition FAS            longitudinal FAS            &lt;NA&gt;          &quot;int… &lt;NA&gt;    ifels…    NA    NA sum     select 
##  9 EAS   behavior covariates alcohol   alcoholPrev50  baseline     SAB262        &quot;What was the… &quot;1=N… no      ifels…    NA    NA max     max    
## 10 EAS   behavior covariates alcohol   alcoholPrev50p baseline     SAB263        &quot;What was the… &quot;1=N… no      ifels…    NA    NA max     max    
## # … with 68 more rows, and abbreviated variable names ¹​reverse_code, ²​comp_rule, ³​long_rule</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="cleaning.html#cb124-1" aria-hidden="true" tabindex="-1"></a>old.names1 <span class="ot">&lt;-</span> <span class="fu">unique</span>((eas_codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dataset <span class="sc">==</span> <span class="st">&quot;behavior&quot;</span>))<span class="sc">$</span>orig_itemname)</span>
<span id="cb124-2"><a href="cleaning.html#cb124-2" aria-hidden="true" tabindex="-1"></a>old.names2 <span class="ot">&lt;-</span> <span class="fu">unique</span>((eas_codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dataset <span class="sc">==</span> <span class="st">&quot;neuropath&quot;</span>))<span class="sc">$</span>orig_itemname)</span>
<span id="cb124-3"><a href="cleaning.html#cb124-3" aria-hidden="true" tabindex="-1"></a>old.names3 <span class="ot">&lt;-</span> <span class="fu">unique</span>((eas_codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(dataset <span class="sc">==</span> <span class="st">&quot;activity&quot;</span>))<span class="sc">$</span>orig_itemname)</span>
<span id="cb124-4"><a href="cleaning.html#cb124-4" aria-hidden="true" tabindex="-1"></a>eas <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/eas/Behavior_with_Master_Data_2021_10_25.xlsx&quot;</span>, data_path) <span class="sc">%&gt;%</span> </span>
<span id="cb124-5"><a href="cleaning.html#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_excel</span>(., <span class="at">sheet =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb124-6"><a href="cleaning.html#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(BehaviorDate)) <span class="sc">%&gt;%</span></span>
<span id="cb124-7"><a href="cleaning.html#cb124-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">SID =</span> Id, <span class="at">wave =</span> Wave, year, <span class="fu">one_of</span>(old.names1)) <span class="sc">%&gt;%</span></span>
<span id="cb124-8"><a href="cleaning.html#cb124-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(</span>
<span id="cb124-9"><a href="cleaning.html#cb124-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;%s/eas/Neuropath_and_Behavior_Data_2021_09_26 (3).xlsx&quot;</span>, data_path) <span class="sc">%&gt;%</span> </span>
<span id="cb124-10"><a href="cleaning.html#cb124-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">read_excel</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb124-11"><a href="cleaning.html#cb124-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="at">SID =</span> <span class="st">`</span><span class="at">Clin#</span><span class="st">`</span>, <span class="at">year =</span> DOD, <span class="at">wave =</span> Wave, <span class="fu">one_of</span>(old.names2)) <span class="sc">%&gt;%</span></span>
<span id="cb124-12"><a href="cleaning.html#cb124-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">comb_dx =</span> <span class="fu">ifelse</span>(<span class="fu">c</span>(<span class="st">&quot;VaD&quot;</span>, <span class="st">&quot;AD&quot;</span>, <span class="st">&quot;AGD&quot;</span>) <span class="sc">%in%</span> Dx1 <span class="sc">|</span> <span class="fu">c</span>(<span class="st">&quot;VaD&quot;</span>, <span class="st">&quot;AD&quot;</span>, <span class="st">&quot;AGD&quot;</span>) <span class="sc">%in%</span> Dx2 <span class="sc">|</span> </span>
<span id="cb124-13"><a href="cleaning.html#cb124-13" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">c</span>(<span class="st">&quot;VaD&quot;</span>, <span class="st">&quot;AD&quot;</span>, <span class="st">&quot;AGD&quot;</span>) <span class="sc">%in%</span> Dx3 <span class="sc">|</span> <span class="fu">grepl</span>(<span class="st">&quot;VaD&quot;</span>, <span class="st">`</span><span class="at">OTHER Dx</span><span class="st">`</span>) <span class="sc">|</span> </span>
<span id="cb124-14"><a href="cleaning.html#cb124-14" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">grepl</span>(<span class="st">&quot;AD&quot;</span>, <span class="st">`</span><span class="at">OTHER Dx</span><span class="st">`</span>) <span class="sc">|</span> <span class="fu">grepl</span>(<span class="st">&quot;AGD&quot;</span>, <span class="st">`</span><span class="at">OTHER Dx</span><span class="st">`</span>), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb124-15"><a href="cleaning.html#cb124-15" aria-hidden="true" tabindex="-1"></a>             , <span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(year)) <span class="sc">%&gt;%</span></span>
<span id="cb124-16"><a href="cleaning.html#cb124-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>(Dx1<span class="sc">:</span><span class="st">`</span><span class="at">OTHER Dx</span><span class="st">`</span>))</span>
<span id="cb124-17"><a href="cleaning.html#cb124-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb124-18"><a href="cleaning.html#cb124-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(</span>
<span id="cb124-19"><a href="cleaning.html#cb124-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">&quot;%s/eas/Northwestern_supp_Physical_Activities_2021_10_25-1.xlsx&quot;</span>, data_path) <span class="sc">%&gt;%</span> </span>
<span id="cb124-20"><a href="cleaning.html#cb124-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">read_excel</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb124-21"><a href="cleaning.html#cb124-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="at">SID =</span> Id, <span class="at">wave =</span> Wave, <span class="fu">one_of</span>(old.names3))</span>
<span id="cb124-22"><a href="cleaning.html#cb124-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb124-23"><a href="cleaning.html#cb124-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Gender =</span> <span class="fu">ifelse</span>(Gender <span class="sc">==</span> <span class="st">&quot;F&quot;</span>, <span class="dv">1</span>, <span class="fu">ifelse</span>(Gender <span class="sc">==</span> <span class="st">&quot;M&quot;</span>, <span class="dv">0</span>, <span class="cn">NA</span>)))</span>
<span id="cb124-24"><a href="cleaning.html#cb124-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-25"><a href="cleaning.html#cb124-25" aria-hidden="true" tabindex="-1"></a>eas_waves <span class="ot">&lt;-</span> eas <span class="sc">%&gt;%</span> <span class="fu">select</span>(SID, wave, year) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb124-26"><a href="cleaning.html#cb124-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-27"><a href="cleaning.html#cb124-27" aria-hidden="true" tabindex="-1"></a>eas_long <span class="ot">&lt;-</span> eas <span class="sc">%&gt;%</span></span>
<span id="cb124-28"><a href="cleaning.html#cb124-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">values_to =</span> <span class="st">&quot;value&quot;</span></span>
<span id="cb124-29"><a href="cleaning.html#cb124-29" aria-hidden="true" tabindex="-1"></a>               , <span class="at">names_to =</span> <span class="st">&quot;orig_itemname&quot;</span></span>
<span id="cb124-30"><a href="cleaning.html#cb124-30" aria-hidden="true" tabindex="-1"></a>               , <span class="at">cols =</span> <span class="fu">c</span>(<span class="sc">-</span>SID, <span class="sc">-</span>wave, <span class="sc">-</span>year))</span></code></pre></div>
</div>
<div id="recode-reverse-scoring-1" class="section level3 hasAnchor" number="2.6.2">
<h3><span class="header-section-number">2.6.2</span> Recode &amp; Reverse-Scoring<a href="cleaning.html#recode-reverse-scoring-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="cleaning.html#cb125-1" aria-hidden="true" tabindex="-1"></a>eas_recode <span class="ot">&lt;-</span> eas_codebook <span class="sc">%&gt;%</span></span>
<span id="cb125-2"><a href="cleaning.html#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span>  <span class="fu">c</span>(<span class="st">&quot;covariates&quot;</span>, <span class="st">&quot;outcome&quot;</span>, <span class="st">&quot;cognition&quot;</span>, <span class="st">&quot;pers&quot;</span>) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(orig_itemname)) <span class="sc">%&gt;%</span></span>
<span id="cb125-3"><a href="cleaning.html#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(category, name, itemname, orig_itemname, reverse_code<span class="sc">:</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb125-4"><a href="cleaning.html#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(eas_long) </span>
<span id="cb125-5"><a href="cleaning.html#cb125-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-6"><a href="cleaning.html#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="co"># recode </span></span>
<span id="cb125-7"><a href="cleaning.html#cb125-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-8"><a href="cleaning.html#cb125-8" aria-hidden="true" tabindex="-1"></a>recode_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(rule, y, year){</span>
<span id="cb125-9"><a href="cleaning.html#cb125-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(rule)</span>
<span id="cb125-10"><a href="cleaning.html#cb125-10" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y<span class="sc">$</span>value</span>
<span id="cb125-11"><a href="cleaning.html#cb125-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(rule)){y<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> rule))}</span>
<span id="cb125-12"><a href="cleaning.html#cb125-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb125-13"><a href="cleaning.html#cb125-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb125-14"><a href="cleaning.html#cb125-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-15"><a href="cleaning.html#cb125-15" aria-hidden="true" tabindex="-1"></a>eas_recode <span class="ot">&lt;-</span> eas_recode <span class="sc">%&gt;%</span></span>
<span id="cb125-16"><a href="cleaning.html#cb125-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(recode, year) <span class="sc">%&gt;%</span></span>
<span id="cb125-17"><a href="cleaning.html#cb125-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb125-18"><a href="cleaning.html#cb125-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb125-19"><a href="cleaning.html#cb125-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(recode, data, year), recode_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb125-20"><a href="cleaning.html#cb125-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb125-21"><a href="cleaning.html#cb125-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-22"><a href="cleaning.html#cb125-22" aria-hidden="true" tabindex="-1"></a><span class="co"># reverse code </span></span>
<span id="cb125-23"><a href="cleaning.html#cb125-23" aria-hidden="true" tabindex="-1"></a>eas_recode <span class="ot">&lt;-</span> eas_recode <span class="sc">%&gt;%</span></span>
<span id="cb125-24"><a href="cleaning.html#cb125-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(reverse_code <span class="sc">==</span> <span class="st">&quot;no&quot;</span> <span class="sc">|</span> <span class="fu">is.na</span>(reverse_code), value, </span>
<span id="cb125-25"><a href="cleaning.html#cb125-25" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">reverse.code</span>(<span class="sc">-</span><span class="dv">1</span>, value, <span class="at">mini =</span> mini, <span class="at">maxi =</span> maxi))) <span class="sc">%&gt;%</span></span>
<span id="cb125-26"><a href="cleaning.html#cb125-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category, name) <span class="sc">%&gt;%</span></span>
<span id="cb125-27"><a href="cleaning.html#cb125-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb125-28"><a href="cleaning.html#cb125-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb125-29"><a href="cleaning.html#cb125-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-30"><a href="cleaning.html#cb125-30" aria-hidden="true" tabindex="-1"></a>fun_call <span class="ot">&lt;-</span> <span class="cf">function</span>(x, rule){</span>
<span id="cb125-31"><a href="cleaning.html#cb125-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span>(rule,</span>
<span id="cb125-32"><a href="cleaning.html#cb125-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">average =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb125-33"><a href="cleaning.html#cb125-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">mode =</span> <span class="fu">Mode</span>(x)[<span class="dv">1</span>],</span>
<span id="cb125-34"><a href="cleaning.html#cb125-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">sum =</span> <span class="fu">sum</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb125-35"><a href="cleaning.html#cb125-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb125-36"><a href="cleaning.html#cb125-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">select =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb125-37"><a href="cleaning.html#cb125-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb125-38"><a href="cleaning.html#cb125-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">min =</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> T))</span>
<span id="cb125-39"><a href="cleaning.html#cb125-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb125-40"><a href="cleaning.html#cb125-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-41"><a href="cleaning.html#cb125-41" aria-hidden="true" tabindex="-1"></a>eas_p_waves <span class="ot">&lt;-</span> eas_recode <span class="sc">%&gt;%</span> </span>
<span id="cb125-42"><a href="cleaning.html#cb125-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;pers&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb125-43"><a href="cleaning.html#cb125-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb125-44"><a href="cleaning.html#cb125-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb125-45"><a href="cleaning.html#cb125-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID) <span class="sc">%&gt;%</span></span>
<span id="cb125-46"><a href="cleaning.html#cb125-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="fu">min</span>(year)) <span class="sc">%&gt;%</span></span>
<span id="cb125-47"><a href="cleaning.html#cb125-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb125-48"><a href="cleaning.html#cb125-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SID, <span class="at">p_year =</span> year) <span class="sc">%&gt;%</span></span>
<span id="cb125-49"><a href="cleaning.html#cb125-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code></pre></div>
</div>
<div id="covariates-5" class="section level3 hasAnchor" number="2.6.3">
<h3><span class="header-section-number">2.6.3</span> Covariates<a href="cleaning.html#covariates-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="cleaning.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compositing within years</span></span>
<span id="cb126-2"><a href="cleaning.html#cb126-2" aria-hidden="true" tabindex="-1"></a>year_comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, rule){</span>
<span id="cb126-3"><a href="cleaning.html#cb126-3" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb126-4"><a href="cleaning.html#cb126-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># group by person and item (collapse across age)</span></span>
<span id="cb126-5"><a href="cleaning.html#cb126-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name, year, p_year, long_rule) <span class="sc">%&gt;%</span> </span>
<span id="cb126-6"><a href="cleaning.html#cb126-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb126-7"><a href="cleaning.html#cb126-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb126-8"><a href="cleaning.html#cb126-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value))</span>
<span id="cb126-9"><a href="cleaning.html#cb126-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb126-10"><a href="cleaning.html#cb126-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-11"><a href="cleaning.html#cb126-11" aria-hidden="true" tabindex="-1"></a>eas_cov <span class="ot">&lt;-</span> eas_recode <span class="sc">%&gt;%</span></span>
<span id="cb126-12"><a href="cleaning.html#cb126-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;covariates&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-13"><a href="cleaning.html#cb126-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb126-14"><a href="cleaning.html#cb126-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(eas_p_waves) <span class="sc">%&gt;%</span></span>
<span id="cb126-15"><a href="cleaning.html#cb126-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;=</span> p_year) <span class="sc">%&gt;%</span></span>
<span id="cb126-16"><a href="cleaning.html#cb126-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comp_rule =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(comp_rule) <span class="sc">|</span> comp_rule <span class="sc">==</span> <span class="st">&quot;none&quot;</span>, <span class="st">&quot;skip&quot;</span>, comp_rule)) <span class="sc">%&gt;%</span></span>
<span id="cb126-17"><a href="cleaning.html#cb126-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(comp_rule) <span class="sc">%&gt;%</span></span>
<span id="cb126-18"><a href="cleaning.html#cb126-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb126-19"><a href="cleaning.html#cb126-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb126-20"><a href="cleaning.html#cb126-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, comp_rule, year_comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb126-21"><a href="cleaning.html#cb126-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb126-22"><a href="cleaning.html#cb126-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>comp_rule)</span>
<span id="cb126-23"><a href="cleaning.html#cb126-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-24"><a href="cleaning.html#cb126-24" aria-hidden="true" tabindex="-1"></a>comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(d, rule){</span>
<span id="cb126-25"><a href="cleaning.html#cb126-25" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb126-26"><a href="cleaning.html#cb126-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb126-27"><a href="cleaning.html#cb126-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb126-28"><a href="cleaning.html#cb126-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb126-29"><a href="cleaning.html#cb126-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb126-30"><a href="cleaning.html#cb126-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-31"><a href="cleaning.html#cb126-31" aria-hidden="true" tabindex="-1"></a>eas_cov <span class="ot">&lt;-</span> eas_cov <span class="sc">%&gt;%</span></span>
<span id="cb126-32"><a href="cleaning.html#cb126-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(name)) <span class="sc">%&gt;%</span></span>
<span id="cb126-33"><a href="cleaning.html#cb126-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb126-34"><a href="cleaning.html#cb126-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb126-35"><a href="cleaning.html#cb126-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb126-36"><a href="cleaning.html#cb126-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, long_rule, comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb126-37"><a href="cleaning.html#cb126-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span> </span>
<span id="cb126-38"><a href="cleaning.html#cb126-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb126-39"><a href="cleaning.html#cb126-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb126-40"><a href="cleaning.html#cb126-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> name, <span class="at">values_from =</span> value, <span class="at">values_fn =</span> <span class="fu">list</span>(<span class="at">value =</span> max)) <span class="sc">%&gt;%</span></span>
<span id="cb126-41"><a href="cleaning.html#cb126-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(eas_p_waves) </span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="cleaning.html#cb127-1" aria-hidden="true" tabindex="-1"></a>eas_cov</span></code></pre></div>
<pre><code>## # A tibble: 799 × 17
##      SID alcohol cancer diabetes heartProb hypertension married  race smokes stroke exercise   BMI   age education SRhealth gender p_year
##    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1  6075       0      0        0         0            0       1     0      0      0       NA  21.1  73.4        17        2      1   2016
##  2  8024       1      0        0         0            0       1     0      1      0       NA  28.8  94.8        10        2      0   2006
##  3  8027       1      0        0         0            0       1     0      0      0       NA  20.4  93.0        12        3      0   2009
##  4  8265       1      1        1         0            1       1     0      1      0       NA  28.5  77.3        12        3      0   2006
##  5  8291       0      0        0         0            0       1     0      0      0       NA  24    81.7        16        1      0   2009
##  6  8296       1      0        0         0            0       1     0      0      0       NA  23    88.9        14        1      0   2006
##  7  8310       1      0        1         0            0       1     0      1      0       NA  29.4  86.0        16        3      0   2007
##  8  8313       1      0        0         0            0       1     1      1      0       NA  NA    87.3        16        3      1   2007
##  9  8375       1      1        0         0           NA       1     0      0      0       NA  26.3  87.2        12        3      1   2006
## 10  8512       1      0        0         0            1       1     1      1      0       NA  NA    78.9        11        3      1   2010
## # … with 789 more rows</code></pre>
</div>
<div id="personality-variables-5" class="section level3 hasAnchor" number="2.6.4">
<h3><span class="header-section-number">2.6.4</span> Personality Variables<a href="cleaning.html#personality-variables-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="cleaning.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bring in codebook info</span></span>
<span id="cb129-2"><a href="cleaning.html#cb129-2" aria-hidden="true" tabindex="-1"></a>eas_pers <span class="ot">&lt;-</span> eas_recode <span class="sc">%&gt;%</span> </span>
<span id="cb129-3"><a href="cleaning.html#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;pers&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb129-4"><a href="cleaning.html#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb129-5"><a href="cleaning.html#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(eas_p_waves) <span class="sc">%&gt;%</span> </span>
<span id="cb129-6"><a href="cleaning.html#cb129-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> p_year)</span>
<span id="cb129-7"><a href="cleaning.html#cb129-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-8"><a href="cleaning.html#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="co"># create composites</span></span>
<span id="cb129-9"><a href="cleaning.html#cb129-9" aria-hidden="true" tabindex="-1"></a>eas_pers <span class="ot">&lt;-</span> eas_pers <span class="sc">%&gt;%</span></span>
<span id="cb129-10"><a href="cleaning.html#cb129-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name, p_year) <span class="sc">%&gt;%</span></span>
<span id="cb129-11"><a href="cleaning.html#cb129-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T))  <span class="sc">%&gt;%</span></span>
<span id="cb129-12"><a href="cleaning.html#cb129-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() </span></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="cleaning.html#cb130-1" aria-hidden="true" tabindex="-1"></a>eas_pers</span></code></pre></div>
<pre><code>## # A tibble: 3,995 × 4
##      SID name  p_year value
##    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1  6075 A       2016   3.6
##  2  6075 C       2016   3.4
##  3  6075 E       2016   2.5
##  4  6075 N       2016   2.8
##  5  6075 O       2016   3.1
##  6  8024 A       2006   3.7
##  7  8024 C       2006   4.1
##  8  8024 E       2006   2.7
##  9  8024 N       2006   2.7
## 10  8024 O       2006   2.9
## # … with 3,985 more rows</code></pre>
</div>
<div id="outcome-variables-5" class="section level3 hasAnchor" number="2.6.5">
<h3><span class="header-section-number">2.6.5</span> Outcome Variables<a href="cleaning.html#outcome-variables-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="cleaning.html#cb132-1" aria-hidden="true" tabindex="-1"></a>eas_out <span class="ot">&lt;-</span> eas_recode <span class="sc">%&gt;%</span></span>
<span id="cb132-2"><a href="cleaning.html#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;outcome&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-3"><a href="cleaning.html#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb132-4"><a href="cleaning.html#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="cleaning.html#cb132-5" aria-hidden="true" tabindex="-1"></a>eas_out_waves <span class="ot">&lt;-</span> eas_out <span class="sc">%&gt;%</span></span>
<span id="cb132-6"><a href="cleaning.html#cb132-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb132-7"><a href="cleaning.html#cb132-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb132-8"><a href="cleaning.html#cb132-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb132-9"><a href="cleaning.html#cb132-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">o_year =</span> <span class="fu">max</span>(year)) <span class="sc">%&gt;%</span> </span>
<span id="cb132-10"><a href="cleaning.html#cb132-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb132-11"><a href="cleaning.html#cb132-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-12"><a href="cleaning.html#cb132-12" aria-hidden="true" tabindex="-1"></a><span class="co"># compositing within years</span></span>
<span id="cb132-13"><a href="cleaning.html#cb132-13" aria-hidden="true" tabindex="-1"></a>year_comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, rule){</span>
<span id="cb132-14"><a href="cleaning.html#cb132-14" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb132-15"><a href="cleaning.html#cb132-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># group by person and item (collapse across age)</span></span>
<span id="cb132-16"><a href="cleaning.html#cb132-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name, year, long_rule, p_year) <span class="sc">%&gt;%</span> </span>
<span id="cb132-17"><a href="cleaning.html#cb132-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb132-18"><a href="cleaning.html#cb132-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb132-19"><a href="cleaning.html#cb132-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value))</span>
<span id="cb132-20"><a href="cleaning.html#cb132-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb132-21"><a href="cleaning.html#cb132-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-22"><a href="cleaning.html#cb132-22" aria-hidden="true" tabindex="-1"></a>eas_out <span class="ot">&lt;-</span> eas_out <span class="sc">%&gt;%</span></span>
<span id="cb132-23"><a href="cleaning.html#cb132-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(eas_p_waves) <span class="sc">%&gt;%</span></span>
<span id="cb132-24"><a href="cleaning.html#cb132-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb132-25"><a href="cleaning.html#cb132-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comp_rule =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(comp_rule) <span class="sc">|</span> comp_rule <span class="sc">==</span> <span class="st">&quot;none&quot;</span>, <span class="st">&quot;skip&quot;</span>, comp_rule)) <span class="sc">%&gt;%</span></span>
<span id="cb132-26"><a href="cleaning.html#cb132-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(comp_rule) <span class="sc">%&gt;%</span></span>
<span id="cb132-27"><a href="cleaning.html#cb132-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb132-28"><a href="cleaning.html#cb132-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb132-29"><a href="cleaning.html#cb132-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, comp_rule, year_comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb132-30"><a href="cleaning.html#cb132-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb132-31"><a href="cleaning.html#cb132-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-32"><a href="cleaning.html#cb132-32" aria-hidden="true" tabindex="-1"></a>eas_out <span class="ot">&lt;-</span> eas_out <span class="sc">%&gt;%</span></span>
<span id="cb132-33"><a href="cleaning.html#cb132-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-34"><a href="cleaning.html#cb132-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">ifelse</span>(year <span class="sc">&lt;=</span> p_year, <span class="st">&quot;past&quot;</span>, <span class="st">&quot;future&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb132-35"><a href="cleaning.html#cb132-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name, group, p_year) <span class="sc">%&gt;%</span></span>
<span id="cb132-36"><a href="cleaning.html#cb132-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb132-37"><a href="cleaning.html#cb132-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb132-38"><a href="cleaning.html#cb132-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb132-39"><a href="cleaning.html#cb132-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> group, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb132-40"><a href="cleaning.html#cb132-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb132-41"><a href="cleaning.html#cb132-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(past) <span class="sc">|</span> (past <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(future)), future,</span>
<span id="cb132-42"><a href="cleaning.html#cb132-42" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(past <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(future), past, </span>
<span id="cb132-43"><a href="cleaning.html#cb132-43" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(past <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb132-44"><a href="cleaning.html#cb132-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb132-45"><a href="cleaning.html#cb132-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(eas_out <span class="sc">%&gt;%</span></span>
<span id="cb132-46"><a href="cleaning.html#cb132-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(name <span class="sc">!=</span> <span class="st">&quot;dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-47"><a href="cleaning.html#cb132-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name, long_rule, p_year) <span class="sc">%&gt;%</span></span>
<span id="cb132-48"><a href="cleaning.html#cb132-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb132-49"><a href="cleaning.html#cb132-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb132-50"><a href="cleaning.html#cb132-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb132-51"><a href="cleaning.html#cb132-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value))</span>
<span id="cb132-52"><a href="cleaning.html#cb132-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb132-53"><a href="cleaning.html#cb132-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(eas_out_waves) <span class="sc">%&gt;%</span></span>
<span id="cb132-54"><a href="cleaning.html#cb132-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value))</span></code></pre></div>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="cleaning.html#cb133-1" aria-hidden="true" tabindex="-1"></a>eas_out</span></code></pre></div>
<pre><code>## # A tibble: 878 × 8
##      SID name     p_year  past future  `NA` value o_year
##    &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1  8024 dementia   2006     0     NA    NA     0   2006
##  2  8027 dementia   2009     0      1    NA     1   2017
##  3  8265 dementia   2006     0      0    NA     0   2011
##  4  8291 dementia   2009     0      0    NA     0   2012
##  5  8296 dementia   2006     0     NA    NA     0   2006
##  6  8310 dementia   2007     0     NA    NA     0   2007
##  7  8313 dementia   2007     0     NA    NA     0   2007
##  8  8375 dementia   2006     0      0    NA     0   2010
##  9  8512 dementia   2010     0      0    NA     0   2013
## 10  8518 dementia   2011     0     NA    NA     0   2011
## # … with 868 more rows</code></pre>
</div>
<div id="cognition-variables-5" class="section level3 hasAnchor" number="2.6.6">
<h3><span class="header-section-number">2.6.6</span> Cognition Variables<a href="cleaning.html#cognition-variables-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="cleaning.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># composite within years</span></span>
<span id="cb135-2"><a href="cleaning.html#cb135-2" aria-hidden="true" tabindex="-1"></a>eas_cog <span class="ot">&lt;-</span> eas_recode <span class="sc">%&gt;%</span></span>
<span id="cb135-3"><a href="cleaning.html#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;cognition&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb135-4"><a href="cleaning.html#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>category) <span class="sc">%&gt;%</span></span>
<span id="cb135-5"><a href="cleaning.html#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb135-6"><a href="cleaning.html#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(eas_p_waves) <span class="sc">%&gt;%</span></span>
<span id="cb135-7"><a href="cleaning.html#cb135-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_year) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb135-8"><a href="cleaning.html#cb135-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, itemname, year) <span class="sc">%&gt;%</span></span>
<span id="cb135-9"><a href="cleaning.html#cb135-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">pomp</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb135-10"><a href="cleaning.html#cb135-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name, itemname) <span class="sc">%&gt;%</span></span>
<span id="cb135-11"><a href="cleaning.html#cb135-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> (p_year <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">:</span>(p_year <span class="sc">+</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb135-12"><a href="cleaning.html#cb135-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, SID) <span class="sc">%&gt;%</span></span>
<span id="cb135-13"><a href="cleaning.html#cb135-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb135-14"><a href="cleaning.html#cb135-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb135-15"><a href="cleaning.html#cb135-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span></span>
<span id="cb135-16"><a href="cleaning.html#cb135-16" aria-hidden="true" tabindex="-1"></a>              , <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="cleaning.html#cb136-1" aria-hidden="true" tabindex="-1"></a>eas_cog</span></code></pre></div>
<pre><code>## # A tibble: 799 × 2
##      SID cognition
##    &lt;dbl&gt;     &lt;dbl&gt;
##  1  6075      5.78
##  2  8024      4.83
##  3  8027      4.55
##  4  8265      5.60
##  5  8291      4.64
##  6  8296      5.20
##  7  8310      4.16
##  8  8313      4.37
##  9  8375      6.10
## 10  8512      3.62
## # … with 789 more rows</code></pre>
</div>
<div id="combine-data-5" class="section level3 hasAnchor" number="2.6.7">
<h3><span class="header-section-number">2.6.7</span> Combine Data<a href="cleaning.html#combine-data-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="cleaning.html#cb138-1" aria-hidden="true" tabindex="-1"></a>eas_combined <span class="ot">&lt;-</span> eas_pers <span class="sc">%&gt;%</span> </span>
<span id="cb138-2"><a href="cleaning.html#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SID, <span class="at">Trait =</span> name, <span class="at">p_value =</span> value, p_year) <span class="sc">%&gt;%</span></span>
<span id="cb138-3"><a href="cleaning.html#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(</span>
<span id="cb138-4"><a href="cleaning.html#cb138-4" aria-hidden="true" tabindex="-1"></a>    eas_out <span class="sc">%&gt;%</span> </span>
<span id="cb138-5"><a href="cleaning.html#cb138-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(SID, o_year, <span class="at">Outcome =</span> name, <span class="at">o_value =</span> value)</span>
<span id="cb138-6"><a href="cleaning.html#cb138-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb138-7"><a href="cleaning.html#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(o_value) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(p_value)) <span class="sc">%&gt;%</span></span>
<span id="cb138-8"><a href="cleaning.html#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb138-9"><a href="cleaning.html#cb138-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb138-10"><a href="cleaning.html#cb138-10" aria-hidden="true" tabindex="-1"></a>    eas_out <span class="sc">%&gt;%</span></span>
<span id="cb138-11"><a href="cleaning.html#cb138-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-12"><a href="cleaning.html#cb138-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">rowSums</span>(<span class="fu">cbind</span>(future, past), <span class="at">na.rm =</span> T) <span class="sc">&gt;=</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb138-13"><a href="cleaning.html#cb138-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>future, <span class="sc">-</span>past) <span class="sc">%&gt;%</span></span>
<span id="cb138-14"><a href="cleaning.html#cb138-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb138-15"><a href="cleaning.html#cb138-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb138-16"><a href="cleaning.html#cb138-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(eas_cov) <span class="sc">%&gt;%</span></span>
<span id="cb138-17"><a href="cleaning.html#cb138-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(eas_cog) </span></code></pre></div>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="cleaning.html#cb139-1" aria-hidden="true" tabindex="-1"></a>eas_combined</span></code></pre></div>
<pre><code>## # A tibble: 4,320 × 25
##      SID Trait p_value p_year o_year Outcome    o_value  `NA` demen…¹ alcohol cancer diabe…² heart…³ hyper…⁴ married  race smokes stroke exerc…⁵
##    &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1  8024 A         3.7   2006   2006 dementia       0      NA       0       1      0       0       0       0       1     0      1      0      NA
##  2  8024 C         4.1   2006   2006 dementia       0      NA       0       1      0       0       0       0       1     0      1      0      NA
##  3  8024 E         2.7   2006   2006 dementia       0      NA       0       1      0       0       0       0       1     0      1      0      NA
##  4  8024 N         2.7   2006   2006 dementia       0      NA       0       1      0       0       0       0       1     0      1      0      NA
##  5  8024 O         2.9   2006   2006 dementia       0      NA       0       1      0       0       0       0       1     0      1      0      NA
##  6  8027 A         3.2   2009   2017 dementia       1      NA       1       1      0       0       0       0       1     0      0      0      NA
##  7  8027 A         3.2   2009   2017 braak          5.5    NA       1       1      0       0       0       0       1     0      0      0      NA
##  8  8027 A         3.2   2009   2017 hipSclero…     0      NA       1       1      0       0       0       0       1     0      0      0      NA
##  9  8027 A         3.2   2009   2017 lewyBodyD…     1      NA       1       1      0       0       0       0       1     0      0      0      NA
## 10  8027 C         3.4   2009   2017 dementia       1      NA       1       1      0       0       0       0       1     0      0      0      NA
## # … with 4,310 more rows, 6 more variables: BMI &lt;dbl&gt;, age &lt;dbl&gt;, education &lt;dbl&gt;, SRhealth &lt;dbl&gt;, gender &lt;dbl&gt;, cognition &lt;dbl&gt;, and
## #   abbreviated variable names ¹​dementia, ²​diabetes, ³​heartProb, ⁴​hypertension, ⁵​exercise</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="cleaning.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(eas_cov, eas_pers, eas_out, eas_combined, eas_cog,</span>
<span id="cb141-2"><a href="cleaning.html#cb141-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/eas_cleaned.RData&quot;</span>, load_path))</span></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="cleaning.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span><span class="fu">ls</span>()[<span class="fu">grepl</span>(<span class="st">&quot;eas&quot;</span>, <span class="fu">ls</span>())])</span></code></pre></div>
</div>
</div>
<div id="german-socioeconomic-panel-study-gsoep" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> German Socioeconomic Panel Study (GSOEP)<a href="cleaning.html#german-socioeconomic-panel-study-gsoep" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The German Socioeconomic Panel Study (GSOEP; Socio-Economic Panel, 2017) is an ongoing longitudinal study of German collected by the German Institute of Economic Research (DIW Berlin). The data are freely available at <a href="https://www.diw.de/soep" class="uri">https://www.diw.de/soep</a> by application.</p>
<p>Data have been collected annually since 1984 (the latest data release includes data up to 2017). Participants have been recruited from more than 11,000 households, which are nationally representative of private German households. 20,000 individuals are sampled each year, on average. It is critical to note that the GSOEP samples households, not individuals, and the households consist of individuals living in both the “old” and “new” federal states (the former West and East Germany), foreigners, and recent immigrants to Germany.</p>
<p>Sample size varies by year, ranging from approximately 10,000 (1989) to 31,000 (2013). This provides 99% power to detect a zero-order correlation effect size of ~.06, two-tailed at alpha &lt; .05.</p>
<div id="load-data-5" class="section level3 hasAnchor" number="2.7.1">
<h3><span class="header-section-number">2.7.1</span> Load Data<a href="cleaning.html#load-data-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="cleaning.html#cb143-1" aria-hidden="true" tabindex="-1"></a>gsoep_read_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(Year, WL){</span>
<span id="cb143-2"><a href="cleaning.html#cb143-2" aria-hidden="true" tabindex="-1"></a>  old.names <span class="ot">&lt;-</span> (gsoep_codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> Year <span class="sc">|</span> category <span class="sc">==</span> <span class="st">&quot;proc&quot;</span>))<span class="sc">$</span>orig_itemname </span>
<span id="cb143-3"><a href="cleaning.html#cb143-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/gsoep/%sp.sav&quot;</span>, data_path, WL) <span class="sc">%&gt;%</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb143-4"><a href="cleaning.html#cb143-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/gsoep/%skind.sav&quot;</span>, data_path, WL) <span class="sc">%&gt;%</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb143-5"><a href="cleaning.html#cb143-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/gsoep/%spequiv.sav&quot;</span>, data_path, WL) <span class="sc">%&gt;%</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb143-6"><a href="cleaning.html#cb143-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/gsoep/%spgen.sav&quot;</span>, data_path, WL) <span class="sc">%&gt;%</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb143-7"><a href="cleaning.html#cb143-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/gsoep/%spkal.sav&quot;</span>, data_path, WL) <span class="sc">%&gt;%</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb143-8"><a href="cleaning.html#cb143-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">one_of</span>(old.names)) <span class="sc">%&gt;%</span></span>
<span id="cb143-9"><a href="cleaning.html#cb143-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> orig_itemname, <span class="at">value =</span> value, <span class="sc">-</span>persnr, <span class="sc">-</span>hhnr, <span class="at">na.rm =</span> T)</span>
<span id="cb143-10"><a href="cleaning.html#cb143-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-11"><a href="cleaning.html#cb143-11" aria-hidden="true" tabindex="-1"></a> <span class="fu">sprintf</span>(<span class="st">&quot;%s/gsoep/%shbrutto.sav&quot;</span>, data_path, WL) <span class="sc">%&gt;%</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb143-12"><a href="cleaning.html#cb143-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/gsoep/%sh.sav&quot;</span>, data_path, WL) <span class="sc">%&gt;%</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb143-13"><a href="cleaning.html#cb143-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">one_of</span>(old.names)) <span class="sc">%&gt;%</span></span>
<span id="cb143-14"><a href="cleaning.html#cb143-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> orig_itemname, <span class="at">value =</span> value, <span class="sc">-</span>hhnr, <span class="at">na.rm =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb143-15"><a href="cleaning.html#cb143-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(p <span class="sc">%&gt;%</span> <span class="fu">select</span>(persnr, hhnr) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb143-16"><a href="cleaning.html#cb143-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">full_join</span>(p) </span>
<span id="cb143-17"><a href="cleaning.html#cb143-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="cleaning.html#cb144-1" aria-hidden="true" tabindex="-1"></a>gsoep_codebook <span class="ot">&lt;-</span> (codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(study <span class="sc">==</span> <span class="st">&quot;GSOEP&quot;</span>))<span class="sc">$</span>codebook[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb144-2"><a href="cleaning.html#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">orig_itemname =</span> <span class="fu">str_to_lower</span>(orig_itemname))</span>
<span id="cb144-3"><a href="cleaning.html#cb144-3" aria-hidden="true" tabindex="-1"></a>gsoep_codebook</span></code></pre></div>
<pre><code>## # A tibble: 594 × 17
##    study dataset category  name      itemname  wave waveletter  year orig_itemname description  scale rever…¹ recode  mini  maxi comp_…² long_…³
##    &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
##  1 gosep cognit  cognition cognition animals1    23 w           2006 f99z30r       Symbol Digi… inte… no      ifels…    NA    NA sum     select 
##  2 gosep cognit  cognition cognition animals1    29 bc          2012 f99z30r       Symbol Digi… inte… no      ifels…    NA    NA sum     select 
##  3 gosep cognit  cognition cognition animals2    23 w           2006 f99z60r       Symbol Digi… inte… no      ifels…    NA    NA sum     select 
##  4 gosep cognit  cognition cognition animals2    29 bc          2012 f99z60r       Symbol Digi… inte… no      ifels…    NA    NA sum     select 
##  5 gosep cognit  cognition cognition animals3    23 w           2006 f99z90r       Symbol Digi… inte… no      ifels…    NA    NA sum     select 
##  6 gosep cognit  cognition cognition animals3    29 bc          2012 f99z90r       Symbol Digi… inte… no      ifels…    NA    NA sum     select 
##  7 gosep cognit  cognition cognition symDig1     23 w           2006 f96t30g       Symbol Digi… inte… no      ifels…    NA    NA sum     select 
##  8 gosep cognit  cognition cognition symDig1     29 bc          2012 f96t30g       Symbol Digi… inte… no      ifels…    NA    NA sum     select 
##  9 gosep cognit  cognition cognition symDig2     23 w           2006 f96t60g       Symbol Digi… inte… no      ifels…    NA    NA sum     select 
## 10 gosep cognit  cognition cognition symDig2     29 bc          2012 f96t60g       Symbol Digi… inte… no      ifels…    NA    NA sum     select 
## # … with 584 more rows, and abbreviated variable names ¹​reverse_code, ²​comp_rule, ³​long_rule</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="cleaning.html#cb146-1" aria-hidden="true" tabindex="-1"></a>gsoep <span class="ot">&lt;-</span> gsoep_codebook <span class="sc">%&gt;%</span> </span>
<span id="cb146-2"><a href="cleaning.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(wave, waveletter, year) <span class="sc">%&gt;%</span></span>
<span id="cb146-3"><a href="cleaning.html#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(.)) <span class="sc">%&gt;%</span></span>
<span id="cb146-4"><a href="cleaning.html#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb146-5"><a href="cleaning.html#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb146-6"><a href="cleaning.html#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">!=</span> <span class="st">&quot;2018&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb146-7"><a href="cleaning.html#cb146-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(year, waveletter, gsoep_read_fun)) </span>
<span id="cb146-8"><a href="cleaning.html#cb146-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-9"><a href="cleaning.html#cb146-9" aria-hidden="true" tabindex="-1"></a>old.names <span class="ot">&lt;-</span> <span class="fu">unique</span>(gsoep_codebook<span class="sc">$</span>orig_itemname)</span>
<span id="cb146-10"><a href="cleaning.html#cb146-10" aria-hidden="true" tabindex="-1"></a>gsoep_cog <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/gsoep/cognit.sav&quot;</span>, data_path) <span class="sc">%&gt;%</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb146-11"><a href="cleaning.html#cb146-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(persnr, hhnr, <span class="fu">one_of</span>(old.names)) <span class="sc">%&gt;%</span></span>
<span id="cb146-12"><a href="cleaning.html#cb146-12" aria-hidden="true" tabindex="-1"></a>  haven<span class="sc">::</span><span class="fu">zap_labels</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb146-13"><a href="cleaning.html#cb146-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>hhnr) <span class="sc">%&gt;%</span></span>
<span id="cb146-14"><a href="cleaning.html#cb146-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> orig_itemname, <span class="at">value =</span> value, <span class="sc">-</span>persnr, <span class="at">na.rm =</span> T)</span>
<span id="cb146-15"><a href="cleaning.html#cb146-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-16"><a href="cleaning.html#cb146-16" aria-hidden="true" tabindex="-1"></a>gsoep_long <span class="ot">&lt;-</span> gsoep <span class="sc">%&gt;%</span> <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb146-17"><a href="cleaning.html#cb146-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>hhnr, <span class="sc">-</span>wave, <span class="sc">-</span>waveletter, <span class="sc">-</span>year) <span class="sc">%&gt;%</span></span>
<span id="cb146-18"><a href="cleaning.html#cb146-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(persnr %in% gsoep_cog_subs) %&gt;%</span></span>
<span id="cb146-19"><a href="cleaning.html#cb146-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(gsoep_cog) <span class="sc">%&gt;%</span></span>
<span id="cb146-20"><a href="cleaning.html#cb146-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">SID =</span> persnr)</span>
<span id="cb146-21"><a href="cleaning.html#cb146-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-22"><a href="cleaning.html#cb146-22" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(gsoep, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/gsoep_raw.RData&quot;</span>, load_path))</span>
<span id="cb146-23"><a href="cleaning.html#cb146-23" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(gsoep)</span></code></pre></div>
</div>
<div id="recoding-reverse-scoring-4" class="section level3 hasAnchor" number="2.7.2">
<h3><span class="header-section-number">2.7.2</span> Recoding &amp; Reverse Scoring<a href="cleaning.html#recoding-reverse-scoring-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="cleaning.html#cb147-1" aria-hidden="true" tabindex="-1"></a>gsoep_waves <span class="ot">&lt;-</span> p_waves <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Study <span class="sc">==</span> <span class="st">&quot;GSOEP&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Used) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb147-2"><a href="cleaning.html#cb147-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-3"><a href="cleaning.html#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="co"># join data with recoding info </span></span>
<span id="cb147-4"><a href="cleaning.html#cb147-4" aria-hidden="true" tabindex="-1"></a>gsoep_recode <span class="ot">&lt;-</span> gsoep_codebook <span class="sc">%&gt;%</span></span>
<span id="cb147-5"><a href="cleaning.html#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;pers&quot;</span>, <span class="st">&quot;outcome&quot;</span>, <span class="st">&quot;covariates&quot;</span>, <span class="st">&quot;cognition&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb147-6"><a href="cleaning.html#cb147-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(category, name, itemname, wave, year, orig_itemname, reverse_code<span class="sc">:</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb147-7"><a href="cleaning.html#cb147-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category, name) <span class="sc">%&gt;%</span> </span>
<span id="cb147-8"><a href="cleaning.html#cb147-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb147-9"><a href="cleaning.html#cb147-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb147-10"><a href="cleaning.html#cb147-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(gsoep_long))) </span>
<span id="cb147-11"><a href="cleaning.html#cb147-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-12"><a href="cleaning.html#cb147-12" aria-hidden="true" tabindex="-1"></a><span class="co"># recode </span></span>
<span id="cb147-13"><a href="cleaning.html#cb147-13" aria-hidden="true" tabindex="-1"></a>recode_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(rule, y, year){</span>
<span id="cb147-14"><a href="cleaning.html#cb147-14" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y<span class="sc">$</span>value</span>
<span id="cb147-15"><a href="cleaning.html#cb147-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(rule)){y<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> rule))}</span>
<span id="cb147-16"><a href="cleaning.html#cb147-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb147-17"><a href="cleaning.html#cb147-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb147-18"><a href="cleaning.html#cb147-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-19"><a href="cleaning.html#cb147-19" aria-hidden="true" tabindex="-1"></a>gsoep_recode <span class="ot">&lt;-</span> gsoep_recode <span class="sc">%&gt;%</span> </span>
<span id="cb147-20"><a href="cleaning.html#cb147-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb147-21"><a href="cleaning.html#cb147-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(recode, year) <span class="sc">%&gt;%</span></span>
<span id="cb147-22"><a href="cleaning.html#cb147-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb147-23"><a href="cleaning.html#cb147-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb147-24"><a href="cleaning.html#cb147-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(recode, data, year), recode_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb147-25"><a href="cleaning.html#cb147-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb147-26"><a href="cleaning.html#cb147-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(value <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.nan</span>(value) <span class="sc">|</span> <span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value))))</span>
<span id="cb147-27"><a href="cleaning.html#cb147-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-28"><a href="cleaning.html#cb147-28" aria-hidden="true" tabindex="-1"></a><span class="co"># reverse code </span></span>
<span id="cb147-29"><a href="cleaning.html#cb147-29" aria-hidden="true" tabindex="-1"></a>gsoep_recode <span class="ot">&lt;-</span> gsoep_recode <span class="sc">%&gt;%</span></span>
<span id="cb147-30"><a href="cleaning.html#cb147-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb147-31"><a href="cleaning.html#cb147-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(reverse_code <span class="sc">==</span> <span class="st">&quot;no&quot;</span> <span class="sc">|</span> <span class="fu">is.na</span>(reverse_code), value, </span>
<span id="cb147-32"><a href="cleaning.html#cb147-32" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">reverse.code</span>(<span class="sc">-</span><span class="dv">1</span>, value, <span class="at">mini =</span> mini, <span class="at">maxi =</span> maxi)))))</span>
<span id="cb147-33"><a href="cleaning.html#cb147-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-34"><a href="cleaning.html#cb147-34" aria-hidden="true" tabindex="-1"></a>fun_call <span class="ot">&lt;-</span> <span class="cf">function</span>(x, rule){</span>
<span id="cb147-35"><a href="cleaning.html#cb147-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span>(rule,</span>
<span id="cb147-36"><a href="cleaning.html#cb147-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">average =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb147-37"><a href="cleaning.html#cb147-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">mode =</span> <span class="fu">Mode</span>(x)[<span class="dv">1</span>],</span>
<span id="cb147-38"><a href="cleaning.html#cb147-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">sum =</span> <span class="fu">sum</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb147-39"><a href="cleaning.html#cb147-39" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb147-40"><a href="cleaning.html#cb147-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">select =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb147-41"><a href="cleaning.html#cb147-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb147-42"><a href="cleaning.html#cb147-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">min =</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> T))</span>
<span id="cb147-43"><a href="cleaning.html#cb147-43" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div id="covariates-6" class="section level3 hasAnchor" number="2.7.3">
<h3><span class="header-section-number">2.7.3</span> Covariates<a href="cleaning.html#covariates-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="cleaning.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/gsoep_cleaned.RData&quot;</span>, local_path))</span></code></pre></div>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="cleaning.html#cb149-1" aria-hidden="true" tabindex="-1"></a>yrBrth <span class="ot">&lt;-</span> gsoep_recode <span class="sc">%&gt;%</span> </span>
<span id="cb149-2"><a href="cleaning.html#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;yearBrth&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb149-3"><a href="cleaning.html#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb149-4"><a href="cleaning.html#cb149-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID) <span class="sc">%&gt;%</span> </span>
<span id="cb149-5"><a href="cleaning.html#cb149-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">yearBrth =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb149-6"><a href="cleaning.html#cb149-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb149-7"><a href="cleaning.html#cb149-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yearBrth =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(yearBrth), <span class="cn">NA</span>, yearBrth),</span>
<span id="cb149-8"><a href="cleaning.html#cb149-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">yearBrth =</span> <span class="fu">ifelse</span>(yearBrth <span class="sc">&lt;</span> <span class="dv">1000</span>, yearBrth <span class="sc">+</span> <span class="dv">1000</span>, yearBrth)) </span>
<span id="cb149-9"><a href="cleaning.html#cb149-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-10"><a href="cleaning.html#cb149-10" aria-hidden="true" tabindex="-1"></a><span class="co"># compositing within years</span></span>
<span id="cb149-11"><a href="cleaning.html#cb149-11" aria-hidden="true" tabindex="-1"></a>year_comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, rule, name){</span>
<span id="cb149-12"><a href="cleaning.html#cb149-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(rule, name))</span>
<span id="cb149-13"><a href="cleaning.html#cb149-13" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb149-14"><a href="cleaning.html#cb149-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, yearBrth, year, long_rule) <span class="sc">%&gt;%</span> <span class="co"># group by person and item (collapse across age)</span></span>
<span id="cb149-15"><a href="cleaning.html#cb149-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb149-16"><a href="cleaning.html#cb149-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb149-17"><a href="cleaning.html#cb149-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb149-18"><a href="cleaning.html#cb149-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-19"><a href="cleaning.html#cb149-19" aria-hidden="true" tabindex="-1"></a>gsoep_waves <span class="ot">&lt;-</span> p_waves <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Study <span class="sc">==</span> <span class="st">&quot;GSOEP&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Used) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb149-20"><a href="cleaning.html#cb149-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-21"><a href="cleaning.html#cb149-21" aria-hidden="true" tabindex="-1"></a>gsoep_cov <span class="ot">&lt;-</span> gsoep_recode <span class="sc">%&gt;%</span></span>
<span id="cb149-22"><a href="cleaning.html#cb149-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;covariates&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb149-23"><a href="cleaning.html#cb149-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">&quot;alcohol&quot;</span>, <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">ifelse</span>(year <span class="sc">==</span> <span class="dv">2006</span>, <span class="dv">2005</span>, year))), data)) <span class="sc">%&gt;%</span></span>
<span id="cb149-24"><a href="cleaning.html#cb149-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb149-25"><a href="cleaning.html#cb149-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(yrBrth) <span class="sc">%&gt;%</span></span>
<span id="cb149-26"><a href="cleaning.html#cb149-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">&lt;=</span> <span class="fu">max</span>(gsoep_waves<span class="sc">$</span>Used) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb149-27"><a href="cleaning.html#cb149-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(comp_rule) <span class="sc">%&gt;%</span></span>
<span id="cb149-28"><a href="cleaning.html#cb149-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb149-29"><a href="cleaning.html#cb149-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb149-30"><a href="cleaning.html#cb149-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">comp_rule =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(comp_rule), <span class="st">&quot;skip&quot;</span>, comp_rule)))) <span class="sc">%&gt;%</span></span>
<span id="cb149-31"><a href="cleaning.html#cb149-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">map</span>(data, nrow) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb149-32"><a href="cleaning.html#cb149-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb149-33"><a href="cleaning.html#cb149-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(data, comp_rule, name), year_comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb149-34"><a href="cleaning.html#cb149-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb149-35"><a href="cleaning.html#cb149-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-36"><a href="cleaning.html#cb149-36" aria-hidden="true" tabindex="-1"></a>comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(rule, p_year){</span>
<span id="cb149-37"><a href="cleaning.html#cb149-37" aria-hidden="true" tabindex="-1"></a>  gsoep_cov <span class="sc">%&gt;%</span></span>
<span id="cb149-38"><a href="cleaning.html#cb149-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">&lt;=</span> p_year  <span class="sc">&amp;</span> long_rule <span class="sc">==</span> rule) <span class="sc">%&gt;%</span></span>
<span id="cb149-39"><a href="cleaning.html#cb149-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, yearBrth, name) <span class="sc">%&gt;%</span></span>
<span id="cb149-40"><a href="cleaning.html#cb149-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb149-41"><a href="cleaning.html#cb149-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb149-42"><a href="cleaning.html#cb149-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb149-43"><a href="cleaning.html#cb149-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-44"><a href="cleaning.html#cb149-44" aria-hidden="true" tabindex="-1"></a>gsoep_cov <span class="ot">&lt;-</span> <span class="fu">crossing</span>(</span>
<span id="cb149-45"><a href="cleaning.html#cb149-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_year =</span> gsoep_waves<span class="sc">$</span>Used, </span>
<span id="cb149-46"><a href="cleaning.html#cb149-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">long_rule =</span> <span class="fu">unique</span>(gsoep_cov<span class="sc">$</span>long_rule)</span>
<span id="cb149-47"><a href="cleaning.html#cb149-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb149-48"><a href="cleaning.html#cb149-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(long_rule, p_year, comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb149-49"><a href="cleaning.html#cb149-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb149-50"><a href="cleaning.html#cb149-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb149-51"><a href="cleaning.html#cb149-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>long_rule, <span class="sc">-</span>yearBrth) <span class="sc">%&gt;%</span></span>
<span id="cb149-52"><a href="cleaning.html#cb149-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> name, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb149-53"><a href="cleaning.html#cb149-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yearBrth =</span> <span class="fu">ifelse</span>(yearBrth <span class="sc">&lt;</span> <span class="dv">1000</span>, yearBrth <span class="sc">+</span> <span class="dv">1000</span>, yearBrth))</span></code></pre></div>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="cleaning.html#cb150-1" aria-hidden="true" tabindex="-1"></a>gsoep_cov</span></code></pre></div>
<pre><code>## # A tibble: 114,106 × 16
##    p_year   SID exercise height weight cancer diabetes married stroke alcohol education smokes gender yearBrth   age SRhealth
##     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
##  1   2005   101     1.67     NA     NA      0        0       1      0      NA        NA     NA      0     1930    54       NA
##  2   2005   102     1        NA     NA      0        0       1      0      NA        NA     NA      1     1940    44       NA
##  3   2005   103     2.67     NA     NA      0        0       0      0      NA        NA     NA      0     1963    21       NA
##  4   2005   201     2       157     61      0        0       0      0       1        11      0      1     1926    58        3
##  5   2005   202     3        NA     NA      0        0       0      0      NA        NA     NA      1     1956    28       NA
##  6   2005   203     4       177     77      0        0       0      0       1        NA      0      0     1960    24        5
##  7   2005   301     1        NA     NA      0        0       1      0      NA        NA     NA      0     1960    24        4
##  8   2005   302     1        NA     NA      0        0       1      0      NA        NA     NA      1     1961    23        3
##  9   2005   401     1        NA     NA      0        0       0      0      NA        NA     NA      0     1920    64       NA
## 10   2005   501     1        NA     NA      0        0       0      0      NA        NA     NA      1     1911    73        2
## # … with 114,096 more rows</code></pre>
</div>
<div id="personality-variables-6" class="section level3 hasAnchor" number="2.7.4">
<h3><span class="header-section-number">2.7.4</span> Personality Variables<a href="cleaning.html#personality-variables-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="cleaning.html#cb152-1" aria-hidden="true" tabindex="-1"></a>gsoep_pers <span class="ot">&lt;-</span> gsoep_recode <span class="sc">%&gt;%</span></span>
<span id="cb152-2"><a href="cleaning.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;pers&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb152-3"><a href="cleaning.html#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb152-4"><a href="cleaning.html#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> gsoep_waves<span class="sc">$</span>Used) <span class="sc">%&gt;%</span></span>
<span id="cb152-5"><a href="cleaning.html#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb152-6"><a href="cleaning.html#cb152-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-7"><a href="cleaning.html#cb152-7" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha&#39;s</span></span>
<span id="cb152-8"><a href="cleaning.html#cb152-8" aria-hidden="true" tabindex="-1"></a>gsoep_alpha <span class="ot">&lt;-</span> gsoep_pers <span class="sc">%&gt;%</span></span>
<span id="cb152-9"><a href="cleaning.html#cb152-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, itemname, year, SID, value) <span class="sc">%&gt;%</span></span>
<span id="cb152-10"><a href="cleaning.html#cb152-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, year) <span class="sc">%&gt;%</span></span>
<span id="cb152-11"><a href="cleaning.html#cb152-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb152-12"><a href="cleaning.html#cb152-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> itemname, <span class="at">values_from =</span> value)),</span>
<span id="cb152-13"><a href="cleaning.html#cb152-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">alpha =</span> <span class="fu">map</span>(data, <span class="fu">possibly</span>(<span class="sc">~</span>psych<span class="sc">::</span><span class="fu">alpha</span>((.) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>persnr)), <span class="cn">NA_real_</span>)))</span>
<span id="cb152-14"><a href="cleaning.html#cb152-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-15"><a href="cleaning.html#cb152-15" aria-hidden="true" tabindex="-1"></a>comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, rule){</span>
<span id="cb152-16"><a href="cleaning.html#cb152-16" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb152-17"><a href="cleaning.html#cb152-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID) <span class="sc">%&gt;%</span></span>
<span id="cb152-18"><a href="cleaning.html#cb152-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb152-19"><a href="cleaning.html#cb152-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb152-20"><a href="cleaning.html#cb152-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb152-21"><a href="cleaning.html#cb152-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-22"><a href="cleaning.html#cb152-22" aria-hidden="true" tabindex="-1"></a><span class="co"># create composites</span></span>
<span id="cb152-23"><a href="cleaning.html#cb152-23" aria-hidden="true" tabindex="-1"></a>gsoep_pers <span class="ot">&lt;-</span> gsoep_pers <span class="sc">%&gt;%</span></span>
<span id="cb152-24"><a href="cleaning.html#cb152-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, comp_rule, year) <span class="sc">%&gt;%</span></span>
<span id="cb152-25"><a href="cleaning.html#cb152-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb152-26"><a href="cleaning.html#cb152-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb152-27"><a href="cleaning.html#cb152-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, comp_rule, comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb152-28"><a href="cleaning.html#cb152-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span> </span>
<span id="cb152-29"><a href="cleaning.html#cb152-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>comp_rule) <span class="sc">%&gt;%</span></span>
<span id="cb152-30"><a href="cleaning.html#cb152-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value))</span></code></pre></div>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="cleaning.html#cb153-1" aria-hidden="true" tabindex="-1"></a>gsoep_pers</span></code></pre></div>
<pre><code>## # A tibble: 191,511 × 4
##    name   year   SID value
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 A      2005   201  7   
##  2 A      2005   203  4.67
##  3 A      2005   602  4.33
##  4 A      2005   901  4.67
##  5 A      2005  1202  7   
##  6 A      2005  1501  4.67
##  7 A      2005  1601  4   
##  8 A      2005  1602  6.67
##  9 A      2005  1603  4.33
## 10 A      2005  1701  7   
## # … with 191,501 more rows</code></pre>
</div>
<div id="outcome-variables-6" class="section level3 hasAnchor" number="2.7.5">
<h3><span class="header-section-number">2.7.5</span> Outcome Variables<a href="cleaning.html#outcome-variables-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="cleaning.html#cb155-1" aria-hidden="true" tabindex="-1"></a>gsoep_pers_subs <span class="ot">&lt;-</span> <span class="fu">unique</span>(gsoep_pers<span class="sc">$</span>SID)</span>
<span id="cb155-2"><a href="cleaning.html#cb155-2" aria-hidden="true" tabindex="-1"></a>gsoep_waves <span class="ot">&lt;-</span> p_waves <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Study <span class="sc">==</span> <span class="st">&quot;GSOEP&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Used) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb155-3"><a href="cleaning.html#cb155-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-4"><a href="cleaning.html#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="co"># composite within years </span></span>
<span id="cb155-5"><a href="cleaning.html#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="co"># compositing within years</span></span>
<span id="cb155-6"><a href="cleaning.html#cb155-6" aria-hidden="true" tabindex="-1"></a>year_comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, rule){</span>
<span id="cb155-7"><a href="cleaning.html#cb155-7" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb155-8"><a href="cleaning.html#cb155-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name, year) <span class="sc">%&gt;%</span> <span class="co"># group by person and item (collapse across age)</span></span>
<span id="cb155-9"><a href="cleaning.html#cb155-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb155-10"><a href="cleaning.html#cb155-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb155-11"><a href="cleaning.html#cb155-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb155-12"><a href="cleaning.html#cb155-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-13"><a href="cleaning.html#cb155-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-14"><a href="cleaning.html#cb155-14" aria-hidden="true" tabindex="-1"></a>gsoep_out <span class="ot">&lt;-</span> gsoep_recode <span class="sc">%&gt;%</span></span>
<span id="cb155-15"><a href="cleaning.html#cb155-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;outcome&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb155-16"><a href="cleaning.html#cb155-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb155-17"><a href="cleaning.html#cb155-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(year &lt;= max(gsoep_waves$Used)) %&gt;%</span></span>
<span id="cb155-18"><a href="cleaning.html#cb155-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(comp_rule) <span class="sc">%&gt;%</span></span>
<span id="cb155-19"><a href="cleaning.html#cb155-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb155-20"><a href="cleaning.html#cb155-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb155-21"><a href="cleaning.html#cb155-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comp_rule =</span> <span class="fu">ifelse</span>(comp_rule <span class="sc">==</span> <span class="st">&quot;select&quot;</span>, <span class="st">&quot;skip&quot;</span>, comp_rule),</span>
<span id="cb155-22"><a href="cleaning.html#cb155-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> <span class="fu">map2</span>(data, comp_rule, year_comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb155-23"><a href="cleaning.html#cb155-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb155-24"><a href="cleaning.html#cb155-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-25"><a href="cleaning.html#cb155-25" aria-hidden="true" tabindex="-1"></a><span class="co"># composite across years</span></span>
<span id="cb155-26"><a href="cleaning.html#cb155-26" aria-hidden="true" tabindex="-1"></a>comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(p_year){</span>
<span id="cb155-27"><a href="cleaning.html#cb155-27" aria-hidden="true" tabindex="-1"></a>  gsoep_out <span class="sc">%&gt;%</span></span>
<span id="cb155-28"><a href="cleaning.html#cb155-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, name) <span class="sc">%&gt;%</span></span>
<span id="cb155-29"><a href="cleaning.html#cb155-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb155-30"><a href="cleaning.html#cb155-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb155-31"><a href="cleaning.html#cb155-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value)) </span>
<span id="cb155-32"><a href="cleaning.html#cb155-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb155-33"><a href="cleaning.html#cb155-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-34"><a href="cleaning.html#cb155-34" aria-hidden="true" tabindex="-1"></a>gsoep_out <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">p_year =</span> gsoep_waves<span class="sc">$</span>Used) <span class="sc">%&gt;%</span></span>
<span id="cb155-35"><a href="cleaning.html#cb155-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(p_year, comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb155-36"><a href="cleaning.html#cb155-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb155-37"><a href="cleaning.html#cb155-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">o_year =</span> <span class="dv">2017</span>)</span></code></pre></div>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="cleaning.html#cb156-1" aria-hidden="true" tabindex="-1"></a>gsoep_out</span></code></pre></div>
<pre><code>## # A tibble: 109,214 × 5
##    p_year   SID name     value o_year
##     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;
##  1   2005   602 dementia     0   2017
##  2   2005   604 dementia     0   2017
##  3   2005   901 dementia     0   2017
##  4   2005  1501 dementia     0   2017
##  5   2005  1601 dementia     0   2017
##  6   2005  1602 dementia     0   2017
##  7   2005  2301 dementia     0   2017
##  8   2005  2302 dementia     0   2017
##  9   2005  4701 dementia     0   2017
## 10   2005  4901 dementia     0   2017
## # … with 109,204 more rows</code></pre>
</div>
<div id="cognition-variables-6" class="section level3 hasAnchor" number="2.7.6">
<h3><span class="header-section-number">2.7.6</span> Cognition Variables<a href="cleaning.html#cognition-variables-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="cleaning.html#cb158-1" aria-hidden="true" tabindex="-1"></a>gsoep_cog <span class="ot">&lt;-</span> gsoep_recode <span class="sc">%&gt;%</span></span>
<span id="cb158-2"><a href="cleaning.html#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;cognition&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb158-3"><a href="cleaning.html#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span> </span>
<span id="cb158-4"><a href="cleaning.html#cb158-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value))</span>
<span id="cb158-5"><a href="cleaning.html#cb158-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-6"><a href="cleaning.html#cb158-6" aria-hidden="true" tabindex="-1"></a>gsoep_cog_waves <span class="ot">&lt;-</span> gsoep_cog <span class="sc">%&gt;%</span></span>
<span id="cb158-7"><a href="cleaning.html#cb158-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(itemname, SID, year) <span class="sc">%&gt;%</span></span>
<span id="cb158-8"><a href="cleaning.html#cb158-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, itemname) <span class="sc">%&gt;%</span></span>
<span id="cb158-9"><a href="cleaning.html#cb158-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">o_year =</span> <span class="fu">max</span>(year)) <span class="sc">%&gt;%</span></span>
<span id="cb158-10"><a href="cleaning.html#cb158-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb158-11"><a href="cleaning.html#cb158-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-12"><a href="cleaning.html#cb158-12" aria-hidden="true" tabindex="-1"></a>gsoep_cog <span class="ot">&lt;-</span> gsoep_cog <span class="sc">%&gt;%</span></span>
<span id="cb158-13"><a href="cleaning.html#cb158-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(gsoep_cog_waves) <span class="sc">%&gt;%</span></span>
<span id="cb158-14"><a href="cleaning.html#cb158-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> o_year) <span class="sc">%&gt;%</span></span>
<span id="cb158-15"><a href="cleaning.html#cb158-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb158-16"><a href="cleaning.html#cb158-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, itemname, year) <span class="sc">%&gt;%</span></span>
<span id="cb158-17"><a href="cleaning.html#cb158-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">pomp</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb158-18"><a href="cleaning.html#cb158-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, o_year, SID) <span class="sc">%&gt;%</span></span>
<span id="cb158-19"><a href="cleaning.html#cb158-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">mean</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb158-20"><a href="cleaning.html#cb158-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb158-21"><a href="cleaning.html#cb158-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="cleaning.html#cb159-1" aria-hidden="true" tabindex="-1"></a>gsoep_cog</span></code></pre></div>
<pre><code>## # A tibble: 22,445 × 3
##    o_year   SID cognition
##     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
##  1   2012   201      0   
##  2   2012  1501      3.81
##  3   2012  5601      2.06
##  4   2012  6002      2.46
##  5   2012  7302      1.44
##  6   2012  8603      3.75
##  7   2012  9801      3.88
##  8   2012 11301      3.45
##  9   2012 12303      2.66
## 10   2012 13401      1.98
## # … with 22,435 more rows</code></pre>
</div>
<div id="combine-data-6" class="section level3 hasAnchor" number="2.7.7">
<h3><span class="header-section-number">2.7.7</span> Combine Data<a href="cleaning.html#combine-data-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="cleaning.html#cb161-1" aria-hidden="true" tabindex="-1"></a>gsoep_combined <span class="ot">&lt;-</span> gsoep_pers <span class="sc">%&gt;%</span> </span>
<span id="cb161-2"><a href="cleaning.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Trait =</span> name, <span class="at">p_value =</span> value, <span class="at">p_year =</span> year) <span class="sc">%&gt;%</span></span>
<span id="cb161-3"><a href="cleaning.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(gsoep_out <span class="sc">%&gt;%</span> <span class="fu">select</span>(p_year, SID, <span class="at">Outcome =</span> name, o_year, <span class="at">o_value =</span> value)) <span class="sc">%&gt;%</span></span>
<span id="cb161-4"><a href="cleaning.html#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(gsoep_cov) <span class="sc">%&gt;%</span></span>
<span id="cb161-5"><a href="cleaning.html#cb161-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb161-6"><a href="cleaning.html#cb161-6" aria-hidden="true" tabindex="-1"></a>    gsoep_out <span class="sc">%&gt;%</span></span>
<span id="cb161-7"><a href="cleaning.html#cb161-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb161-8"><a href="cleaning.html#cb161-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb161-9"><a href="cleaning.html#cb161-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb161-10"><a href="cleaning.html#cb161-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(gsoep_cog) <span class="sc">%&gt;%</span></span>
<span id="cb161-11"><a href="cleaning.html#cb161-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_value) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(o_value)) <span class="sc">%&gt;%</span></span>
<span id="cb161-12"><a href="cleaning.html#cb161-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> p_year <span class="sc">-</span> yearBrth</span>
<span id="cb161-13"><a href="cleaning.html#cb161-13" aria-hidden="true" tabindex="-1"></a>         , <span class="at">BMI =</span> weight<span class="sc">/</span>((height<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="cleaning.html#cb162-1" aria-hidden="true" tabindex="-1"></a>gsoep_combined</span></code></pre></div>
<pre><code>## # A tibble: 136,465 × 24
##    Trait p_year   SID p_value Outcome  o_year o_value exercise height weight cancer diabe…¹ married stroke alcohol educa…² smokes gender yearB…³
##    &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1 A       2005   602    4.33 dementia   2017       0     2.8    177    87        0       0       1      0       1    18        1      1    1958
##  2 A       2005   901    4.67 dementia   2017       0     2.8    158    47        0       0       0      0       0    10.5      1      1    1951
##  3 A       2005  1501    4.67 dementia   2017       0     1      168.   84        0       0       0      0       1    18        0      0    1958
##  4 A       2005  1601    4    dementia   2017       0     2.67   174.   75        0       0       1      0       1    10.5      1      0    1940
##  5 A       2005  1602    6.67 dementia   2017       0     2      160.   48        0       0       1      0       1    NA        1      1    1961
##  6 A       2005  2301    5    dementia   2017       0     1.8    180    75        0       0       1      0       0    18        1      0    1946
##  7 A       2005  2302    3.33 dementia   2017       0     3      157    46.5      0       0       1      0       1    18        1      1    1946
##  8 A       2005  4701    6    dementia   2017       0     2.2    168    70        0       0       0      0       1     9        0      1    1919
##  9 A       2005  4901    5.33 dementia   2017       0     1      162.   66.5      0       0       0      0       1     9        0      1    1925
## 10 A       2005  5201    6.33 dementia   2017       0     1.07   183    83        0       0       1      0       0    10.5      1      0    1955
## # … with 136,455 more rows, 5 more variables: age &lt;dbl&gt;, SRhealth &lt;dbl&gt;, dementia &lt;dbl&gt;, cognition &lt;dbl&gt;, BMI &lt;dbl&gt;, and abbreviated variable
## #   names ¹​diabetes, ²​education, ³​yearBrth</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="cleaning.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(gsoep_cov, gsoep_alpha, gsoep_pers, gsoep_out, gsoep_combined, gsoep_cog,</span>
<span id="cb164-2"><a href="cleaning.html#cb164-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/gsoep_cleaned.RData&quot;</span>, load_path))</span></code></pre></div>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="cleaning.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span><span class="fu">ls</span>()[<span class="fu">grepl</span>(<span class="st">&quot;gsoep&quot;</span>, <span class="fu">ls</span>())])</span></code></pre></div>
</div>
</div>
<div id="the-longitudinal-studies-for-the-social-sciences-liss" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> The Longitudinal Studies for the Social sciences (LISS)<a href="cleaning.html#the-longitudinal-studies-for-the-social-sciences-liss" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Longitudinal Studies for the Social sciences (LISS; Scherpenzeel, Das, Ester, &amp; Kaczmirek, 2010) is an ongoing longitudinal study of households in the Netherlands. These data are online, through application, from <a href="https://statements.centerdata.nl/liss-panel-data-statement" class="uri">https://statements.centerdata.nl/liss-panel-data-statement</a>.</p>
<p>Participants were approximately 8,000 Dutch-speaking individuals permanently residing in the Netherlands from 5,000 households. Data have been collected annually since 2007. The latest data release includes 11 waves of data from 2008 to 2018. More documentation are available at <a href="https://www.dataarchive.lissdata.nl/study_units/view/1" class="uri">https://www.dataarchive.lissdata.nl/study_units/view/1</a>.</p>
<p>Sample sizes vary by year, ranging from 5,021 (2018) to 6808 (2008). This provides 99/% power to detect a correlation effect size of ~.04, two-tailed at alpha .05.</p>
<div id="load-data-6" class="section level3 hasAnchor" number="2.8.1">
<h3><span class="header-section-number">2.8.1</span> Load Data<a href="cleaning.html#load-data-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="cleaning.html#cb166-1" aria-hidden="true" tabindex="-1"></a>liss_read_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb166-2"><a href="cleaning.html#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sprintf</span>(<span class="st">&quot;%s/liss/%s&quot;</span>, data_path, x) <span class="sc">%&gt;%</span> haven<span class="sc">::</span><span class="fu">read_sav</span>(.) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">one_of</span>(old.names))</span>
<span id="cb166-3"><a href="cleaning.html#cb166-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="cleaning.html#cb167-1" aria-hidden="true" tabindex="-1"></a>liss_codebook <span class="ot">&lt;-</span> (codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(study <span class="sc">==</span> <span class="st">&quot;LISS&quot;</span>))<span class="sc">$</span>codebook[[<span class="dv">1</span>]]</span>
<span id="cb167-2"><a href="cleaning.html#cb167-2" aria-hidden="true" tabindex="-1"></a>liss_codebook</span></code></pre></div>
<pre><code>## # A tibble: 1,327 × 17
##    study dataset    category   name      itemname  wave wave_letter  year orig_itemname descr…¹ scale rever…² recode  mini  maxi comp_…³ long_…⁴
##    &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
##  1 liss  ai07a      cognition  cognition BSI          1 a            2008 ai07a031      BSI pr… &quot;1\t… &lt;NA&gt;    ifels…    NA    NA skip    select 
##  2 liss  ai08b      cognition  cognition BSI          2 b            2009 ai08b031      BSI pr… &quot;1\t… &lt;NA&gt;    ifels…    NA    NA skip    select 
##  3 liss  ai08c      cognition  cognition BSI          3 c            2010 ai08c031      BSI pr… &quot;1\t… &lt;NA&gt;    ifels…    NA    NA skip    select 
##  4 liss  ai08d      cognition  cognition BSI          4 d            2011 ai08d031      BSI pr… &quot;1\t… &lt;NA&gt;    ifels…    NA    NA skip    select 
##  5 liss  avars_2008 covariates yearBrth  YOB1         1 a            2008 gebjaar       Year o… &quot;num… &lt;NA&gt;    ifels…    NA    NA mode    select 
##  6 liss  avars_2009 covariates yearBrth  YOB1         2 b            2009 gebjaar       Year o… &quot;num… &lt;NA&gt;    ifels…    NA    NA mode    select 
##  7 liss  avars_2010 covariates yearBrth  YOB1         3 c            2010 gebjaar       Year o… &quot;num… &lt;NA&gt;    ifels…    NA    NA mode    select 
##  8 liss  avars_2011 covariates yearBrth  YOB1         4 d            2011 gebjaar       Year o… &quot;num… &lt;NA&gt;    ifels…    NA    NA mode    select 
##  9 liss  avars_2012 covariates yearBrth  YOB1         5 e            2012 gebjaar       Year o… &quot;num… &lt;NA&gt;    ifels…    NA    NA mode    select 
## 10 liss  avars_2013 covariates yearBrth  YOB1         6 f            2013 gebjaar       Year o… &quot;num… &lt;NA&gt;    ifels…    NA    NA mode    select 
## # … with 1,317 more rows, and abbreviated variable names ¹​description, ²​reverse_code, ³​comp_rule, ⁴​long_rule</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="cleaning.html#cb169-1" aria-hidden="true" tabindex="-1"></a>old.names <span class="ot">&lt;-</span> <span class="fu">unique</span>(liss_codebook<span class="sc">$</span>orig_itemname) <span class="sc">%&gt;%</span> str_to_lower</span>
<span id="cb169-2"><a href="cleaning.html#cb169-2" aria-hidden="true" tabindex="-1"></a>datasets <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/liss&quot;</span>, data_path) <span class="sc">%&gt;%</span> <span class="fu">list.files</span>()</span>
<span id="cb169-3"><a href="cleaning.html#cb169-3" aria-hidden="true" tabindex="-1"></a>liss <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">datasets =</span> datasets) <span class="sc">%&gt;%</span></span>
<span id="cb169-4"><a href="cleaning.html#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(datasets, liss_read_fun)) </span>
<span id="cb169-5"><a href="cleaning.html#cb169-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-6"><a href="cleaning.html#cb169-6" aria-hidden="true" tabindex="-1"></a>liss <span class="ot">&lt;-</span> <span class="fu">reduce</span>(liss<span class="sc">$</span>data, full_join) <span class="sc">%&gt;%</span> haven<span class="sc">::</span><span class="fu">zap_labels</span>(.)</span>
<span id="cb169-7"><a href="cleaning.html#cb169-7" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(liss, <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/liss_raw.RData&quot;</span>, load_path))</span>
<span id="cb169-8"><a href="cleaning.html#cb169-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-9"><a href="cleaning.html#cb169-9" aria-hidden="true" tabindex="-1"></a>avars <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">ds =</span> datasets[<span class="fu">grepl</span>(<span class="st">&quot;avar&quot;</span>, datasets)]) <span class="sc">%&gt;%</span></span>
<span id="cb169-10"><a href="cleaning.html#cb169-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(ds, <span class="sc">~</span><span class="fu">sprintf</span>(<span class="st">&quot;%s/liss/%s&quot;</span>, data_path, .) <span class="sc">%&gt;%</span> </span>
<span id="cb169-11"><a href="cleaning.html#cb169-11" aria-hidden="true" tabindex="-1"></a>                      haven<span class="sc">::</span><span class="fu">read_sav</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb169-12"><a href="cleaning.html#cb169-12" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">select</span>(<span class="fu">one_of</span>(old.names)) <span class="sc">%&gt;%</span> </span>
<span id="cb169-13"><a href="cleaning.html#cb169-13" aria-hidden="true" tabindex="-1"></a>                      haven<span class="sc">::</span><span class="fu">zap_labels</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb169-14"><a href="cleaning.html#cb169-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(ds, <span class="fu">c</span>(<span class="st">&quot;ds&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;scrap1&quot;</span>, <span class="st">&quot;scrap2&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb169-15"><a href="cleaning.html#cb169-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(year, <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;month&quot;</span>), <span class="sc">-</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb169-16"><a href="cleaning.html#cb169-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, month, data) <span class="sc">%&gt;%</span> </span>
<span id="cb169-17"><a href="cleaning.html#cb169-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) </span></code></pre></div>
</div>
<div id="recoding-reverse-scoring-5" class="section level3 hasAnchor" number="2.8.2">
<h3><span class="header-section-number">2.8.2</span> Recoding &amp; Reverse-Scoring<a href="cleaning.html#recoding-reverse-scoring-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="cleaning.html#cb170-1" aria-hidden="true" tabindex="-1"></a>rename_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(cb, var){</span>
<span id="cb170-2"><a href="cleaning.html#cb170-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(var)</span>
<span id="cb170-3"><a href="cleaning.html#cb170-3" aria-hidden="true" tabindex="-1"></a>  old.names <span class="ot">&lt;-</span> <span class="fu">unique</span>((liss_codebook <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> var))<span class="sc">$</span>orig_itemname)</span>
<span id="cb170-4"><a href="cleaning.html#cb170-4" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> liss <span class="sc">%&gt;%</span> </span>
<span id="cb170-5"><a href="cleaning.html#cb170-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">SID =</span> nomem_encr, <span class="at">HHID =</span> nohouse_encr, <span class="fu">one_of</span>(old.names)) <span class="sc">%&gt;%</span></span>
<span id="cb170-6"><a href="cleaning.html#cb170-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(<span class="at">key =</span> orig_itemname, <span class="at">value =</span> value, </span>
<span id="cb170-7"><a href="cleaning.html#cb170-7" aria-hidden="true" tabindex="-1"></a>           <span class="sc">-</span>SID, <span class="sc">-</span>HHID, <span class="at">na.rm=</span>T)</span>
<span id="cb170-8"><a href="cleaning.html#cb170-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(old.names) <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb170-9"><a href="cleaning.html#cb170-9" aria-hidden="true" tabindex="-1"></a>      df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(cb <span class="sc">%&gt;%</span> <span class="fu">select</span>(itemname, year, orig_itemname, reverse_code<span class="sc">:</span>long_rule))</span>
<span id="cb170-10"><a href="cleaning.html#cb170-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb170-11"><a href="cleaning.html#cb170-11" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(cb <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>(itemname<span class="sc">:</span>year)) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="dv">0</span>)</span>
<span id="cb170-12"><a href="cleaning.html#cb170-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb170-13"><a href="cleaning.html#cb170-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(var <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;yearBrth&quot;</span>, <span class="st">&quot;gender&quot;</span>)) df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(avars <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>category, <span class="sc">-</span>name))</span>
<span id="cb170-14"><a href="cleaning.html#cb170-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb170-15"><a href="cleaning.html#cb170-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-16"><a href="cleaning.html#cb170-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-17"><a href="cleaning.html#cb170-17" aria-hidden="true" tabindex="-1"></a>avars <span class="ot">&lt;-</span> avars <span class="sc">%&gt;%</span></span>
<span id="cb170-18"><a href="cleaning.html#cb170-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">SID =</span> nomem_encr, <span class="at">HHID =</span> nohouse_encr, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb170-19"><a href="cleaning.html#cb170-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, HHID, year) <span class="sc">%&gt;%</span></span>
<span id="cb170-20"><a href="cleaning.html#cb170-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_at</span>(<span class="fu">vars</span>(gebjaar, geslacht), Mode) <span class="sc">%&gt;%</span></span>
<span id="cb170-21"><a href="cleaning.html#cb170-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb170-22"><a href="cleaning.html#cb170-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;gebjaar&quot;</span>, <span class="st">&quot;geslacht&quot;</span>)</span>
<span id="cb170-23"><a href="cleaning.html#cb170-23" aria-hidden="true" tabindex="-1"></a>               , <span class="at">names_to =</span> <span class="st">&quot;orig_itemname&quot;</span></span>
<span id="cb170-24"><a href="cleaning.html#cb170-24" aria-hidden="true" tabindex="-1"></a>               , <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb170-25"><a href="cleaning.html#cb170-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.numeric</span>(year)) <span class="sc">%&gt;%</span></span>
<span id="cb170-26"><a href="cleaning.html#cb170-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb170-27"><a href="cleaning.html#cb170-27" aria-hidden="true" tabindex="-1"></a>    liss_codebook <span class="sc">%&gt;%</span> </span>
<span id="cb170-28"><a href="cleaning.html#cb170-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(category, name, itemname, year, orig_itemname, reverse_code<span class="sc">:</span>long_rule)</span>
<span id="cb170-29"><a href="cleaning.html#cb170-29" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb170-30"><a href="cleaning.html#cb170-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-31"><a href="cleaning.html#cb170-31" aria-hidden="true" tabindex="-1"></a><span class="co"># rename variables   </span></span>
<span id="cb170-32"><a href="cleaning.html#cb170-32" aria-hidden="true" tabindex="-1"></a>liss_recode <span class="ot">&lt;-</span> liss_codebook <span class="sc">%&gt;%</span></span>
<span id="cb170-33"><a href="cleaning.html#cb170-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;covariates&quot;</span>, <span class="st">&quot;pers&quot;</span>, <span class="st">&quot;outcome&quot;</span>, <span class="st">&quot;cognition&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb170-34"><a href="cleaning.html#cb170-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(category, name<span class="sc">:</span>wave, year<span class="sc">:</span>orig_itemname, reverse_code<span class="sc">:</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb170-35"><a href="cleaning.html#cb170-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(category, name) <span class="sc">%&gt;%</span> </span>
<span id="cb170-36"><a href="cleaning.html#cb170-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb170-37"><a href="cleaning.html#cb170-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb170-38"><a href="cleaning.html#cb170-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, name, rename_fun))</span>
<span id="cb170-39"><a href="cleaning.html#cb170-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-40"><a href="cleaning.html#cb170-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-41"><a href="cleaning.html#cb170-41" aria-hidden="true" tabindex="-1"></a>recode_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(rule, y){</span>
<span id="cb170-42"><a href="cleaning.html#cb170-42" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y<span class="sc">$</span>value</span>
<span id="cb170-43"><a href="cleaning.html#cb170-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(rule)){y<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> rule))}</span>
<span id="cb170-44"><a href="cleaning.html#cb170-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb170-45"><a href="cleaning.html#cb170-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-46"><a href="cleaning.html#cb170-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-47"><a href="cleaning.html#cb170-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-48"><a href="cleaning.html#cb170-48" aria-hidden="true" tabindex="-1"></a>liss_recode <span class="ot">&lt;-</span> liss_recode <span class="sc">%&gt;%</span> </span>
<span id="cb170-49"><a href="cleaning.html#cb170-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> </span>
<span id="cb170-50"><a href="cleaning.html#cb170-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(recode) <span class="sc">%&gt;%</span></span>
<span id="cb170-51"><a href="cleaning.html#cb170-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb170-52"><a href="cleaning.html#cb170-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb170-53"><a href="cleaning.html#cb170-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">pmap</span>(<span class="fu">list</span>(recode, data), recode_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb170-54"><a href="cleaning.html#cb170-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb170-55"><a href="cleaning.html#cb170-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(value <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> <span class="fu">is.nan</span>(value) <span class="sc">|</span> <span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value))))</span>
<span id="cb170-56"><a href="cleaning.html#cb170-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-57"><a href="cleaning.html#cb170-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-58"><a href="cleaning.html#cb170-58" aria-hidden="true" tabindex="-1"></a><span class="co"># reverse code </span></span>
<span id="cb170-59"><a href="cleaning.html#cb170-59" aria-hidden="true" tabindex="-1"></a>liss_recode <span class="ot">&lt;-</span> liss_recode <span class="sc">%&gt;%</span></span>
<span id="cb170-60"><a href="cleaning.html#cb170-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span></span>
<span id="cb170-61"><a href="cleaning.html#cb170-61" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">tolower</span>(reverse_code) <span class="sc">==</span> <span class="st">&quot;no&quot;</span> <span class="sc">|</span> <span class="fu">is.na</span>(reverse_code), value, </span>
<span id="cb170-62"><a href="cleaning.html#cb170-62" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">reverse.code</span>(<span class="sc">-</span><span class="dv">1</span>, value, <span class="at">mini =</span> mini, <span class="at">maxi =</span> maxi)))))</span>
<span id="cb170-63"><a href="cleaning.html#cb170-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-64"><a href="cleaning.html#cb170-64" aria-hidden="true" tabindex="-1"></a>fun_call <span class="ot">&lt;-</span> <span class="cf">function</span>(x, rule){</span>
<span id="cb170-65"><a href="cleaning.html#cb170-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span>(rule,</span>
<span id="cb170-66"><a href="cleaning.html#cb170-66" aria-hidden="true" tabindex="-1"></a>           <span class="at">average =</span> <span class="fu">mean</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb170-67"><a href="cleaning.html#cb170-67" aria-hidden="true" tabindex="-1"></a>           <span class="at">mode =</span> <span class="fu">Mode</span>(x)[<span class="dv">1</span>],</span>
<span id="cb170-68"><a href="cleaning.html#cb170-68" aria-hidden="true" tabindex="-1"></a>           <span class="at">sum =</span> <span class="fu">sum</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb170-69"><a href="cleaning.html#cb170-69" aria-hidden="true" tabindex="-1"></a>           <span class="at">skip =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb170-70"><a href="cleaning.html#cb170-70" aria-hidden="true" tabindex="-1"></a>           <span class="at">select =</span> <span class="fu">unique</span>(x)[<span class="dv">1</span>],</span>
<span id="cb170-71"><a href="cleaning.html#cb170-71" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">max</span>(x, <span class="at">na.rm =</span> T),</span>
<span id="cb170-72"><a href="cleaning.html#cb170-72" aria-hidden="true" tabindex="-1"></a>           <span class="at">min =</span> <span class="fu">min</span>(x, <span class="at">na.rm =</span> T))</span>
<span id="cb170-73"><a href="cleaning.html#cb170-73" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
</div>
<div id="covariates-7" class="section level3 hasAnchor" number="2.8.3">
<h3><span class="header-section-number">2.8.3</span> Covariates<a href="cleaning.html#covariates-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="cleaning.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/liss_cleaned.RData&quot;</span>, local_path))</span></code></pre></div>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="cleaning.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bring in year or birth for cleaning</span></span>
<span id="cb172-2"><a href="cleaning.html#cb172-2" aria-hidden="true" tabindex="-1"></a>liss_cov <span class="ot">&lt;-</span> liss_recode <span class="sc">%&gt;%</span> </span>
<span id="cb172-3"><a href="cleaning.html#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;covariates&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb172-4"><a href="cleaning.html#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb172-5"><a href="cleaning.html#cb172-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb172-6"><a href="cleaning.html#cb172-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-7"><a href="cleaning.html#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="co"># compositing within years</span></span>
<span id="cb172-8"><a href="cleaning.html#cb172-8" aria-hidden="true" tabindex="-1"></a>year_comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(df, rule){</span>
<span id="cb172-9"><a href="cleaning.html#cb172-9" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span></span>
<span id="cb172-10"><a href="cleaning.html#cb172-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># group by person and item (collapse across age)</span></span>
<span id="cb172-11"><a href="cleaning.html#cb172-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, HHID, long_rule, name, year) <span class="sc">%&gt;%</span> </span>
<span id="cb172-12"><a href="cleaning.html#cb172-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb172-13"><a href="cleaning.html#cb172-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb172-14"><a href="cleaning.html#cb172-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value))</span>
<span id="cb172-15"><a href="cleaning.html#cb172-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb172-16"><a href="cleaning.html#cb172-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-17"><a href="cleaning.html#cb172-17" aria-hidden="true" tabindex="-1"></a>liss_waves <span class="ot">&lt;-</span> p_waves <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Study <span class="sc">==</span> <span class="st">&quot;LISS&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Used) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb172-18"><a href="cleaning.html#cb172-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-19"><a href="cleaning.html#cb172-19" aria-hidden="true" tabindex="-1"></a>liss_cov <span class="ot">&lt;-</span> liss_cov <span class="sc">%&gt;%</span></span>
<span id="cb172-20"><a href="cleaning.html#cb172-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;=</span> <span class="fu">max</span>(liss_waves<span class="sc">$</span>Used)) <span class="sc">%&gt;%</span></span>
<span id="cb172-21"><a href="cleaning.html#cb172-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(comp_rule) <span class="sc">%&gt;%</span></span>
<span id="cb172-22"><a href="cleaning.html#cb172-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb172-23"><a href="cleaning.html#cb172-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb172-24"><a href="cleaning.html#cb172-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(data, comp_rule, year_comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb172-25"><a href="cleaning.html#cb172-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data)</span>
<span id="cb172-26"><a href="cleaning.html#cb172-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-27"><a href="cleaning.html#cb172-27" aria-hidden="true" tabindex="-1"></a>comp_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(rule, p_year){</span>
<span id="cb172-28"><a href="cleaning.html#cb172-28" aria-hidden="true" tabindex="-1"></a>  liss_cov <span class="sc">%&gt;%</span></span>
<span id="cb172-29"><a href="cleaning.html#cb172-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">&lt;=</span> p_year  <span class="sc">&amp;</span> long_rule <span class="sc">==</span> rule) <span class="sc">%&gt;%</span></span>
<span id="cb172-30"><a href="cleaning.html#cb172-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(SID, HHID, name) <span class="sc">%&gt;%</span></span>
<span id="cb172-31"><a href="cleaning.html#cb172-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">fun_call</span>(value, rule)) <span class="sc">%&gt;%</span></span>
<span id="cb172-32"><a href="cleaning.html#cb172-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb172-33"><a href="cleaning.html#cb172-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb172-34"><a href="cleaning.html#cb172-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-35"><a href="cleaning.html#cb172-35" aria-hidden="true" tabindex="-1"></a>liss_cov <span class="ot">&lt;-</span> <span class="fu">crossing</span>(</span>
<span id="cb172-36"><a href="cleaning.html#cb172-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">p_year =</span> liss_waves<span class="sc">$</span>Used, </span>
<span id="cb172-37"><a href="cleaning.html#cb172-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">long_rule =</span> <span class="fu">unique</span>(liss_cov<span class="sc">$</span>long_rule)</span>
<span id="cb172-38"><a href="cleaning.html#cb172-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb172-39"><a href="cleaning.html#cb172-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map2</span>(long_rule, p_year, comp_fun)) <span class="sc">%&gt;%</span></span>
<span id="cb172-40"><a href="cleaning.html#cb172-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb172-41"><a href="cleaning.html#cb172-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value) <span class="sc">|</span> <span class="fu">is.nan</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb172-42"><a href="cleaning.html#cb172-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>long_rule) <span class="sc">%&gt;%</span></span>
<span id="cb172-43"><a href="cleaning.html#cb172-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> name, <span class="at">values_from =</span> value, <span class="at">values_fn =</span> <span class="fu">list</span>(<span class="at">value =</span> max)) <span class="sc">%&gt;%</span></span>
<span id="cb172-44"><a href="cleaning.html#cb172-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BMI =</span> weight<span class="sc">/</span>((height<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="cleaning.html#cb173-1" aria-hidden="true" tabindex="-1"></a>liss_cov</span></code></pre></div>
<pre><code>## # A tibble: 27,202 × 21
##    p_year    SID   HHID weight exercise alcohol cancer diabetes education ethnicity heartP…¹ height parki…² respDis smokes stroke married gender
##     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
##  1   2008 800033 583404   58         NA       1      0        0        12         2        0    165       0       0      1      0      NA      0
##  2   2008 800042 500277   74.5        0       1      0        0        16        NA        0    169       0       0      1      0       1      1
##  3   2008 800045 548654   84         NA       1      0        0        NA        NA        0    185       0       0      1      0       1      0
##  4   2008 800057 580532   85         NA       1      0        0        18        NA        0    198       0       0      1      0      NA      0
##  5   2008 800076 578048   57          0       1      0        0        NA        NA        0    167       0       0      0      0      NA      1
##  6   2008 800119 537783   84.5       NA       0      1        0        NA         2        0    174       0       0      0      0       1      1
##  7   2008 800125 582101   61         NA       1      0        0        16         2        0    158       0       1      0      0      NA      1
##  8   2008 800134 549826   66         NA       1      0        0        NA        NA        0    162       0       0      1      0       1      1
##  9   2008 800158 519049   87.5       NA       1      0        0        14        NA        0    180       0       0      0      0       1      0
## 10   2008 800170 520571   56.5        0       1      0        0        14        NA        0    160       0       0      1      0       1      1
## # … with 27,192 more rows, 3 more variables: yearBrth &lt;dbl&gt;, SRhealth &lt;dbl&gt;, BMI &lt;dbl&gt;, and abbreviated variable names ¹​heartProb, ²​parkinsons</code></pre>
</div>
<div id="personality-variables-7" class="section level3 hasAnchor" number="2.8.4">
<h3><span class="header-section-number">2.8.4</span> Personality Variables<a href="cleaning.html#personality-variables-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="cleaning.html#cb175-1" aria-hidden="true" tabindex="-1"></a>liss_pers <span class="ot">&lt;-</span> liss_recode <span class="sc">%&gt;%</span></span>
<span id="cb175-2"><a href="cleaning.html#cb175-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;pers&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb175-3"><a href="cleaning.html#cb175-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb175-4"><a href="cleaning.html#cb175-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> liss_waves<span class="sc">$</span>Used) <span class="sc">%&gt;%</span></span>
<span id="cb175-5"><a href="cleaning.html#cb175-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb175-6"><a href="cleaning.html#cb175-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-7"><a href="cleaning.html#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha&#39;s</span></span>
<span id="cb175-8"><a href="cleaning.html#cb175-8" aria-hidden="true" tabindex="-1"></a>liss_alpha <span class="ot">&lt;-</span> liss_pers <span class="sc">%&gt;%</span></span>
<span id="cb175-9"><a href="cleaning.html#cb175-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, itemname, year, SID, value) <span class="sc">%&gt;%</span></span>
<span id="cb175-10"><a href="cleaning.html#cb175-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, year) <span class="sc">%&gt;%</span></span>
<span id="cb175-11"><a href="cleaning.html#cb175-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb175-12"><a href="cleaning.html#cb175-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">data =</span> <span class="fu">map</span>(data, <span class="sc">~</span>(.) <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> itemname, <span class="at">values_from =</span> value)),</span>
<span id="cb175-13"><a href="cleaning.html#cb175-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">alpha =</span> <span class="fu">map</span>(data, <span class="fu">possibly</span>(<span class="sc">~</span>psych<span class="sc">::</span><span class="fu">alpha</span>((.) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>SID)), <span class="cn">NA_real_</span>)))</span>
<span id="cb175-14"><a href="cleaning.html#cb175-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-15"><a href="cleaning.html#cb175-15" aria-hidden="true" tabindex="-1"></a><span class="co"># create composites</span></span>
<span id="cb175-16"><a href="cleaning.html#cb175-16" aria-hidden="true" tabindex="-1"></a>liss_pers <span class="ot">&lt;-</span> liss_pers <span class="sc">%&gt;%</span></span>
<span id="cb175-17"><a href="cleaning.html#cb175-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, HHID, name, year) <span class="sc">%&gt;%</span></span>
<span id="cb175-18"><a href="cleaning.html#cb175-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> T))  <span class="sc">%&gt;%</span></span>
<span id="cb175-19"><a href="cleaning.html#cb175-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="cleaning.html#cb176-1" aria-hidden="true" tabindex="-1"></a>liss_pers</span></code></pre></div>
<pre><code>## # A tibble: 54,280 × 5
##       SID   HHID name   year value
##     &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 800033 583404 A      2008   2.8
##  2 800033 583404 C      2008   2.3
##  3 800033 583404 E      2008   2.4
##  4 800033 583404 N      2008   2.7
##  5 800033 583404 NA     2008   3.3
##  6 800033 583404 O      2008   3.4
##  7 800033 583404 PA     2008   4.2
##  8 800033 583404 SWL    2008   6  
##  9 800042 500277 A      2008   3.7
## 10 800042 500277 C      2008   3.9
## # … with 54,270 more rows</code></pre>
</div>
<div id="cognition-variables-7" class="section level3 hasAnchor" number="2.8.5">
<h3><span class="header-section-number">2.8.5</span> Cognition Variables<a href="cleaning.html#cognition-variables-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="cleaning.html#cb178-1" aria-hidden="true" tabindex="-1"></a>liss_cog <span class="ot">&lt;-</span> liss_recode <span class="sc">%&gt;%</span></span>
<span id="cb178-2"><a href="cleaning.html#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;cognition&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb178-3"><a href="cleaning.html#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb178-4"><a href="cleaning.html#cb178-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> liss_waves<span class="sc">$</span>Used) <span class="sc">%&gt;%</span></span>
<span id="cb178-5"><a href="cleaning.html#cb178-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb178-6"><a href="cleaning.html#cb178-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, itemname, year) <span class="sc">%&gt;%</span></span>
<span id="cb178-7"><a href="cleaning.html#cb178-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">pomp</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb178-8"><a href="cleaning.html#cb178-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb178-9"><a href="cleaning.html#cb178-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, SID) <span class="sc">%&gt;%</span></span>
<span id="cb178-10"><a href="cleaning.html#cb178-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">mean</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb178-11"><a href="cleaning.html#cb178-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb178-12"><a href="cleaning.html#cb178-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="cleaning.html#cb179-1" aria-hidden="true" tabindex="-1"></a>liss_cog</span></code></pre></div>
<pre><code>## # A tibble: 1,804 × 2
##       SID cognition
##     &lt;dbl&gt;     &lt;dbl&gt;
##  1 800076       2.5
##  2 800170       0  
##  3 800186       7.5
##  4 800231       2.5
##  5 800326       0  
##  6 800354       2.5
##  7 800424       7.5
##  8 800540       5  
##  9 800601       5  
## 10 800790       5  
## # … with 1,794 more rows</code></pre>
</div>
<div id="outcome-variables-7" class="section level3 hasAnchor" number="2.8.6">
<h3><span class="header-section-number">2.8.6</span> Outcome Variables<a href="cleaning.html#outcome-variables-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="cleaning.html#cb181-1" aria-hidden="true" tabindex="-1"></a>liss_out <span class="ot">&lt;-</span> liss_recode <span class="sc">%&gt;%</span></span>
<span id="cb181-2"><a href="cleaning.html#cb181-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;outcome&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-3"><a href="cleaning.html#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb181-4"><a href="cleaning.html#cb181-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_year =</span> liss_waves<span class="sc">$</span>Used, </span>
<span id="cb181-5"><a href="cleaning.html#cb181-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">group =</span> <span class="fu">ifelse</span>(year <span class="sc">&gt;</span> p_year, <span class="st">&quot;future&quot;</span>, <span class="st">&quot;past&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb181-6"><a href="cleaning.html#cb181-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, name, group, p_year) <span class="sc">%&gt;%</span></span>
<span id="cb181-7"><a href="cleaning.html#cb181-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">value =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> T)) <span class="sc">%&gt;%</span></span>
<span id="cb181-8"><a href="cleaning.html#cb181-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb181-9"><a href="cleaning.html#cb181-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.infinite</span>(value), <span class="cn">NA</span>, value)) <span class="sc">%&gt;%</span></span>
<span id="cb181-10"><a href="cleaning.html#cb181-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> group, <span class="at">values_from =</span> value) <span class="sc">%&gt;%</span></span>
<span id="cb181-11"><a href="cleaning.html#cb181-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SID, p_year, name) <span class="sc">%&gt;%</span></span>
<span id="cb181-12"><a href="cleaning.html#cb181-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(past) <span class="sc">|</span> (past <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(future)), future,</span>
<span id="cb181-13"><a href="cleaning.html#cb181-13" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(past <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(future), past, </span>
<span id="cb181-14"><a href="cleaning.html#cb181-14" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(past <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb181-15"><a href="cleaning.html#cb181-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb181-16"><a href="cleaning.html#cb181-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value))</span></code></pre></div>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="cleaning.html#cb182-1" aria-hidden="true" tabindex="-1"></a>liss_out</span></code></pre></div>
<pre><code>## # A tibble: 13,452 × 6
##       SID name     p_year future  past value
##     &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 800009 dementia   2008      0    NA     0
##  2 800012 dementia   2008      0    NA     0
##  3 800015 dementia   2008      0    NA     0
##  4 800018 dementia   2008      0    NA     0
##  5 800033 dementia   2008      0     0     0
##  6 800042 dementia   2008      0     0     0
##  7 800045 dementia   2008     NA     0     0
##  8 800054 dementia   2008      0    NA     0
##  9 800057 dementia   2008      0     0     0
## 10 800073 dementia   2008      0    NA     0
## # … with 13,442 more rows</code></pre>
</div>
<div id="combine-data-7" class="section level3 hasAnchor" number="2.8.7">
<h3><span class="header-section-number">2.8.7</span> Combine Data<a href="cleaning.html#combine-data-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="cleaning.html#cb184-1" aria-hidden="true" tabindex="-1"></a>liss_combined <span class="ot">&lt;-</span> liss_pers <span class="sc">%&gt;%</span> </span>
<span id="cb184-2"><a href="cleaning.html#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Trait =</span> name, <span class="at">p_value =</span> value, <span class="at">p_year =</span> year) <span class="sc">%&gt;%</span></span>
<span id="cb184-3"><a href="cleaning.html#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(liss_out <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Outcome =</span> name, <span class="at">o_value =</span> value)) <span class="sc">%&gt;%</span></span>
<span id="cb184-4"><a href="cleaning.html#cb184-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(liss_cov) <span class="sc">%&gt;%</span></span>
<span id="cb184-5"><a href="cleaning.html#cb184-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb184-6"><a href="cleaning.html#cb184-6" aria-hidden="true" tabindex="-1"></a>    liss_out <span class="sc">%&gt;%</span></span>
<span id="cb184-7"><a href="cleaning.html#cb184-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&quot;dementia&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb184-8"><a href="cleaning.html#cb184-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(<span class="fu">rowSums</span>(<span class="fu">cbind</span>(future, past), <span class="at">na.rm =</span> T) <span class="sc">&gt;=</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb184-9"><a href="cleaning.html#cb184-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span>future, <span class="sc">-</span>past) <span class="sc">%&gt;%</span></span>
<span id="cb184-10"><a href="cleaning.html#cb184-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&quot;name&quot;</span>, <span class="at">values_from =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb184-11"><a href="cleaning.html#cb184-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb184-12"><a href="cleaning.html#cb184-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(liss_cog) <span class="sc">%&gt;%</span></span>
<span id="cb184-13"><a href="cleaning.html#cb184-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p_value) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(o_value)) <span class="sc">%&gt;%</span></span>
<span id="cb184-14"><a href="cleaning.html#cb184-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> p_year <span class="sc">-</span> yearBrth</span>
<span id="cb184-15"><a href="cleaning.html#cb184-15" aria-hidden="true" tabindex="-1"></a>         , <span class="at">o_year =</span> <span class="dv">2018</span>)</span></code></pre></div>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="cleaning.html#cb185-1" aria-hidden="true" tabindex="-1"></a>liss_combined</span></code></pre></div>
<pre><code>## # A tibble: 52,267 × 31
##       SID   HHID Trait p_year p_value Outcome  future  past o_value weight exerc…¹ alcohol cancer diabe…² educa…³ ethni…⁴ heart…⁵ height parki…⁶
##     &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1 800033 583404 A       2008     2.8 dementia      0     0       0   58        NA       1      0       0      12       2       0    165       0
##  2 800033 583404 C       2008     2.3 dementia      0     0       0   58        NA       1      0       0      12       2       0    165       0
##  3 800033 583404 E       2008     2.4 dementia      0     0       0   58        NA       1      0       0      12       2       0    165       0
##  4 800033 583404 N       2008     2.7 dementia      0     0       0   58        NA       1      0       0      12       2       0    165       0
##  5 800033 583404 NA      2008     3.3 dementia      0     0       0   58        NA       1      0       0      12       2       0    165       0
##  6 800033 583404 O       2008     3.4 dementia      0     0       0   58        NA       1      0       0      12       2       0    165       0
##  7 800033 583404 PA      2008     4.2 dementia      0     0       0   58        NA       1      0       0      12       2       0    165       0
##  8 800033 583404 SWL     2008     6   dementia      0     0       0   58        NA       1      0       0      12       2       0    165       0
##  9 800042 500277 A       2008     3.7 dementia      0     0       0   74.5       0       1      0       0      16      NA       0    169       0
## 10 800042 500277 C       2008     3.9 dementia      0     0       0   74.5       0       1      0       0      16      NA       0    169       0
## # … with 52,257 more rows, 12 more variables: respDis &lt;dbl&gt;, smokes &lt;dbl&gt;, stroke &lt;dbl&gt;, married &lt;dbl&gt;, gender &lt;dbl&gt;, yearBrth &lt;dbl&gt;,
## #   SRhealth &lt;dbl&gt;, BMI &lt;dbl&gt;, dementia &lt;dbl&gt;, cognition &lt;dbl&gt;, age &lt;dbl&gt;, o_year &lt;dbl&gt;, and abbreviated variable names ¹​exercise, ²​diabetes,
## #   ³​education, ⁴​ethnicity, ⁵​heartProb, ⁶​parkinsons</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="cleaning.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(liss_cov, liss_alpha, liss_pers, liss_out, liss_combined, liss_cog, </span>
<span id="cb187-2"><a href="cleaning.html#cb187-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">file =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%s/data/clean/liss_cleaned.RData&quot;</span>, local_path))</span></code></pre></div>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="cleaning.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span><span class="fu">ls</span>()[<span class="fu">grepl</span>(<span class="st">&quot;liss&quot;</span>, <span class="fu">ls</span>())])</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="runmodels.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-data-cleaning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
